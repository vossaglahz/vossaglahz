"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[1321],{43064:(e,t,s)=>{function a(e){return t=>void 0!==t?{type:e,payload:t,async:!0}:{type:e,async:!0}}s.d(t,{K:()=>a})},40554:(e,t,s)=>{function a(e){return t=>void 0!==t?{type:e,payload:t}:{type:e}}s.d(t,{mq:()=>a})},48803:(e,t,s)=>{s.d(t,{Q:()=>a});const a=e=>({type:"USER/UPDATE_EMAIL",payload:e,async:!0})},50922:(e,t,s)=>{s.d(t,{Cy:()=>c,D_:()=>r,GW:()=>i,nc:()=>n});var a=s(40554);const r=(0,a.mq)("ANALYTICS/PAGEVIEW"),n=(0,a.mq)("ANALYTICS/TRACK_GOOGLE"),i=(0,a.mq)("ANALYTICS/SET_CONSENT_GRANTED"),c=(0,a.mq)("ANALYTICS/CHANGE_PROJECT_ID")},57953:(e,t,s)=>{s.d(t,{k:()=>r});var a=s(40554);const r=(0,a.mq)("APP/OPEN_URL");(0,a.mq)("APP/RELOAD")},82680:(e,t,s)=>{s.d(t,{z:()=>a.z});var a=s(77904)},78059:(e,t,s)=>{s.d(t,{Dz:()=>r,I5:()=>i,py:()=>n});var a=s(43064);const r=(0,a.K)("ENTITY/FETCH_PROFILE_NO_TYPE"),n=(0,a.K)("ENTITY/FETCH_MULTIPLE"),i=(0,a.K)("ENTITY/FETCH_BY_POINT")},28026:(e,t,s)=>{s.d(t,{B:()=>a});const a=(0,s(43064).K)("REVIEW/FETCH_REVIEWS")},85950:(e,t,s)=>{s.d(t,{o:()=>a});const a=e=>({type:"ENTITY/FETCH_VIDEO_DATA",payload:e,async:!0})},97480:(e,t,s)=>{s.d(t,{Hu:()=>o,K6:()=>c,am:()=>n,fA:()=>r,it:()=>i,nV:()=>u,we:()=>d});var a=s(43064);const r=e=>({type:"FEEDBACK/SEND",payload:e,async:!0}),n=(0,a.K)("FEEDBACK/REVIEW_COMPLAINT"),i=(0,a.K)("FEEDBACK/STORY_COMPLAINT"),c=e=>({type:"FEEDBACK/PHOTO_COMPLAINT",payload:e,async:!0}),o=e=>({type:"FEEDBACK/SEND_TYPED",payload:e,async:!0}),d=e=>({type:"FEEDBACK/FETCH_USER_FEEDBACKS",payload:e,async:!0}),u=e=>({type:"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT",payload:e,async:!0})},2878:(e,t,s)=>{s.d(t,{O8:()=>a,OE:()=>r,lO:()=>n});const a=e=>({type:"HISTORY/PUSH",payload:e,history:!0}),r=()=>({type:"HISTORY/BACK",history:!0}),n=e=>({type:"HISTORY/REPLACE_STATE",payload:e,history:!0})},62377:(e,t,s)=>{s.d(t,{RQ:()=>o,V1:()=>i,X:()=>n,mt:()=>c});var a=s(43064),r=s(40554);(0,a.K)("MARKET/FETCH_PRODUCT_BY_ID");const n=(0,a.K)("MARKET/FETCH_CATEGORIES_BY_BRANCH"),i=(0,a.K)("MARKET/FETCH_BRANCH_PRODUCTS"),c=((0,a.K)("MARKET/FETCH_OFFERS"),(0,a.K)("MARKET/FETCH_SUGGESTIONS")),o=(0,r.mq)("MARKET/DROP_SUGGESTIONS")},1882:(e,t,s)=>{s.d(t,{E:()=>a});const a=(0,s(43064).K)("SEARCH_HISTORY/CLEAR_SEARCH_HISTORY")},35125:(e,t,s)=>{s.d(t,{HV:()=>i,R:()=>n,TU:()=>r,k8:()=>c});var a=s(40554);const r=e=>({type:"REGION/FETCH",payload:e,async:!0}),n=e=>({type:"REGION/DETECT",payload:e,async:!0}),i=()=>({type:"REGION/CLEAR_DETECTOR"}),c=(0,a.mq)("REGION/SET_DETECTOR")},31763:(e,t,s)=>{s.d(t,{I:()=>a});const a=e=>({type:"SEARCH/FETCH_PROVIDERS",payload:e,async:!0})},18799:(e,t,s)=>{s.d(t,{I:()=>r,Y:()=>a});const a=e=>({type:"SEARCH/FETCH_FILIALS",payload:e,async:!0}),r=e=>({type:"SEARCH/FETCH_FILIALS_FILTERS",payload:e,async:!0})},53328:(e,t,s)=>{s.d(t,{Z:()=>r,a:()=>n});var a=s(43064);const r=(0,a.K)("SEARCH/BY_BUILDING_ID"),n=(0,a.K)("SEARCH/IN_BUILDING_BY_QUERY")},60067:(e,t,s)=>{s.d(t,{r:()=>a});const a=e=>({type:"SEARCH/FETCH_MAINTAINERS",payload:e,async:!0})},60284:(e,t,s)=>{s.d(t,{Hq:()=>a,a$:()=>i,fE:()=>n,l1:()=>r});const a=(0,s(43064).K)("SEARCH/FETCH_QUERY"),r=e=>({type:"SEARCH/FETCH_RUBRIC",payload:e,async:!0}),n=e=>({type:"SEARCH/FETCH_ATTRIBUTE",payload:e,async:!0}),i=e=>({type:"SEARCH/FETCH_FILTERS",payload:e,async:!0})},9801:(e,t,s)=>{s.d(t,{DF:()=>a,ej:()=>r});const a=(0,s(43064).K)("SEARCH/FETCH_OBJECT_SUGGESTIONS"),r=()=>({type:"SEARCH/CROP_SUGGESTION"})},73364:(e,t,s)=>{s.d(t,{T:()=>n});var a=s(43064),r=s(40554);(0,a.K)("SEO_STORE/FETCH");const n=(0,r.mq)("SEO_STORE/CLEAR_MINI_TEXT")},53074:(e,t,s)=>{s.d(t,{Tj:()=>c,hL:()=>r,l6:()=>n,nc:()=>i});var a=s(40554);const r=e=>({type:"USER/FOLLOW_LOCATION",payload:e}),n=e=>({type:"USER/SET_LOCATION",payload:e}),i=e=>({type:"USER/SET_WINDOW_SIZE",payload:e}),c=((0,a.mq)("USER/SET_STAT_HASH"),(0,a.mq)("USER/SET_3D_MAP_ENABLED_STATUS"))},88032:(e,t,s)=>{s.d(t,{mn:()=>n,q_:()=>r,zA:()=>i});var a=s(40554);const r=(0,a.mq)("TIME/SET"),n=(0,a.mq)("TIME/SET_DELTA"),i=(0,a.mq)("TIME/SET_TIMEZONE")},31389:(e,t,s)=>{s.d(t,{EC:()=>n,Fd:()=>p,Hg:()=>c,Wj:()=>d,cE:()=>i,cZ:()=>g,ck:()=>b,kR:()=>u,ks:()=>l,tF:()=>o});var a=s(43064),r=s(40554);const n=e=>({type:"USER/CONFIRM_REGISTRATION",payload:e,async:!0}),i=e=>({type:"USER/FETCH_REVIEWS",payload:e,async:!0}),c=(0,a.K)("USER/DELETE_REVIEW"),o=(0,r.mq)("USER/ADD_HISTORY_OBJECT"),d=(0,r.mq)("USER/ADD_HISTORY_SEARCH"),u=(0,a.K)("USER/SAVE_HISTORY"),l=(0,a.K)("USER/LOAD_HISTORY"),g=(0,a.K)("USER/CLEAR_HISTORY"),p=(0,r.mq)("USER/ACTIVATE_MY_GEOLOCATION"),b=(0,r.mq)("USER/DEACTIVATE_MY_GEOLOCATION");(0,r.mq)("USER/CLEAR_DEVICES")},10694:(e,t,s)=>{s.d(t,{$c:()=>l,KM:()=>u,f3:()=>d,wN:()=>o});var a=s(70021),r=s(24777),n=s(51436),i=(s(55476),s(34423)),c=s(67753);function o(e,t){return(0,c.xJ)((s=>{const r=(0,a.wj)({state:s,entityId:e.entityId,searchId:e.searchId});return t(r,s)}))}function d(e,t){return(0,c.xJ)((s=>{const a=(0,r.Tt)({state:s,id:e});return t(a,s)}))}function u(e,t){return(0,c.xJ)((s=>{const a=(0,n.h)({state:s,id:e});return t(a,s)}))}function l(e,t){return(0,c.xJ)((s=>{const a=(0,i.m)({state:s,statusId:e});return t(a)}))}},32712:(e,t,s)=>{s.d(t,{GM:()=>a,u9:()=>n,zc:()=>i,zs:()=>r});const a=e=>({type:"BSS/TRACK_SHOW",payload:e,bssV3:!0}),r=e=>({type:"BSS/TRACK_ACTION",payload:e,bssV3:!0}),n=e=>({type:"BSS/TRACK_AUDIENCE_COUNTER",payload:e,bssV3:!0}),i=e=>({type:"BSS/DEFER_EVENT_ORDINAL",payload:e,bssV3:!0})},78163:(e,t,s)=>{s.d(t,{D:()=>d});var a=s(99924),r=s(55476),n=s(11431),i=s(64693),c=s(88798),o=s(41637);function d(e){const{apikey:t,commitIsoDate:s,state:d,eventParams:u,enhancedAttrs:l,deviceLocale:g,tabId:p,abTest:b,clientId:O,isMobileDevice:f,sendPrivacyData:E}=e,m=(0,r.bG)(d);return Object.assign(Object.assign({common:{formatVersion:3,appVersion:(0,c.n)(s),product:O,apikey:t,apikeyStatus:1,deviceLocale:g,user:E?d.session.userId:null,ip:E?d.session.ip:(0,i.d4)(d.session.ip),sessionId:d.config.sessionId,userAgent:d.session.userAgent,authUser:m&&m.data&&m.data.user_id,deviceType:f?"mobile":"desktop",personalDataCollectionAllowed:E,tabIsActive:!document.hidden},map:l.map,utcOffset:(0,n.k)(d.session.timezone),tabId:p||d.config.tabId,timestamp:(0,a.u)(d.session.timeDelta)},u),{abTest:b&&b.length>0?b:void 0,screenState:(0,o.u)()})}},86740:(e,t,s)=>{s.d(t,{z:()=>g});var a=s(52322),r=s(2784),n=s(32712),i=s(64693),c=s(32599),o=s(33511),d=s(67753),u=s(27215),l=s(61626);function g(e,t,s){return function(g){class p extends r.PureComponent{constructor(t){super(t),this.state={showEventOrdinal:void 0},this.wasMounted=!1,this.refEl=null,this.generateShowEventBssParams=()=>{if(!e)return;const t=(0,i.by)(),s=e(this.props,this.context.store.getState());return s?Object.assign({showEventKey:t},s):void 0},this.enhancedDispatch=t=>{const a=this.context.store.dispatch;if(!e||s&&s.trackActionsRegardlessOfShow)return a(t);if(void 0!==this.state.showEventOrdinal)return a(t);const r=this.generateShowEventBssParams();return r?a((0,d.vP)((0,n.GM)(Object.assign(Object.assign({},r),{autoEvent:!0})),t)):(0,d.ZT)()},this.sendShowEvent=()=>{const e=this.generateShowEventBssParams();e&&this.context.store.dispatch((0,d.vP)((0,n.GM)(e),(0,d.PQ)((()=>{const t=(0,l.JL)(e.showEventKey);return this.wasMounted&&this.setState({showEventOrdinal:t}),(0,d.ZT)()}))))},this.componentRef=e=>{e&&(this.refEl=e,this.initObserver(e))}}componentDidUpdate(e){const t=s&&s.forceSendShowIfPropsChanged;if(t){t.some((t=>this.props[t]!==e[t]))&&this.refEl&&!this.observer&&this.initObserver(this.refEl)}}componentDidMount(){this.wasMounted=!0}componentWillUnmount(){this.destroyObserver(),this.wasMounted=!1}render(){const e=Object.assign(Object.assign({},this.props),{showEventOrdinal:this.state.showEventOrdinal}),s=t?t(this.enhancedDispatch,e):void 0;return(0,a.jsx)(g,Object.assign({},e,s,{bssRef:this.componentRef,sendShowEvent:this.sendShowEvent}))}initObserver(t){if(!this.context.store||!e)return;if(s&&s.forcedIntersection)return void this.sendShowEvent();const a=s&&void 0!==s.threshold?s.threshold:0;this.observer=(0,c.A)(t,{threshold:a},(e=>{e.some((e=>e.isIntersecting||void 0===e.isIntersecting))&&(this.sendShowEvent(),this.destroyObserver())}))}destroyObserver(){this.observer&&(this.observer.disconnect(),this.observer=void 0)}}p.displayName=`WithBss(${g.displayName||g.name||"Unnamed"})`,p.contextType=u.ET;return e=>(0,a.jsx)(o.j.Consumer,{children:t=>(0,a.jsx)(p,Object.assign({ownerFrameId:t.frameId},e))})}}},33511:(e,t,s)=>{s.d(t,{j:()=>a});const a=s(2784).createContext({frameId:""})},66908:(e,t,s)=>{s.d(t,{T:()=>g});var a=s(2784),r=s(33511),n=s(27215),i=s(64693),c=s(32599),o=s(67753),d=s(32712),u=s(61626);const l="undefined"!=typeof window&&void 0!==window.document&&void 0!==window.document.createElement?a.useLayoutEffect:a.useEffect;function g(e,t){const s=(0,a.useContext)(r.j),i=(0,n.oR)(),[g,b]=(0,a.useState)(void 0),O=(0,a.useRef)(!1),f=(0,a.useRef)(!1),E=(0,a.useRef)(),m=(0,a.useRef)(null),h=(0,a.useRef)((()=>{})),j=(0,a.useRef)(void 0);l((()=>{h.current=t=>{if(!e&&t)return void i.dispatch(t);if(!0===f.current)return;j.current=p(e,s,i.getState());const a=j.current;a&&(f.current=!0,i.dispatch((0,o.vP)((0,d.GM)(Object.assign({autoEvent:!!t||void 0},a)),(0,o.PQ)((()=>{const e=(0,u.JL)(a.showEventKey);return O.current&&b(e),(0,o.ZT)()})),t||(0,o.ZT)())))}}),[s,e]),(0,a.useEffect)((()=>(O.current=!0,()=>{O.current=!1})),[]),(0,a.useEffect)((()=>{t&&t.forceSendShowIfParamsChanged&&f.current&&(f.current=!1)}),t&&t.forceSendShowIfParamsChanged?t&&t.forceSendShowIfParamsChanged:[]),(0,a.useEffect)((()=>{if(!e||!m.current||f.current)return;if(t&&t.forcedIntersection)return void h.current();const s=t&&void 0!==t.threshold?t.threshold:0;return E.current=(0,c.A)(m.current,{threshold:s},(e=>{var t;e.some((e=>e.isIntersecting||void 0===e.isIntersecting))&&(h.current(),null===(t=E.current)||void 0===t||t.disconnect(),E.current=void 0)})),()=>{var e;null===(e=E.current)||void 0===e||e.disconnect(),E.current=void 0}}),[e]);return{showEventOrdinal:g,bssRef:m,sendShowEvent:h,useBssHandler:(t,r)=>{const n=(0,a.useRef)(r),c=(0,a.useCallback)((a=>{f.current||(j.current=p(e,s,i.getState()));const r={frameId:s.frameId,showEventParams:j.current},c=t(n.current)(r,i.getState(),a);if(!c)return;const o=(0,d.zs)(c);!f.current&&j.current?(h.current(o),E.current&&(E.current.disconnect(),E.current=void 0)):i.dispatch(o)}),[t,s.frameId]);return l((()=>{n.current=r})),c}}}function p(e,t,s){if(!e)return;const a=(0,i.by)(),r=e(t,s);return r?Object.assign({showEventKey:a},r):void 0}},34323:(e,t,s)=>{s.d(t,{X:()=>i});var a=s(32712),r=s(67753);function n(e,t){const[s,a]=e.split("?"),r=a&&a.split("&").filter((e=>e.split("=")[0]!==t)).join("&");return r?[s,r].join("?"):s}const i=(0,r.gQ)("trackInitialBssEvents",(e=>(0,r.vP)((0,a.zs)({uiElement:{name:"application"},payload:{launch:{link:n(e.link,"stat"),referrer:e.refererHost,utm:e.utm,crossTab:e.crossTab?{parentTabId:e.crossTab.parentTabId,forkEventOrdinal:e.crossTab.forkEventOrdinal,uiElement:e.crossTab.uiElement}:void 0},placeItem:e.crossTab?e.crossTab.placeItem:void 0,searchResultsList:e.crossTab?e.crossTab.searchResultsList:void 0},action:"launch"}),(0,a.u9)({payload:{audienceCounter:{counterType:"launch",link:n(e.link,"stat"),segmentInfo:{segmentId:e.overlapRegionId,baseLocale:e.dataLocale},referrer:e.refererUrl,utm:e.utm}}}),(()=>{if(!e.searchFrameParams)return!1;const{query:t,rubricId:s}=e.searchFrameParams,r={uiElement:{name:"searchStart",ownerName:"application"},payload:{searchRequest:{text:t,entities:s?[{id:s,type:"rubric"}]:void 0}},autoEvent:!0,action:"tap"};return(0,a.zs)(r)})())))},23:(e,t,s)=>{s.d(t,{n:()=>I});var a=s(22970),r=s(64693);function n(e,t){switch(e.type){case"BSS/TRACK_ACTION":return s=Object.assign(Object.assign({},e.payload),{eventOrdinal:t}),{type:211,eventType:"action",eventId:(0,r.by)(),actionType:s.action,eventOrdinal:s.eventOrdinal,uiElement:s.uiElement,autoEvent:s.autoEvent,payload:s.payload};case"BSS/TRACK_SHOW":return function(e){return{type:212,eventType:"view",eventId:(0,r.by)(),eventOrdinal:e.eventOrdinal,uiElement:e.uiElement,autoEvent:e.autoEvent,payload:"payload"in e?e.payload:void 0}}(Object.assign(Object.assign({},e.payload),{eventOrdinal:t}));case"BSS/TRACK_AUDIENCE_COUNTER":return function(e){return{type:205,eventType:"audienceCounter",eventId:(0,r.by)(),payload:"payload"in e?e.payload:void 0}}(e.payload);default:return}var s}var i=s(78163),c=s(61626);function o(){let e=()=>{},t=!1;return{promise:new Promise((t=>{e=t})).then((()=>{t=!0})),resolve:e,isResolved:()=>t}}var d=s(77878),u=s(4283);const l=500,g=2047;function p(e,t){let s=0;const{whenFrameShowTracked:l,resolveFrameShowTracked:g,isFrameShowTracked:p}=function(){const e={};return{isFrameShowTracked:t=>e[t]&&e[t].isResolved(),whenFrameShowTracked:t=>(e[t]||(e[t]=o()),e[t].promise),resolveFrameShowTracked:t=>{e[t]||(e[t]=o()),e[t].resolve()}}}();return o=>O=>f=>f.bssV3?"BSS/DEFER_EVENT_ORDINAL"===f.type?(s+=1,o.dispatch(f.payload(s-1))):(function(o,O){(0,a.mG)(this,void 0,void 0,(function*(){const a="dangerouslyForcedEventOrdinal"in O.payload?O.payload.dangerouslyForcedEventOrdinal:void 0,f=null!=a?a:s;if(o.session.isSearchBot)return;if("BSS/TRACK_ACTION"===O.type&&(0,u.J)("sessionUpdatedAt",String(Date.now())),"BSS/TRACK_ACTION"===O.type&&"frameUuid"in O.payload.uiElement){const e=O.payload.uiElement.frameUuid;p(e)||(yield l(e))}const E=t.paramsEnhancer(o),m=n(O,f),h=m?(0,i.D)({apikey:t.apikey,commitIsoDate:t.commitIsoDate,deviceLocale:o.session.browserLocale,state:o,eventParams:m,enhancedAttrs:E,abTest:t.abTest,clientId:t.clientId,isMobileDevice:t.isMobileDevice,sendPrivacyData:t.sendPrivacyData}):void 0;if(!h)return void(0,d.H)({message:"bssTracker error: Не удалось сформировать события для bss-экшена",level:"error",id:"fkkw3",payload:{type:"debug",subtype:"BssTrackerV3",data:JSON.stringify(O)}});const j=h.payload,y=Object.assign(Object.assign({},h),{payload:b(j)});"BSS/TRACK_SHOW"===O.type&&((0,c.H4)(O.payload.showEventKey,s),"type"in O.payload.uiElement&&"frame"===O.payload.uiElement.type&&g(O.payload.uiElement.uuid)),(0,r.uv)(y),e(y),"BSS/TRACK_AUDIENCE_COUNTER"!==O.type&&f===s&&(s+=1)}))}(o.getState(),f),O(f)):O(f)}function b(e){var t;return e&&"searchRequest"in e&&e.searchRequest&&"text"in e.searchRequest?Object.assign(Object.assign({},e),{searchRequest:Object.assign(Object.assign({},e.searchRequest),{text:null===(t=e.searchRequest.text)||void 0===t?void 0:t.substr(0,l)})}):e&&"audienceCounter"in e?Object.assign(Object.assign({},e),{audienceCounter:Object.assign(Object.assign({},e.audienceCounter),{link:e.audienceCounter.link.substr(0,g)})}):e&&"launch"in e?Object.assign(Object.assign({},e),{launch:Object.assign(Object.assign({},e.launch),{link:e.launch.link.substr(0,g)})}):e}function O(e){Array.isArray(e)?e.forEach((e=>{m(e,{withStyles:true})})):m(e,{withStyles:true})}const f="font-size: 14px; line-height: 20px;",E=f+"font-weight: bold;";function m(e,t){if("audienceCounter"!==e.eventType&&(t.withStyles?console.log(`%c Номер события: %c${e.eventOrdinal} `,f,E):console.log(`Номер события: ${e.eventOrdinal} `)),"audienceCounter"===e.eventType)t.withStyles?console.log("%c Тип события:   %caudienceCounter 🔢 ",f,E):console.log("Тип события:   audienceCounter 🔢 ");else switch(e.eventType){case"action":if("textInput"===e.actionType){h(e,"🎹",t);break}h(e,"🎬",t);break;case"view":h(e,"👀",t);break;default:h(e,"🤔",t)}!function(e){const t=JSON.parse(JSON.stringify(e));function s(e){const t=JSON.parse(JSON.stringify(e));if(delete t.common,delete t.tabId,delete t.eventId,t&&"object"==typeof t){t.__proto__=null;for(const e in t)null!==t[e]&&void 0!==t[e]&&(t[e]=s(t[e]))}return t}delete t.type,delete t.timestamp,delete t.utcOffset,console.log.apply(console,[s(t)])}(e),console.log("%c ________________________________________\n",E)}function h(e,t,s){const a=`${e.uiElement&&e.uiElement.name||"unknown"} ${t}`,r=e.actionType?`- ${e.actionType}`:"",n=function(e,t){switch(e){case"action":return"textInput"===t?"185,182,73":"41,148,0";case"view":return"0,114,206";default:return"225,0,0"}}(e.eventType,e.actionType),i=`background: rgba(${n}, .1)`;s.withStyles?console.log(`%c Имя элемента:  %c${a} ${r} `,`${f} ${i}`,E+`color: rgb(${n}); ${i}`):console.log(`Имя элемента:   ${a} ${r}`)}function j(e){const t=window;t.testHandles=t.testHandles||{},t.testHandles.bssRawLog=t.testHandles.bssRawLog||{},t.testHandles.bssRawLog.request=t.testHandles.bssRawLog.request||[],t.testHandles.bssRawLog.clear=()=>{t.testHandles.bssRawLog.request=[]},t.testHandles.bssRawLog.request.push(e)}const y=2e3;function v(e,t){let s=[],a=!1;const n=function(e){const t=window,s=void 0!==t.bssV3Extention?t.bssV3Extention():r.ZT,a=e.bssdbgmd?O:r.ZT,n=e.analyticsBssEnableTestHandles?j:r.ZT;return e=>{s(e),n(e),a(e)}}(t);return t=>{n(t),s.push(t),a||(a=!0,setTimeout((()=>{e.track(s),s=[],a=!1}),y))}}var S=s(60923),_=s(90901);class R{constructor(e,t){this.queue=[],this.canRetry=!0,this.isOffline=!1,this.baseUrl=t.analyticsBssUrl,this.noDelay=t.noDelay,this.url=this.getRegEventUrl(),this.request=e,this.delayTime=250,this.clientTimeout=3e4,this.bssDbgMode=t.bssDbgMode,t.enableTestHandles&&(this.testHandles=function(){if("undefined"==typeof window)return;const e=window;return e.testHandles=e.testHandles||{},e.testHandles.bssErrors=e.testHandles.bssErrors||[],e.testHandles.bssLog=new _.T,e.testHandles.setQueueState=t=>e.testHandles.isQueueEmpty=t,e.testHandles.setBssValidationError=t=>{e.testHandles.bssErrors.push(...t.map((e=>({message:JSON.stringify(e.message,void 0,2),validation_error:JSON.stringify(e.validation_error,void 0,2)}))))},e.testHandles}())}changeOnlineStatus(e){this.isOffline=e,e||this.startQueue()}track(e){this.url&&this.addToQueue(this.url,e)}getEvents(){return[]}addToQueue(e,t){this.queue.push({url:e,params:{data:t}}),this.startQueue(),this.testHandles&&this.testHandles.setQueueState(!1)}startQueue(){this.currentRequestData||this.isOffline||(this.currentRequestData=this.queue.shift(),this.currentRequestData&&this.doRequest(this.currentRequestData))}doRequest(e){const t={timeout:this.clientTimeout,method:"post",data:e.params.data};return this.request(e.url,t).then((e=>{if(202===e.status&&e.data){const s=e.data.checks.filter((e=>!e.valid));this.testHandles&&this.testHandles.setBssValidationError(s),this.bssDbgMode&&(t=s,console.group("bssv3 validation error"),t.forEach(((e,t)=>{console.group("Message "+t),console.groupCollapsed("message"),console.log(JSON.stringify(e.message,void 0,2)),console.groupEnd(),console.group("error"),console.log(JSON.stringify(e.validation_error,void 0,2)),console.groupEnd(),console.groupEnd()})),console.groupEnd())}var t;this.successHandler()})).catch((t=>{if(this.isOffline)return this.queue.unshift(this.currentRequestData),void(this.currentRequestData=void 0);let s;s=t instanceof S.d7?t.details.message:t.message||"Unknown error",this.errorHandler(e,s)}))}successHandler(){this.canRetry=!0,this.logRequest(),this.currentRequestData=this.queue.shift(),this.currentRequestData?this.delayRequest(this.currentRequestData):this.testHandles&&this.testHandles.setQueueState(!0)}errorHandler(e,t){if("0"!==t&&this.canRetry)return this.canRetry=!1,void this.delayRequest(e);(0,d.H)({message:`apiTracker error: ${t}`,level:"warn",id:"aibu0",payload:{type:"network",subtype:"BssTrackerV3",request_url:this.url,request_params:JSON.stringify(e)}}),this.successHandler()}delayRequest(e){this.noDelay?this.doRequest(e):setTimeout((()=>{this.doRequest(e)}),this.delayTime)}getRegEventUrl(){return this.baseUrl}logRequest(){this.testHandles&&this.testHandles.bssLog.setRequest(this.currentRequestData)}}function I(e,t){if("none"===e.bssSendingMode)return e=>t=>s=>s.bssV3?"BSS/DEFER_EVENT_ORDINAL"===s.type?e.dispatch(s.payload(0)):void 0:t(s);const s=(0,S.hG)(e,{GDPRAllowedServiceHosts:[e.bssV3Url]});return p(v(new R(s,{analyticsBssUrl:e.bssV3Url,enableTestHandles:e.analyticsBssEnableTestHandles,bssDbgMode:e.bssdbgmd}),e),{apikey:e.webApiKey,commitIsoDate:e.commitIsoDate,paramsEnhancer:t,abTest:e.experiments,clientId:Number(e.clientId),isMobileDevice:e.isMobileDevice,sendPrivacyData:"full"===e.bssSendingMode})}},61626:(e,t,s)=>{s.d(t,{H4:()=>r,JL:()=>n});let a={};function r(e,t){a[e]=t}function n(e){return a[e]}setInterval((function(){a={}}),18e5)},874:(e,t,s)=>{s.d(t,{Dn:()=>u,Iv:()=>p,LZ:()=>r,Mt:()=>i,Nu:()=>n,bw:()=>d,k8:()=>o,pA:()=>l,uR:()=>g,wp:()=>c,zO:()=>a});const a=["__empty","undefined"],r=[],n={},i="DEFAULT_SEARCH_ID",c={ru:"ru",kz:"kz",ae:"ae",cy:"com.cy",cz:"cz",it:"it",cl:"cl",kg:"kg",uz:"uz",az:"az",sa:"com",iq:"com",om:"com",qa:"qa",bh:"bh",eg:"com",kw:"com",by:"by",ma:"ma",am:"am"},o="__empty",d="65536",u="porch",l="transport",g=["bus","trolleybus","tram","shuttle_bus","metro","suburban_train","funicular_railway","monorail","river_transport","cable_car","light_rail","premetro","light_metro","aeroexpress","pedestrian","mcc","mcd"],p="default"},55795:(e,t,s)=>{s.d(t,{z:()=>i});var a=s(52034),r=s(874),n=s(73282);const i=e=>{const t=n.Q[e],s=a.get(t.name);if(s&&!r.zO.includes(s))return s}},89913:(e,t,s)=>{s(874),s(73282)},73282:(e,t,s)=>{s.d(t,{Q:()=>n});const a=7665,r=void 0,n={lang:{name:"dg5_lang",expires:a},pos:{name:"dg5_pos",expires:a},userId:{name:"_2gis_webapi_user",expires:a,shared:!0},sessionId:{name:"_2gis_webapi_session",expires:r,shared:!0},sessionUpdatedAt:{name:"_2gis_webapi_session_lut",expires:r,shared:!0},is3dDisabled:{name:"is3dDisabled",expires:a},bssDebugMode:{name:"dg5_bssdbgmd",expires:a},searchDebugMode:{name:"dg5_srchdbgmd",expires:a},mapDebugMode:{name:"dg5_mapdbgmd",expires:a},_searchbot:{name:"_searchbot",expires:a},overrideConfig:{name:"dg5_override_config",expires:r},jurisdiction:{name:"dg5_jur",expires:a},museumAccept:{name:"dg5_museum_accept",expires:a},project:{name:"project",expires:a},flags:{name:"dg5_flags",expires:a},monlineFlags:{name:"flags",expires:a}}},4283:(e,t,s)=>{s.d(t,{J:()=>i});var a=s(52034),r=s(73282);function n(e){const[t,s,a]=e.split(".").reverse();return s?"cy"===t&&"com"===s?`.${a}.${s}.${t}`:`.${s}.${t}`:e}const i=(e,t,s)=>{const i=r.Q[e],c={expires:i.expires?i.expires:void 0,domain:i.shared?n(window.location.hostname):void 0};if(t)return a.set(i.name,t,c),s?s(i.name,t,c):void 0;a.remove(i.name,c)}},68817:(e,t,s)=>{s.d(t,{C:()=>r,W:()=>a});const a=["new","in_progress","ready_for_delivery","delivery"],r=["sent_to_company","canceled","returned","done"]},55340:(e,t,s)=>{s.d(t,{v:()=>a});const a=["656x340","328x170","232x232","176x176","116x116","88x88"]},38537:(e,t,s)=>{s.d(t,{$O:()=>n,Wz:()=>r.W});var a,r=s(68817);!function(e){e.active="active",e.blocked="blocked",e.hidden="hidden"}(a||(a={}));const n=e=>"real_object_type"in e;s(6113)},48015:(e,t,s)=>{s.d(t,{H:()=>r});var a=s(22970);const r=(0,s(88757).G)("fetchUserAchievements",(({locale:e})=>({achievesApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return t.getUserAchievements({locale:e,accessToken:a})}))))},46083:(e,t,s)=>{s.d(t,{F:()=>o});var a=s(22970),r=s(88757),n=s(94142),i=s(99428);const c="default",o=(0,r.G)("fetchUserActivity",(()=>({userActivityApi:e,credentialsApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(!s)throw new Error("accessToken is missing");return e.getUserActivity({accessToken:s})}))),(0,n.r)("user",{start:e=>Object.assign(Object.assign({},e),{activities:{[c]:Object.assign(Object.assign({},e.activities[c]),{meta:i.qV})}}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{activities:{[c]:{data:null==t?void 0:t.activities,meta:i.YR}}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{activities:{[c]:Object.assign(Object.assign({},e.activities[c]),{meta:(0,i.UL)(t)})}})}))},45942:(e,t,s)=>{s.d(t,{V:()=>d,n:()=>o});var a=s(22970),r=s(88757),n=s(35571),i=s(23862);const c="default",o=(0,r.G)("fetchUserFriendsActivity",(e=>({userActivityApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{maxFriendsPerObject:a,objectsIds:r}=e,n=yield s.getToken();if(!n)throw new Error("accessToken is missing");return t.getUserFriendsActivityByObjects({accessToken:n,maxFriendsPerObject:a,objectsIds:r})})))),d=(0,i.KX)("fetchUserFriendsActivity",{start:e=>(0,n.Av)(e,c),success(e,{params:t,result:s}){var a,r;const i=t.objectsIds.reduce(((e,t)=>(e[t]=void 0,e)),{}),o=s.activities.reduce(((e,t)=>(e[t.object_id]=t,e)),{}),d=Object.assign(Object.assign(Object.assign({},i),null===(r=null===(a=e[c])||void 0===a?void 0:a.data)||void 0===r?void 0:r.items),o);return(0,n.Cj)(e,c,{items:d})},error:(e,{error:t})=>(0,n.VJ)(e,c,t)})},77419:(e,t,s)=>{s.d(t,{e:()=>r});var a=s(22970);const r=(0,s(88757).G)("fetchApartments",(e=>({webApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("There is no access token in fetchApartments");return t.fetchApartments({id:e.id,locale:e.locale,accessToken:a})}))))},10451:(e,t,s)=>{s.d(t,{M:()=>a,d:()=>r});const a="default",r="cart2gis"},18954:(e,t,s)=>{s.d(t,{Bk:()=>u,Fw:()=>l,HN:()=>d});var a=s(22970),r=s(88757),n=s(23862),i=s(35571),c=s(29759),o=s(10451);const d={orders:[],showCartButton:!1,customer:{}},u=(0,r.G)("createCart",(()=>()=>(0,a.mG)(void 0,void 0,void 0,(function*(){const e=JSON.parse(c.tO.local.getItem(o.d));return e&&e.orders?e:d})))),l=(0,n.Rs)("createCart","cart",{start:e=>(0,i.Av)(e,o.M),success:(e,{result:t})=>(0,i.Cj)(e,o.M,t),error:(e,{error:t})=>(0,i.VJ)(e,o.M,t)})},71259:(e,t,s)=>{s.d(t,{N:()=>d,y:()=>u});var a=s(22970),r=s(88757),n=s(23862),i=s(35571),c=s(29759),o=s(10451);const d=(0,r.G)("removeCart",(e=>()=>(0,a.mG)(void 0,void 0,void 0,(function*(){const t=c.tO.local.getItem(o.d),s=JSON.parse(t),a=Object.assign(Object.assign({},s),{orders:s.orders.filter((t=>t.orgId!==e.orgId))});return c.tO.local.setItem(o.d,JSON.stringify(a)),a})))),u=(0,n.Rs)("removeCart","cart",{start:e=>(0,i.Av)(e,o.M),success:(e,{result:t})=>(0,i.Cj)(e,o.M,t),error:(e,{error:t})=>(0,i.VJ)(e,o.M,t)})},27386:(e,t,s)=>{s.d(t,{j:()=>d,m:()=>u});var a=s(22970),r=s(88757),n=s(23862),i=s(35571),c=s(29759),o=s(10451);const d=(0,r.G)("replaceCart",(e=>()=>(0,a.mG)(void 0,void 0,void 0,(function*(){return{cart:e}})))),u=(0,n.Rs)("replaceCart","cart",{success(e,{result:t}){const s=t.cart;return c.tO.local.setItem(o.d,JSON.stringify(s)),(0,i.Cj)(e,o.M,s)}})},42067:(e,t,s)=>{s.d(t,{F:()=>d});var a=s(22970),r=s(88757),n=s(23862),i=s(35571),c=s(29759),o=s(10451);const d=(0,r.G)("saveCart",(e=>()=>(0,a.mG)(void 0,void 0,void 0,(function*(){var t;return{cart:null===(t=e.cartState[e.cartId])||void 0===t?void 0:t.data}}))));(0,n.Rs)("saveCart","cart",{success(e,{result:t}){const s=t.cart;return s?(c.tO.local.setItem(o.d,JSON.stringify(s)),(0,i.Cj)(e,o.M,s)):e}})},74614:(e,t,s)=>{s.d(t,{x:()=>b,p:()=>O});var a=s(22970),r=s(88757),n=s(23862),i=s(35571),c=s(29759),o=s(10451),d=s(83338),u=s(43606);function l(e,t){if(0===e.length)return[t];const[,s]=(0,d.U)(e,t);return-1===s?0===t.qty?e:[...e,t]:(0,u.g)(e,t,s)}var g=s(18954),p=s(19043);const b=(0,r.G)("updateCart",(e=>()=>(0,a.mG)(void 0,void 0,void 0,(function*(){return{item:e.item}})))),O=(0,n.Rs)("updateCart","cart",{start:e=>(0,i.Av)(e,o.M),success(e,{result:t}){var s;const a=(null===(s=e[o.M])||void 0===s?void 0:s.data)||g.HN,r=t.item.orgId,n=(0,p.F)(Object.assign(Object.assign({},a),{showCartButton:!0}),r,(e=>Object.assign(Object.assign({},e),{items:l(e.items,t.item)})));return c.tO.local.setItem(o.d,JSON.stringify(n)),(0,i.Cj)(e,o.M,n)},error:(e,{error:t})=>(0,i.VJ)(e,o.M,t)})},83338:(e,t,s)=>{s.d(t,{U:()=>n,k:()=>r});var a=s(34843);function r(e,t){const s=(0,a.L)(e.orders,t.orgId);return n((null==s?void 0:s.items)||[],t)}function n(e,t){const s=e.findIndex((e=>e.orgId===t.orgId&&e.productId===t.productId));return-1===s?[void 0,s]:[e[s],s]}},71626:(e,t,s)=>{s.d(t,{I:()=>o});var a=s(22970),r=s(88757),n=s(94142),i=s(99428);const c="default",o=(0,r.G)("fetchUserChronologyPlaces",(()=>({chronologyPlacesApi:e,credentialsApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();return e.getUserChronologyPlaces({accessToken:s})}))),(0,n.r)("user",{start:e=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:i.qV})}}),success(e,{result:t}){var s;if(!(null===(s=t.results)||void 0===s?void 0:s.length))return Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:(0,i.Mq)()})}});const a=t.results.map((e=>e.id));return Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:{data:{items:t.items.reduce(((e,t)=>(e[t.id]=t,e)),{}),resultsIds:a,total:a.length},meta:i.YR}}})},error:(e,{error:t})=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces),{meta:(0,i.UL)(t)})}})}))},4616:(e,t,s)=>{s.d(t,{f:()=>o});var a=s(22970),r=s(88757),n=s(94142),i=s(99428);const c="default",o=(0,r.G)("fetchUserChronologyPlacesByObject",(e=>({chronologyPlacesApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return t.getUserChronologyPlacesByObjects({ids:e.ids,accessToken:a})}))),(0,n.r)("user",{start:e=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:i.qV})}}),success(e,{result:t}){var s,a;const r=t.items.reduce(((e,t)=>(e[t.id]=t,e)),{}),n=e.chronologyPlaces[c];return(null==n?void 0:n.data)?Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:{data:Object.assign(Object.assign({},n.data),{items:Object.assign(Object.assign({},null===(a=null===(s=e.chronologyPlaces[c])||void 0===s?void 0:s.data)||void 0===a?void 0:a.items),r)}),meta:i.YR}}}):e},error:(e,{error:t})=>Object.assign(Object.assign({},e),{chronologyPlaces:{[c]:Object.assign(Object.assign({},e.chronologyPlaces[c]),{meta:(0,i.UL)(t)})}})}))},88247:(e,t,s)=>{s.d(t,{B:()=>c,F:()=>o});var a=s(22970),r=s(88757),n=s(23862),i=s(35571);const c=(0,r.G)("fetchUserContestStatusByContestId",(({contestId:e})=>({contestApi:t,contextApi:s,credentialsApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){var a;const n=yield r.getToken(),i=null!==(a=yield s.get("locale"))&&void 0!==a?a:"ru_RU";return t.getUserContestStatus({locale:i,accessToken:n,contestId:e})})))),o=(0,n.Rs)("fetchUserContestStatusByContestId","contests",{start:(e,{params:t})=>(0,i.Av)(e,t.contestId),success:(e,{result:t,params:s})=>(0,i.Cj)(e,s.contestId,t),error:(e,{error:t,params:s})=>(0,i.VJ)(e,s.contestId,t)})},27544:(e,t,s)=>{s.d(t,{f:()=>c,r:()=>o});var a=s(22970),r=s(88757),n=s(23862),i=s(35571);const c=(0,r.G)("joinUserInContest",(({locale:e,contestId:t})=>({contestApi:s,credentialsApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield r.getToken();return s.joinUser({locale:e,accessToken:a,contestId:t})})))),o=(0,n.Rs)("joinUserInContest","contests",{start:(e,{params:t})=>(0,i.Av)(e,t.contestId),success:(e,{result:t,params:s})=>(0,i.Cj)(e,s.contestId,t),error:(e,{error:t,params:s})=>(0,i.VJ)(e,s.contestId,t)})},68782:(e,t,s)=>{s.d(t,{k:()=>r});var a=s(22970);const r=(0,s(88757).G)("deleteCookie",(e=>({cookieApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{name:s}=e;yield t.setStrict(s,void 0)}))))},28564:(e,t,s)=>{s.d(t,{d:()=>r});var a=s(22970);const r=(0,s(88757).G)("setCookie",(e=>({cookieApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{name:s,value:a}=e;yield t.setStrict(s,a)}))))},7484:(e,t,s)=>{s.d(t,{U:()=>c});var a=s(88757),r=s(97825),n=s(94142),i=s(99428);const c=(0,a.G)("pedestrian",(({locale:e,projectCode:t,points:s,viewpoint:a,zoom:n})=>({directionsApi:i})=>{if(s.length<r.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для построения пешего маршрута. Нужно по крайней мере ${r.Kr}`};return Promise.reject(e)}if(!t){const e={name:"ParamsError",code:400,message:"Для поиска пеших маршрутов необходим код проекта"};return Promise.reject(e)}return i.pedestrian({projectCode:t,points:s,locale:e,viewpoint:a,zoom:n})}),(0,n.r)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:i.qV}}),success:(e,{params:t,result:s})=>s.items.length&&t.projectCode?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"pedestrian",items:s.items,total:s.total,projectCode:t.projectCode},meta:i.YR}}):Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.UL)(s)})})}))},23818:(e,t,s)=>{s.d(t,{b:()=>c});var a=s(88757),r=s(97825),n=s(94142),i=s(99428);const c=(0,a.G)("ppna",(({locale:e,points:t,viewpoint:s,zoom:a})=>({directionsApi:n})=>{if(t.length<r.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${r.Kr}`};return Promise.reject(e)}return n.ppna({points:t,locale:e,viewpoint:s,zoom:a})}),(0,n.r)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:i.qV}}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"ppna",items:s.items,total:s.total},meta:i.YR}}):Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.UL)(s)})})}))},40326:(e,t,s)=>{s.d(t,{Y:()=>d});var a=s(22970),r=s(88757),n=s(97825),i=s(99428),c=s(94142),o=s(35571);const d=(0,r.G)("ppng",(({locale:e,points:t,viewpoint:s,zoom:r,filterValues:c})=>({directionsApi:o})=>(0,a.mG)(void 0,void 0,void 0,(function*(){if(t.length<n.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${n.Kr}`};return Promise.reject(e)}const a=yield o.ppng({points:t,locale:e,viewpoint:s,zoom:r,filterValues:c});if(0===a.items.length)throw i.fD;const d=a.items.filter((e=>{var t;return"no"!==(null===(t=e.features)||void 0===t?void 0:t.truck)}));if(d.length!==a.items.length){if(0===d.length)throw Object.assign(Object.assign({},i.fD),{name:"PpngNotFoundButPpnaFound"});return Object.assign(Object.assign({},a),{items:d,total:d.length})}return a}))),(0,c.r)("directions",{start:(e,{params:t})=>(0,o.Av)(e,t.searchId),success:(e,{params:t,result:{items:s,total:a}})=>(0,o.Cj)(e,t.searchId,{type:"ppng",items:s,total:a}),error:(e,{params:t,error:s})=>(0,o.VJ)(e,t.searchId,s)}))},17385:(e,t,s)=>{s.d(t,{i:()=>c});var a=s(88757),r=s(97825),n=s(94142),i=s(99428);const c=(0,a.G)("ppnot",(({locale:e,projectCode:t,points:s,viewpoint:a,zoom:n,filterValues:i})=>({directionsApi:c})=>{if(s.length<r.Kr){const e={name:"ParamsError",code:400,message:`Недостаточно точек для поиска проезда. Нужно по крайней мере ${r.Kr}`};return Promise.reject(e)}if(!t){const e={name:"ParamsError",code:400,message:"Для ППНОТ необходим код проекта"};return Promise.reject(e)}return c.ppnot({projectCode:t,points:s,locale:e,viewpoint:a,zoom:n,filterValues:i})}),(0,n.r)("directions",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.searchId]:{meta:i.qV}}),success:(e,{params:t,result:s})=>s.items.length&&t.projectCode?Object.assign(Object.assign({},e),{[t.searchId]:{data:{type:"ppnot",items:s.items,total:s.total,projectCode:t.projectCode},meta:i.YR}}):Object.assign(Object.assign({},e),{[t.searchId]:{data:t.projectCode?{type:"ppnot",items:[],total:0,projectCode:t.projectCode}:void 0,meta:(0,i.Mq)()}}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:Object.assign(Object.assign({},e[t.searchId]),{meta:(0,i.UL)(s)})})}))},90321:(e,t,s)=>{s.d(t,{y:()=>i});var a=s(88757),r=s(94142),n=s(99428);const i=(0,a.G)("ppnotTypes",(({projectCode:e})=>({directionsApi:t})=>{if(!e){const e={name:"ParamsError",code:400,message:"Для получения ППНОТ типов необходим код проекта"};return Promise.reject(e)}return t.ppnotTypes({projectCode:e})}),(0,r.r)("directionsPpnotTypes",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.projectCode]:{meta:n.qV}}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.projectCode]:{data:s.items,meta:n.YR}}):Object.assign(Object.assign({},e),{[t.projectCode]:Object.assign(Object.assign({},e[t.projectCode]),{meta:(0,n.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.projectCode]:Object.assign(Object.assign({},e[t.projectCode]),{meta:(0,n.UL)(s)})})}))},77904:(e,t,s)=>{s.d(t,{b:()=>c,z:()=>i});var a=s(88757),r=s(23862),n=s(99428);const i=(0,a.G)("fetchEntityDiscounts",(e=>({discountsApi:t})=>t.getDiscounts({id:e.id}))),c=(0,r.KX)("fetchEntityDiscounts",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:n.qV})}),success:(e,{params:t,result:s})=>s.items.length?Object.assign(Object.assign({},e),{[t.id]:{data:{items:s.items,total:s.total},meta:n.YR}}):Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:(0,n.Mq)()})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},e[t.id]),{meta:(0,n.UL)(s)})})})},12463:(e,t,s)=>{s.d(t,{FG:()=>u,qA:()=>g,y8:()=>d,zb:()=>l});var a=s(88757),r=s(23862),n=s(89475),i=s(10982),c=s(64693),o=s(85884);const d=(0,a.G)("fetchEntityByEntrance",(e=>({webApi:t})=>t.getItemByEntrance({id:e.id}))),u=(0,r.xr)("fetchEntityByEntrance",{},{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.id]:{data:void 0,meta:n.qV}}),success:(e,{params:t,result:s})=>200!==s.code?e:Object.assign(Object.assign({},e),{[t.id]:{data:{id:s.items[0].id},meta:n.YR}}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.id]:{data:void 0,meta:(0,n.UL)(s)}})}),l=(0,r.KX)("fetchEntityByEntrance",{success(e,{result:t}){if(200!==t.code)return e;const s=t.items[0];if(!("id"in s))return e;const a=e[s.id],r=(0,c.$K)(a)&&(0,c.$K)(a.data)?a.data:{};return Object.assign(Object.assign({},e),{[s.id]:{data:Object.assign(Object.assign({},r),(0,o.Eb)(s)),meta:n.YR}})}}),g=e=>t=>t.data.entity.entrance[e]||i.Y},45843:(e,t,s)=>{s.d(t,{gM:()=>u});var a=s(22970),r=s(88757),n=s(64693),i=s(1184),c=s(63915),o=s(51554),d=s(86199);const u=(0,r.G)("syncPublicFavorites",(e=>({favoritesApi:t,favoritesStorage:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{projectId:a,sync:r}=e,u=yield s.getPublic(),l=yield t.syncPublicFavorites({filter:{attribute_name:"project_id",values:{[a]:u.sync.lastSyncAttr.project_id[a]||null}}}),g=(0,o.x)(u,l,{projectId:a});if(yield s.setPublic(g),!(0,c.u)(r,u.sync)||!(0,n.xb)(l.id_changes))return{sync:g.sync,objects:(0,d.x1)(g.objects),replace:!0};const p=Object.keys(l.objects),b=(0,n.Q8)((0,i.ei)(g.objects,p),d.Xy);return{sync:g.sync,objects:b,replace:!1}}))));s(52839),s(34072),s(51453),s(92244)},34072:(e,t,s)=>{s.d(t,{D:()=>d});var a=s(22970),r=s(88757),n=s(38700),i=s(64693),c=s(63915),o=s(86199);const d=(0,r.G)("modifyPersonalFavorites",(e=>({favoritesStorage:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getPersonal(),a=(0,n.M)({stored:s,modification:e.objects,time:String(Date.now())});return yield t.setPersonal(a),(0,c.u)(e.sync,s.sync)?{replace:!1,sync:a.sync,objects:e.objects}:{replace:!0,sync:a.sync,objects:(0,i.Q8)(a.objects,o.bq)}}))))},92244:(e,t,s)=>{s.d(t,{f:()=>d});var a=s(22970),r=s(88757),n=s(38700),i=s(64693),c=s(63915),o=s(86199);const d=(0,r.G)("modifyPlaces",(e=>({favoritesStorage:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getPlaces(),a=(0,n.M)({stored:s,modification:e.objects,time:String(Date.now())});return yield t.setPlaces(a),(0,c.u)(e.sync,s.sync)?{replace:!1,sync:a.sync,objects:e.objects}:{replace:!0,sync:a.sync,objects:(0,i.Q8)(a.objects,o.O2)}}))))},52839:(e,t,s)=>{s.d(t,{K:()=>u});var a=s(22970),r=s(88757),n=s(64693),i=s(1184),c=s(63915),o=s(51554),d=s(86199);s(34072);const u=(0,r.G)("syncPersonalFavorites",(e=>({favoritesApi:t,favoritesStorage:s,credentialsApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getPersonal();const u=yield r.getToken();if(!u)throw new Error("There is no access_token");const l=yield t.syncPersonalFavorites({last_sync:a.sync.lastSync,objects:a.changes,access_token:u}),g=(0,o.x)(a,l);if(yield s.setPersonal(g),!(0,c.u)(e.sync,a.sync)||!(0,n.xb)(l.id_changes))return{sync:g.sync,objects:(0,n.Q8)(g.objects,d.bq),replace:!0};const p=Object.keys(l.objects),b=(0,n.Q8)((0,i.ei)(g.objects,p),d.bq);return{sync:g.sync,objects:b,replace:!1}}))))},51453:(e,t,s)=>{s.d(t,{s:()=>u});var a=s(22970),r=s(88757),n=s(64693),i=s(1184),c=s(63915),o=s(51554),d=s(86199);const u=(0,r.G)("syncPlaces",(e=>({favoritesApi:t,favoritesStorage:s,credentialsApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getPlaces(),u=yield r.getToken();if(!u)throw new Error("There is no access_token");const l=yield t.syncPlaces({last_sync:a.sync.lastSync,objects:a.changes,access_token:u}),g=(0,o.x)(a,l);if(yield s.setPlaces(g),!(0,c.u)(e.sync,a.sync)||!(0,n.xb)(l.id_changes))return{sync:g.sync,objects:(0,n.Q8)(g.objects,d.O2),replace:!0};const p=Object.keys(l.objects),b=(0,n.Q8)((0,i.ei)(g.objects,p),d.O2);return{sync:g.sync,objects:b,replace:!1}}))))},51554:(e,t,s)=>{s.d(t,{x:()=>n});var a=s(64693);function r(e,t){if(0===Object.keys(t).length)return e;const s=(0,a.Q8)(t,((t,s)=>{if(!t||!t.system_is_deleted||"true"!==t.system_is_deleted[0])return Object.assign(Object.assign({},e[s]),t)}));return Object.assign(Object.assign({},e),s)}function n(e,t,s){const n=(i=e.objects,!(c=t.id_changes)||(0,a.xb)(c)?i:Object.keys(i).reduce(((e,t)=>{const s=c[t]?c[t]:t;return Object.assign(Object.assign({},e),{[s]:i[t]})}),{}));var i,c;return{sync:{lastSync:t.curr_sync,lastSyncAttr:s?{project_id:Object.assign(Object.assign({},e.sync.lastSyncAttr.project_id),{[s.projectId]:t.curr_sync})}:e.sync.lastSyncAttr},objects:r(n,t.objects),changes:{}}}},38700:(e,t,s)=>{s.d(t,{M:()=>o});var a=s(64693),r=s(89679),n=s(62662);var i=s(32655),c=s(53654);function o(e){const{stored:t,modification:s,time:i}=e,c=(0,a.Q8)(s,(e=>function(e){if(!e||!Object.keys(e).length)return;const t=(0,a.Q8)(e,((e,t)=>{if(null!=e){if(Array.isArray(e))return e.map((e=>String(e)));if((0,n.S)(e))return[(0,r.DF)(e)];if((0,a.Kn)(e))try{return[JSON.stringify(e)]}catch(e){throw new Error(`invalid ${t}. Can't make json from object`)}return[String(e)]}}));return delete t.id,t}(e)));return Object.assign(Object.assign({},t),{objects:Object.assign(Object.assign({},t.objects),c),changes:d(t.objects,t.changes,c,i)})}function d(e,t,s,r){const n=(0,i.Y)((0,a.Q8)(s,((t,s)=>{const a=e[s];if(void 0===t){if(void 0===a)return;return{system_is_deleted:{time:r,value:["true"]}}}return u(void 0===a?{}:a,t,r)})));return(0,c.T)(t,n,((e,t)=>e&&t?function(e,t){if(l(t))return t;if(l(e))return t;const s=Object.assign({},e);for(const a in t)if(t.hasOwnProperty(a)){const r=e[a],n=t[a];if(!n)continue;if(!r){s[a]=t[a];continue}g(r.value,n.value)||(s[a]=t[a])}if(0===Object.keys(s).length)return;return s}(e,t):t||e))}function u(e,t,s){const a=(0,i.Y)((0,c.T)(e,t,((e,t)=>{if(e||t){if(!e)return{time:s,value:t||null};if(!g(e,t))return{time:s,value:t||null}}})));if(0!==Object.keys(a).length)return a}function l(e){return!(!e.system_is_deleted||!e.system_is_deleted.value||"true"!==e.system_is_deleted.value[0])}function g(e,t){if(!e||!t)return!e==!t;if(e.length!==t.length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}},86199:(e,t,s)=>{s.d(t,{O2:()=>d,Xy:()=>l,bq:()=>g,x1:()=>u});var a=s(73198),r=s(64693),n=s(89679),i=s(66010);function c(e,t){if(!e||!e.type||!e.type.length)return;const s=(0,r.Q8)(e,((e,t)=>{let s=e&&e[0];if(null==e)s=void 0;else if((0,i.w)(a.NY,t))switch(a.NY[t]){case"boolean":s="true"===e[0].toLowerCase();break;case"number":s=Number(e[0]);break;case"lonlat":s=(0,n.rx)(e[0]);break;case"array":s=[...e];break;case"object":try{s=JSON.parse(e[0])}catch(e){s=void 0}}return s}));return s.id=t,s}const o=["interesting","guidebook","awards2019","shared_collections"];function d(e,t){const s=c(e,t);return s&&"place"===s.type?s:void 0}function u(e){const t={},s={},a=s=>{const a=l(e[s],s);a&&(t[s]=a)};for(const r in e){const n=e[r];if(n)switch(n.type&&n.type[0]){case"theme":n.code&&o.includes(n.code[0])&&(a(r),n.collections&&n.collections.forEach((e=>{a(e);const t=s[e];t&&t.forEach((e=>{a(e)}))})));break;case"favorite":{const e=n.collection_id&&n.collection_id[0];if(e)if(t[e])a(r);else{(s[e]||(s[e]=[])).push(r)}break}}}return t}function l(e,t){const s=c(e,t);if(s&&("favorite"===s.type||"collection"===s.type||"theme"===s.type))return"favorite"===s.type&&delete s.source_data,s}function g(e,t){const s=c(e,t);if(s&&("favorite"===s.type||"collection"===s.type))return s}},79876:(e,t,s)=>{s.d(t,{G:()=>i});var a=s(62662),r=s(64693),n=s(73198);function i(e,t){const s="point"===t.object_type&&void 0===e.object_id||e.object_id===t.object_id;if("point"===t.object_type&&!(0,a.S)(t.point))return!1;if(!s||!n.vT.includes(t.object_type))return s;const i=e.point||e.source_point;return(0,a.S)(i)||(0,a.S)(t.point)?!(!(0,a.S)(i)||!(0,a.S)(t.point))&&((0,r.G9)(i.lon,t.point.lon)&&(0,r.G9)(i.lat,t.point.lat)):s}},63915:(e,t,s)=>{function a(e,t){if(e.lastSync!==t.lastSync)return!1;if(Object.keys(e.lastSyncAttr.project_id).length!==Object.keys(t.lastSyncAttr.project_id).length)return!1;for(const s in e.lastSyncAttr.project_id)if(e.lastSyncAttr.project_id[s]!==t.lastSyncAttr.project_id[s])return!1;return!0}s.d(t,{u:()=>a})},79339:(e,t,s)=>{s.d(t,{k:()=>c});var a=s(22970),r=s(89475),n=s(82358),i=s(94142);const c=(0,s(88757).G)("fetchUserHistory",(({userId:e,authId:t})=>({webApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){return s.getProfile({userId:e,authId:t})}))),(0,i.r)("profile",{start:e=>Object.assign(Object.assign({},e),{meta:r.qV}),success(e,{result:t}){if(!t||200!==t.code)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{suggestLastObjects:[]}),meta:r.YR});const{last_objects:s,history_objects:a,home_work_objects:n}=t;return{data:{historyObjects:a,homeWorkObjects:n,suggestLastObjects:s},meta:r.YR}},error:(e,{error:t})=>Object.assign(Object.assign({},e),{meta:(0,r.UL)(t)})}),(0,i.r)("history",{start:e=>Object.assign(Object.assign({},e),{meta:r.qV}),success(e,{result:t}){if(!t||200!==t.code)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{suggestLastObjects:[]}),meta:r.YR});const s=(0,n.Jk)(t),a=(0,n.NI)(e.data,s);return{data:{searches:a.searches,suggestLastObjects:a.suggestLastObjects},meta:r.YR}},error:(e,{error:t})=>Object.assign(Object.assign({},e),{meta:(0,r.UL)(t)})}))},88757:(e,t,s)=>{s.d(t,{G:()=>r});var a=s(23862);function r(e,t,...s){return(0,a.GW)(e,t,...s)}},10961:(e,t,s)=>{s.d(t,{m:()=>d});var a=s(22970),r=s(88757),n=s(64693);const i=";",c=e=>{if(!e)return{};const t=(0,n.oA)(e.split(i)),s={};for(const e of t)e&&(s[e]=!0);return s};var o=s(29759);const d=(0,r.G)("setFlag",(e=>({cookieApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{name:s,value:a}=e,r=t.getStrict("flags"),d=o.tO.local.getItem("flags"),u=d||r;if(r&&!d&&(o.tO.local.setItem("flags",r),t.delete("dg5_flags")),!s)return c(u);const l=((e,t,s)=>{if(!e)return!1===s?void 0:t;const a=(0,n.oA)(e.split(i));if(!s){const e=a.filter((e=>e!==t));if(!e.length)return;return e.join(i)}return a.includes(t)?a.join(i):[...a,t].join(i)})(u,s,a);return yield o.tO.local.setItem("flags",l),c(l)}))))},24364:(e,t,s)=>{s.d(t,{C:()=>c,O:()=>o});var a=s(22970),r=s(88757),n=s(23862),i=s(99428);const c=(0,r.G)("fetchClusteredMarkers",(e=>({webApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return t.clusteredMarkersQuery(Object.assign(Object.assign({},e),{accessToken:a}))})))),o=(0,n.KX)("fetchClusteredMarkers",{start(e,{params:t}){const{searchId:s}=t,a=e[s];return{[s]:{data:a&&a.data,meta:i.qV}}},success(e,{params:t,result:s}){const a=t.searchId;return e[a]&&s?200!==s.code?{[a]:{data:void 0,meta:(0,i.L3)(s.code)}}:Object.assign(Object.assign({},e),{[a]:{data:s,meta:i.YR}}):e},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{[t.searchId]:{data:void 0,meta:(0,i.UL)(s)}})})},28918:(e,t,s)=>{s.d(t,{U:()=>r});var a=s(88757);const r=(0,a.G)("fetchProductOffersGroupedByOrg",(e=>({marketApi:t})=>t.getOffersGroupedByOrg(e)));(0,a.G)("fetchProjecMarketCategories",(e=>({marketApi:t})=>t.getProjectCategories(e)))},49187:(e,t,s)=>{s.d(t,{H:()=>c,q:()=>o});var a=s(88757),r=s(23862),n=s(35571),i=s(55712);const c=(0,a.G)("fetchProductOffersWithItems",(e=>({marketApi:t,contextApi:s})=>t.getProductOfferWithItems(Object.assign(Object.assign({},e),{locale:s.get("locale")})))),o=(0,r.Rs)("fetchProductOffersWithItems","market",{start(e,{params:t}){const{branchId:s,productIds:a}=t;let r={},c={};return a.forEach((t=>{const a=e.products[t];(null==a?void 0:a.data)||(r=(0,n.Av)(r,t));const o=(0,i.l)(t,s),d=e.offers[o];(null==d?void 0:d.data)||(c=(0,n.Av)(c,o))})),Object.keys(r).length||Object.keys(c).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(r).length&&{products:Object.assign(Object.assign({},e.products),r)}),Object.keys(c).length&&{offers:Object.assign(Object.assign({},e.offers),c)}):e},success(e,{params:t,result:s}){const{branchId:a,productIds:r}=t;let c={},o={};const{items:d,dicts:u}=s;return r.forEach((t=>{var s,r;const l=(0,i.l)(t,a),g=null===(s=e.offers[l])||void 0===s?void 0:s.data,p=null===(r=e.products[t])||void 0===r?void 0:r.data,b=d.find((e=>e.product.id===t));if(!b)return p||(c[t]=void 0),void(g||(o=(0,n.VJ)(o,l,{code:404,name:"NotFound",message:"offer not found"})));const{product:O,offer:f}=b;if(p||(c=(0,n.Cj)(c,t,{product:O,dicts:u})),!g){const e={productId:t,branchId:a,price:f.price,price_value:f.price_value,currency:f.currency,buttons:null==f?void 0:f.buttons,market_item_actions:f.market_item_actions};o=(0,n.Cj)(o,l,e)}})),Object.keys(c).length||Object.keys(o).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(c).length&&{products:Object.assign(Object.assign({},e.products),c)}),Object.keys(o).length&&{offers:Object.assign(Object.assign({},e.offers),o)}):e},error(e,{params:t,error:s}){const{branchId:a,productIds:r}=t;let c={},o={};return r.forEach((t=>{const r=e.products[t];(null==r?void 0:r.data)||(c=(0,n.VJ)(c,t,s));const d=(0,i.l)(t,a),u=e.offers[d];(null==u?void 0:u.data)||(o=(0,n.VJ)(o,d,s))})),Object.keys(c).length||Object.keys(o).length?Object.assign(Object.assign(Object.assign({},e),Object.keys(c).length&&{products:Object.assign(Object.assign({},e.products),c)}),Object.keys(o).length&&{offers:Object.assign(Object.assign({},e.offers),o)}):e}})},3856:(e,t,s)=>{s.d(t,{l:()=>c,s:()=>i});var a=s(22970),r=s(88757),n=s(84046);const i=(0,r.G)("cancelOrder",(e=>({paymentsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{orderId:a}=e,n=yield s.getToken();if(!n)throw new Error("There is no access_token");return yield t.cancelOrder({locale:r.get("locale"),orderId:a,accessToken:n})})))),c=(0,n.R)("cancelOrder","ordersHistory",{success(e,{params:t}){var s;if(!e.default)return e;const a=((null===(s=e.default.data)||void 0===s?void 0:s.orders)||[]).map((e=>e.id===t.orderId?Object.assign(Object.assign({},e),{status:Object.assign(Object.assign({},e.status),{type:"canceled",flags:{canBeCanceled:!1}})}):e));return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},e.default),{data:{total:a.length,orders:a}})})}})},3108:(e,t,s)=>{s.d(t,{D:()=>o,b:()=>c});var a=s(22970),r=s(35571),n=s(88757),i=s(23862);const c=(0,n.G)("checkoutDelivery",(e=>({paymentsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("There is no access_token");return yield t.checkoutDelivery(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")}))})))),o=(0,i.Rs)("checkoutDelivery","deliveryOrder",{start:(e,{params:t})=>(0,r.Av)(e,t.idempotencyKey),success:(e,{params:t,result:s})=>(0,r.Cj)(e,t.idempotencyKey,s.result),error:(e,{params:t,error:s})=>(0,r.VJ)(e,t.idempotencyKey,s)})},59957:(e,t,s)=>{s.d(t,{F:()=>d,O:()=>u});var a=s(22970),r=s(88757),n=s(23862),i=s(10451),c=s(19043),o=s(89475);const d=(0,r.G)("fetchDeliveryCalculation",(e=>({paymentsApi:t,contextApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){return yield t.getDeliveryCalculation(Object.assign(Object.assign({},e),{locale:s.get("locale")}))})))),u=(0,n.Rs)("fetchDeliveryCalculation","cart",{start:(e,{params:t})=>l(e,t,{meta:o.qV}),success:(e,{params:t,result:s})=>l(e,t,{data:s,meta:o.YR}),error:(e,{params:t,error:s})=>l(e,t,{meta:(0,o.UL)(s)})}),l=(e,t,s)=>{const a=e[i.M];return(null==a?void 0:a.data)?Object.assign(Object.assign({},e),{[i.M]:Object.assign(Object.assign({},a),{data:(0,c.F)(a.data,t.orgId,(e=>Object.assign(Object.assign({},e),{deliveryTimestamp:+new Date,deliveryBuildingId:t.delivery.address.buildingId,delivery:s})))})}):e}},8875:(e,t,s)=>{s.d(t,{$:()=>d,D:()=>c});var a=s(22970),r=s(88757),n=s(23862),i=s(35571);const c=(0,r.G)("fetchOrdersHistory",(()=>({paymentsApi:e,credentialsApi:t,contextApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("There is no access_token");return yield e.getOrders({accessToken:a,locale:s.get("locale")})})))),o="default",d=(0,n.Rs)("fetchOrdersHistory","ordersHistory",{start:e=>(0,i.Av)(e,o),success:(e,{result:t})=>(0,i.Cj)(e,o,t),error:(e,{error:t})=>(0,i.VJ)(e,o,t)})},90152:(e,t,s)=>{s.d(t,{e:()=>o,o:()=>c});var a=s(22970),r=s(88757),n=s(23862),i=s(89475);const c=(0,r.G)("fetchOrdersShort",(()=>({paymentsApi:e,credentialsApi:t,contextApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("There is no access_token");return yield e.getOrdersShort({accessToken:a,locale:s.get("locale"),type:"active"})})))),o=(0,n.Rs)("fetchOrdersShort","user",{start:e=>Object.assign(Object.assign({},e),{shortOrders:Object.assign(Object.assign({},e.shortOrders),{meta:i.qV})}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{shortOrders:{data:t.orders,meta:i.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{shortOrders:Object.assign(Object.assign({},e.shortOrders),{meta:(0,i.UL)(t)})})})},4313:(e,t,s)=>{s.d(t,{B:()=>c,R:()=>o});var a=s(22970),r=s(88757),n=s(23862),i=s(35571);const c=(0,r.G)("checkoutOrder",(e=>({paymentsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();return yield t.checkoutOrder(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")}))})))),o=(0,n.Rs)("checkoutOrder","order",{start:(e,{params:t})=>(0,i.Av)(e,t.idempotencyKey),success:(e,{params:t,result:s})=>(0,i.Cj)(e,t.idempotencyKey,s.items[0]),error:(e,{params:t,error:s})=>(0,i.VJ)(e,t.idempotencyKey,s)})},84879:(e,t,s)=>{s.d(t,{z:()=>i});var a=s(97698),r=s(73791),n=s(38537);const i=(0,a.P1)([e=>e.data.user.shortOrders.data,(e,t)=>t.orgId],((e,t)=>(0,r.o)({orders:e||[],filterByStatus:n.Wz}).filter((e=>e.firm.orgId===t))))},73791:(e,t,s)=>{function a(e){const{orders:t,filterByStatus:s=[]}=e;return t.length?s.length?t.filter((e=>s.includes(e.status.type))):t:[]}s.d(t,{o:()=>a})},2604:(e,t,s)=>{s.d(t,{F:()=>c,h:()=>o});var a=s(22970),r=s(94142),n=s(88757),i=s(99428);const c="confirm_phone",o=(0,n.G)("confirmPhone",(e=>({credentialsApi:t,authApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("User is not authorized");return s.confirmPhone(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")}))}))),(0,r.r)("user",{start:e=>Object.assign(Object.assign({},e),{phone:{[c]:i.qV}}),success:e=>Object.assign(Object.assign({},e),{phone:{[c]:i.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{phone:{[c]:(0,i.UL)(t)}})}))},6786:(e,t,s)=>{s.d(t,{$:()=>r.$,h:()=>a.h});var a=s(2604),r=s(37147)},37147:(e,t,s)=>{s.d(t,{$:()=>o,F:()=>c});var a=s(22970),r=s(94142),n=s(88757),i=s(89475);const c="request_code",o=(0,n.G)("requestConfirmationCode",(e=>({credentialsApi:t,authApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield t.getToken();if(!a)throw new Error("User is not authorized");return s.getPhoneConfirmationCode(Object.assign(Object.assign({},e),{segmentId:e.segmentId||"65573",action:"phone_update",accessToken:a,locale:r.get("locale")}))}))),(0,r.r)("user",{start:e=>Object.assign(Object.assign({},e),{phone:{[c]:i.qV}}),success:e=>Object.assign(Object.assign({},e),{phone:{[c]:i.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{phone:{[c]:(0,i.UL)(t)}})}))},83709:(e,t,s)=>{s.d(t,{z:()=>i});var a=s(22970),r=s(94142),n=s(99428);const i=(0,s(88757).G)("ENTITY/DELETE_PHOTO",(e=>({photoApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{entityId:a,entityType:r,photoId:n}=e,i=yield s.getToken();if(!i)throw new Error("User is not authorized");return t.deletePhoto({objectId:a,objectType:r,photoId:n,accessToken:i})}))),(0,r.r)("photo",{start(e,{params:t}){if(!e[t.photoId])return e;const s=e[t.photoId];if(!s)return e;const a={data:s.data,meta:Object.assign(Object.assign({},s.meta),{crud:"deleting"})};return Object.assign(Object.assign({},e),{[t.photoId]:a})},success(e,{params:t}){if(!e[t.photoId])return e;const s={};for(const a in e)a!==t.photoId&&(s[a]=e[a]);return s},error(e,{params:t}){if(!e[t.photoId])return e;const s=e[t.photoId];if(!s)return e;const a={data:s.data,meta:n.YR};return Object.assign(Object.assign({},e),{[t.photoId]:a})}}),(0,r.r)("entity",{success(e,{params:t,result:s}){if(200!==s.items[0].code)return e;const a=e.photos[t.entityId];if(!a||!a.data)return e;const r=a.data.items;return r.length?Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.entityId]:{meta:a.meta,data:Object.assign(Object.assign({},a.data),{total:a.data.total-1,items:r.filter((e=>e!==t.photoId))})}})}):e}}),(0,r.r)("entity",{success(e,{params:t,result:s}){if(200!==s.items[0].code||!t.userId)return e;const a=e.photos[t.userId];if(!a||!a.data)return e;const r=a.data.items;return r.length?Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.userId]:{meta:a.meta,data:Object.assign(Object.assign({},a.data),{total:a.data.total-1,items:r.filter((e=>e!==t.photoId))})}})}):e}}))},84832:(e,t,s)=>{s.d(t,{k:()=>d});var a=s(22970),r=s(94142),n=s(99428),i=s(88757),c=s(35571);const o={start:(e,{params:t})=>Object.assign(Object.assign({},e),{photos:(0,c.Av)(e.photos,t.id)}),success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{photos:(0,c.Cj)(e.photos,t.id,{items:s.items.map((e=>e.id)),pagesLoaded:t.page||1,total:s.total})}),error(e,{params:t,error:s}){var a;return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[t.id]:{data:null===(a=e.photos[t.id])||void 0===a?void 0:a.data,meta:(0,n.UL)(s)}})})}},d=(0,i.G)("ENTITY/FETCH_PHOTOS",(e=>({photoApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{id:a,type:n,page:i,pageSize:c}=e,o=yield s.getToken(),d=r.get("locale")||"ru",u="branch"===n?"branch":"geo";return yield t.getPhotos({objectId:a,objectType:u,page:i,locale:d,pageSize:c,accessToken:o})}))),(0,r.r)("entity",o),(0,r.r)("photo",{success(e,{params:t,result:s}){if(!s.items.length)return e;const a=s.items.reduce(((s,a)=>{var r;const n=null===(r=e[a.id])||void 0===r?void 0:r.data,i=a.views_count||n&&"views_count"in n&&n.views_count||void 0,o=!a.is_visible&&n&&"status"in n&&n.status?n.status:a.status;return(0,c.Cj)(s,a.id,Object.assign(Object.assign({},a),{views_count:i,status:o,object:{id:t.id,type:t.type}}))}),{});return Object.assign(Object.assign({},e),a)}}))},64389:(e,t,s)=>{s.d(t,{y:()=>i});var a=s(22970),r=s(94142),n=s(99428);const i=(0,s(88757).G)("fetchUserPhotos",(e=>({photoApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("No access token");return t.getUserPhotos(Object.assign(Object.assign({},e),{accessToken:a}))}))),(0,r.r)("photo",{success(e,{params:t,result:s}){if(!s.items.length)return e;const a=s.items.reduce(((e,s)=>{const a=Object.assign(Object.assign({},s),{owner:{id:t.userId}});return e[s.id]={data:Object.assign(Object.assign({},a),{object:a.object?{id:a.object.id_str,type:a.object.type}:void 0}),meta:n.YR},e}),{});return Object.assign(Object.assign({},e),a)}}),(0,r.r)("user",{success(e,{params:t,result:s}){const a=t.userId,r=e.photos[a],i=s.items.reduce(((e,t)=>(e.includes(t.id)||e.push(t.id),e)),[]),c=(null==r?void 0:r.data)?r.data.items:[],o=i.filter((e=>-1===c.indexOf(e))),d=1===t.page?[...o,...c]:[...c,...o];return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[a]:{data:{items:d,total:s.total,pagesLoaded:t.page},meta:n.YR}})})},error(e,{params:t,error:s}){const a=t.userId,r=e.photos[a];return Object.assign(Object.assign({},e),{photos:Object.assign(Object.assign({},e.photos),{[a]:{data:r&&r.data,meta:(0,n.UL)(s)}})})}}))},30402:(e,t,s)=>{s.d(t,{t:()=>d});var a=s(22970),r=s(94142),n=s(53222),i=s(99428),c=s(88757),o=s(35571);const d=(0,c.G)("ENTITY/UPLOAD_PHOTO",(e=>({photoApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{objectId:a,objectType:r,temporaryId:n,file:i,locale:c,regionId:o,albumCode:d,isReplaced:u,isMenuPhoto:l}=e,g=yield s.getToken();if(!g)throw new Error("User is not authorized");const p=(yield t.addPhoto({uid:n,objectId:a,objectType:r,albumCode:d,locale:c,regionId:o,accessToken:g,isReplaced:u,isMenuPhoto:l})).items[0];if(!p.hash||!p.id||p.error)throw{name:p.error&&p.error.type,message:p.error&&p.error.message};return t.uploadPhoto({id:p.id,hash:p.hash,file:i,accessToken:g,objectType:r})}))),(0,r.r)("photo",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.temporaryId]:{data:{uid:t.temporaryId,file:t.file,temporary:!0},meta:i.qV}}),success(e,{params:t,result:s}){const a=s.items[0];if(200!==a.code){const s=a.error;return Object.assign(Object.assign({},e),{[t.temporaryId]:Object.assign(Object.assign({},e[t.temporaryId]),{meta:(0,i.UL)({name:s.type,message:s.message})})})}return Object.assign(Object.assign({},e),{[t.temporaryId]:{data:Object.assign(Object.assign({},a),{tempId:t.temporaryId}),meta:i.YR},[a.id]:{data:Object.assign(Object.assign({},a),{object:{id:t.objectId,type:t.objectType}}),meta:i.YR}})},error:(e,{params:t,error:s})=>(0,o.VJ)(e,t.temporaryId,s)}),(0,r.r)("entity",{success(e,{params:t,result:s}){const a=s.items[0];if(200!==a.code||"profile"===t.objectType)return e;const r=e.photos[t.objectId];if(!r||!r.data)return Object.assign(Object.assign({},e),{photos:(0,o.Cj)(e.photos,t.objectId,{items:[a.id],total:1,pagesLoaded:0})});const n=r.data.items;return Object.assign(Object.assign({},e),{photos:(0,o.Cj)(e.photos,t.objectId,Object.assign(Object.assign({},r.data),{total:r.data.total+1,items:[a.id,...n]}))})}}),(0,r.r)("photo",{success(e,{params:t,result:s}){const a=s.items[0];if(200!==a.code||"profile"===t.objectType)return e;const r=(0,n.R)(a,{objectType:t.objectType,user:t.user});return t.onSubmitSuccessCallback&&r&&t.onSubmitSuccessCallback({photo:r}),e}}))},53800:(e,t,s)=>{s.d(t,{L:()=>n,h:()=>i});var a=s(22970),r=s(88757);const n=(0,r.G)("fetchDevices",(()=>({pusherApi:e,credentialsApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(!s)throw new Error("There is no access_token");return e.fetchDevices({authToken:s})})))),i=(0,r.G)("pushNotification",(e=>({pusherApi:t,credentialsApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken(),{deviceId:r,title:n,body:i,url:c}=e;if(!a)throw new Error("There is no access_token");const o={authToken:a,deviceId:r,title:n,body:i,url:c};return t.messageMe(o)}))))},40298:(e,t,s)=>{s.d(t,{F:()=>o});var a=s(94142),r=s(88757),n=s(1184),i=s(35571);const c={supermarket:["12127","101979","611","350","373","544","558","363"],education:["683","21044","15287","684","21040","245","15761","687"],kindergarten:["237","110405"],hospital:["201","224","225","203","229","25075","4521","23765","18410","56893","661","12211","4517","16863","226","222","20857","4537","4529","16870"],pharmacy:["207"],sport:["261","267","268","51256","110498"],culture:["193","189","199","200","190","11647","13787","168","51001","10887","51207"],bar:["159"]},o=(0,r.G)("fetchInfrastructure",(e=>({webApi:t,contextApi:s})=>{const{center:a}=e,r=[...c.supermarket,...c.education,...c.kindergarten,...c.hospital,...c.pharmacy,...c.sport,...c.culture,...c.bar];return t.getInfrastructure({center:a,locale:s.get("locale")||"ru_RU",radius:750,rubrIds:r,screen})}),(0,a.r)("realty",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{infrastructure:(0,i.Av)(e.infrastructure,t.buildingId)}),success(e,{params:t,result:s}){const a=("items"in s&&s.items||[]).reduce(((e,t)=>{const s=(0,n.uc)(c).find((e=>!!t.rubr&&c[e].includes(t.rubr)));return s&&e[s].push(t),e}),{supermarket:[],education:[],kindergarten:[],hospital:[],pharmacy:[],sport:[],culture:[],bar:[]});return Object.assign(Object.assign({},e),{infrastructure:(0,i.Cj)(e.infrastructure,t.buildingId,a)})},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{infrastructure:(0,i.VJ)(e.infrastructure,t.buildingId,s)})}))},44555:(e,t,s)=>{s.d(t,{q:()=>o});var a=s(88757),r=s(94142),n=s(35571),i=s(99428);function c(e){const t=Object.assign({},e);return t.on_map&&delete t.on_map,t}const o=(0,a.G)("fetchRealtyMarkers",(e=>({marketApi:t,contextApi:s})=>{const{categoryId:a,viewpoint:r,filters:n,entityId:i}=e;return t.getRealtyMarkers({category_ids:a,viewpoint:r,locale:s.get("locale")||"ru_RU",filters:c(n),geo_id:i})}),(0,r.r)("realty",{start:(e,{uuid:t})=>Object.assign(Object.assign({},e),{markers:(0,n.Av)(e.markers,"default",t),hashmap:(0,n.Av)(e.hashmap,"default",t)}),success(e,{result:t,uuid:s}){if(!t)return e;if(200!==t.code)return 404===t.code?Object.assign(Object.assign({},e),{markers:(0,n.Cj)(e.markers,"default",[],s),hashmap:(0,n.Cj)(e.hashmap,"default",{},s)}):Object.assign(Object.assign({},e),{markers:(0,n.VJ)(e.markers,"default",new Error(`Api have responded with ${t.code}`),s),hashmap:(0,n.VJ)(e.hashmap,"default",new Error(`Api have responded with ${t.code}`),s)});const a=t.items.reduce(((e,t,s)=>(e[t.building_id]=s,e)),{});return Object.assign(Object.assign({},e),{markers:(0,n.Cj)(e.markers,"default",t.items,s),hashmap:(0,n.Cj)(e.hashmap,"default",a,s)})},error(e,{error:t,uuid:s}){const a={default:{data:[],meta:(0,i.UL)(t)}},r={default:{data:{},meta:(0,i.UL)(t)}};return Object.assign(Object.assign({},e),{markers:(0,n.VJ)(a,"default",t,s),hashmap:(0,n.VJ)(r,"default",t,s)})}}))},94574:(e,t,s)=>{s.d(t,{F:()=>i});var a=s(88757),r=s(94142),n=s(35571);const i=(0,a.G)("fetchWalkDistance",(e=>({diskApi:t})=>t.getWalkDistanceData({regionId:e.regionId})),(0,r.r)("walkDistance",{start:(e,{params:t})=>(0,n.Av)(e,t.regionId),success:(e,{result:t,params:s})=>(0,n.Cj)(e,s.regionId,t.features),error:(e,{params:t,error:s})=>(0,n.VJ)(e,t.regionId,s)}))},3767:(e,t,s)=>{s.d(t,{VM:()=>c,fT:()=>n,g7:()=>i});var a=s(22970),r=s(88757);const n=(0,r.G)("fetchReviewComments",(e=>({reviewsApi:t,contextApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){return t.getReviewComments(Object.assign(Object.assign({},e),{locale:s.get("locale")||""}))})))),i=(0,r.G)("sendReviewCommentAnswer",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("No access token");return t.sendReviewCommentAnswer(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")||""}))})))),c=(0,r.G)("removeReviewComment",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("No access token");return t.deleteComment(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")||""}))}))))},87203:(e,t,s)=>{s.d(t,{J:()=>a});const a=(0,s(88757).G)("fetchReviewsFacts",(e=>({reviewsApi:t,contextApi:s})=>t.getFacts(Object.assign(Object.assign({},e),{locale:s.get("locale")||""}))))},54488:(e,t,s)=>{s.d(t,{X:()=>c});var a=s(22970),r=s(89475),n=s(94361),i=s(94142);const c=(0,s(88757).G)("CreateReview",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{entityId:a,entityType:i,rating:c,text:o,reviewSourceId:d,photos:u,skipValidation:l}=e,g=yield s.getToken();if(!g)throw new Error("There is no access_token");if(o.length>0&&!l){const{bad_words_warning:e}=yield t.validateReview({text:o,locale:r.get("locale")||""});if(e)throw(0,n.fe)("Отзыв содержит оскорбления или слова, употребление которых может грозить автору ответственностью",e)}return t.createReview({id:a,type:"branch"===i?"branch":"geo",rating:c,text:o,accessToken:g,sourceId:d,photos:u,locale:r.get("locale")||""})}))),(0,i.r)("review",{start(e,{params:t}){const{temporaryId:s,rating:a,text:n}=t,i={data:{id:s,text:n,rating:a,temporary:!0},meta:r.qV};return Object.assign(Object.assign({},e),{[s]:i})},success(e,{params:t,result:s}){const{temporaryId:a}=t,n=s.items[0];return n?Object.assign(Object.assign({},e),{[a]:{data:n,meta:r.YR},[n.id]:{data:n,meta:r.YR}}):e},error(e,{params:t,error:s}){const{temporaryId:a}=t,n=e[a];return n&&n.data?Object.assign(Object.assign({},e),{[a]:{data:n.data,meta:(0,r.UL)(s)}}):e}}),(0,i.r)("reviewSearch",{success(e,{params:t,result:s}){const{reviewSearchId:a}=t;if(!a)return e;const r=a,n=e[a],i=s.items[0]&&s.items[0].id;if(!n)return e;const c=n.data;if(!c)return e;const o=n.data&&n.data.items||[];return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},n),{data:Object.assign(Object.assign({},c),{items:[i].concat(o),total:c.total+1})})})}}))},62808:(e,t,s)=>{s.d(t,{k:()=>c});var a=s(22970),r=s(94361),n=s(35571),i=s(94142);const c=(0,s(88757).G)("EditReview",(e=>({reviewsApi:t,credentialsApi:s,contextApi:n})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{text:a,skipValidation:i}=e,c=yield s.getToken();if(!c)throw new Error("There is no access_token");if(a.length>0&&!i){const{bad_words_warning:e}=yield t.validateReview({text:a,locale:n.get("locale")||""});if(e)throw(0,r.fe)("Отзыв содержит оскорбления или слова, употребление которых может грозить автору ответственностью",e)}return t.editReview(Object.assign(Object.assign({},e),{accessToken:c,locale:n.get("locale")||""}))}))),(0,i.r)("review",{start:(e,{params:t})=>(0,n.Av)(e,t.id),success(e,{result:t,params:s}){var a;const r=t.items[0],i=(null===(a=e[s.id])||void 0===a?void 0:a.data)||r;return(0,n.Cj)(e,s.id,Object.assign(Object.assign({},r),{object:i.object}))},error:(e,{error:t,params:s})=>(0,n.VJ)(e,s.id,t)}))},91690:(e,t,s)=>{s.d(t,{T:()=>r});var a=s(22970);const r=(0,s(88757).G)("setReviewLike",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const{id:a,value:n}=e,i=yield s.getToken();if(!i)throw new Error("There is no access_token");return!0===n?t.likeReview({id:a,accessToken:i,locale:r.get("locale")||""}):t.unlikeReview({id:a,accessToken:i,locale:r.get("locale")||""})}))))},76409:(e,t,s)=>{s.d(t,{A:()=>o});var a=s(88757),r=s(94142),n=s(91611),i=s(35571);const c={items:[(0,n.N)("Поесть","eat","110539"),(0,n.N)("АЗС","gasoline_station","18547"),(0,n.N)("Аптеки","pharmacies","207"),(0,n.N)("Гостиницы","hotels","269")],code:200},o=(0,a.G)("fetchDashboard",(e=>({webApi:t})=>"0"===e.regionId?Promise.resolve(c):t.getDashboard(e)),(0,r.r)("rubric",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{dashboard:(0,i.Av)(e.dashboard,t.dashboardId)}),success:(e,{params:t,result:s})=>200===s.code&&s.items&&s.items.length?Object.assign(Object.assign({},e),{dashboard:(0,i.Cj)(e.dashboard,t.dashboardId,s.items.filter((e=>e.icon_url&&"112786"!==e.id)))}):e,error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{dashboard:(0,i.VJ)(e.dashboard,t.dashboardId,s)})}))},68149:(e,t,s)=>{s.d(t,{b:()=>i});var a=s(88757),r=s(94142);const n=e=>"pseudorubric"===e.type?e.id||e.owner_id:e.id,i=(0,a.G)("fetchRubric",(e=>({webApi:t})=>t.getRubric(e)),(0,r.r)("rubricator",{success(e,{result:t}){if(!t||!t.items)return e;const s=t.items.reduce(((e,t)=>Object.assign(Object.assign({},e),{[n(t)]:t})),{});return Object.assign(Object.assign({},e),{items:Object.assign(Object.assign({},e.items),s)})}}))},78930:(e,t,s)=>{s.d(t,{F:()=>o});var a=s(88757),r=s(94142),n=s(99428),i=s(35571);const c=e=>"pseudorubric"===e.type?e.id||e.owner_id:e.id,o=(0,a.G)("fetchRubricator",(e=>({webApi:t})=>t.getRubricatorList(e)),(0,r.r)("rubricator",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{lists:(0,i.Av)(e.lists,t.key)}),success(e,{params:t,result:s}){if(!s||!s.items)return Object.assign(Object.assign({},e),{lists:Object.assign(Object.assign({},e.lists),{[t.key]:{meta:(0,n.Mq)()}})});const a=s.items.map(c),r=s.items.reduce(((e,t)=>Object.assign(Object.assign({},e),{[c(t)]:t})),{});return Object.assign(Object.assign({},e),{lists:(0,i.Cj)(e.lists,t.key,a),items:Object.assign(Object.assign({},e.items),r)})},error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{lists:(0,i.VJ)(e.lists,t.key,s)})}))},89211:(e,t,s)=>{s.d(t,{of:()=>i,r1:()=>c,ui:()=>n});var a=s(64693),r=s(97698);const n=()=>(0,r.P1)([({key:e})=>e,({state:e})=>e.data.rubricator.lists,({state:e})=>e.data.rubricator.items],((e,t,s)=>{const r=t[e];if(r&&r.data)return(0,a.oA)(r.data.map((e=>s[e])))})),i=e=>t=>t.data.rubricator.items[e],c=e=>t=>t.data.rubricator.lists[e]},57523:(e,t,s)=>{s.d(t,{J:()=>r});var a=s(64693);const r=(e,t,s)=>(0,a.oA)([e,s,t]).join("_")},12177:(e,t,s)=>{s.d(t,{D:()=>n});var a=s(94142),r=s(89475);const n=(0,s(88757).G)("createShortLink",(e=>({shortonizerApi:t})=>t.createShortLink(e.url)),(0,a.r)("shortonizer",{start(e,{params:t}){const s={data:void 0,meta:r.qV};return Object.assign(Object.assign({},e),{[t.url]:s})},success(e,{params:t,result:s}){const a={data:s,meta:r.YR};return Object.assign(Object.assign({},e),{[t.url]:a})},error(e,{params:t}){const s=t.url,a=Object.assign({},e);return delete a[s],a}}))},54223:(e,t,s)=>{s.d(t,{S:()=>a});const a=(0,s(88757).G)("fetchTrafficScore",(e=>({trafficApi:t})=>t.trafficScore(e)))},16838:(e,t,s)=>{s.d(t,{s:()=>a});const a=e=>t=>t.data.traffic[e]},45051:(e,t,s)=>{s.d(t,{j:()=>o,m:()=>c});var a=s(22970),r=s(88757),n=s(23862),i=s(89475);const c=(0,r.G)("actualizeUserInfo",(()=>({authApi:e,credentialsApi:t})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const s=yield t.getToken();if(s)return e.getUserInfo({accessToken:s});throw new Error("There is no access token")})))),o=(0,n.KX)("actualizeUserInfo",{success:(e,{result:t})=>({default:{data:Object.assign(Object.assign({},t.data),{access_token:t.access_token}),meta:i.YR}}),error:(e,{error:t})=>({default:{data:void 0,meta:(0,i.UL)(t)}})})},47487:(e,t,s)=>{s.d(t,{K:()=>d});var a=s(22970),r=s(69363),n=s(88757),i=s(29759),c=s(10451),o=s(62012);const d=(0,n.G)("clearPersonalData",(e=>({favoritesStorage:t,profileApi:s})=>(0,a.mG)(void 0,void 0,void 0,(function*(){yield Promise.all([t.clearPersonal(),t.clearPlaces(),i.tO.local.removeItem(c.d),e.doNotClearHistoryInProfileApi?void 0:s.clearSearchHistory(),r.r.removeStore("history","history"),(0,o.E)()])}))))},34702:(e,t,s)=>{s.d(t,{a:()=>n});var a=s(22970),r=s(94142);const n=(0,s(88757).G)("deleteUserProfile",(e=>({authApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken(),n=yield r.get("locale");if(!a)throw new Error("No access token");return t.deleteProfile(Object.assign(Object.assign({},e),{locale:n,accessToken:a}))}))),(0,r.r)("user",{success:e=>Object.assign(Object.assign({},e),{info:{default:void 0}})}),(0,r.r)("photo",{success:(e,{params:t})=>Object.assign(Object.assign({},e),{[t.userId]:void 0})}))},44514:(e,t,s)=>{s.d(t,{r:()=>o,y:()=>u});var a=s(22970),r=s(88757),n=s(23862),i=s(35571),c=s(99428);const o=(0,r.G)("fetchUserReviewsByObject",(e=>({reviewsApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){const a=yield s.getToken();if(!a)throw new Error("There is no access token in fetchUserReviewsByObject");return t.getUserReviewsByObject(Object.assign(Object.assign({},e),{accessToken:a,locale:r.get("locale")||""}))})))),d=(0,n.Rs)("fetchUserReviewsByObject","review",{success(e,{result:t}){if(!t.items.length)return e;const s=t.items.reduce(((e,t)=>(e[t.id]={data:t,meta:c.YR},e)),{});return Object.assign(Object.assign({},e),s)}}),u=[(0,n.Rs)("fetchUserReviewsByObject","user",{start:(e,{params:{entityId:t}})=>Object.assign(Object.assign({},e),{pinnedReviews:(0,i.Av)(e.pinnedReviews,t)}),error:(e,{params:{entityId:t},error:s})=>Object.assign(Object.assign({},e),{pinnedReviews:(0,i.VJ)(e.pinnedReviews,t,s)}),success(e,{params:{entityId:t},result:s}){var a;const r=(null===(a=s.items[0])||void 0===a?void 0:a.id)?[s.items[0].id]:[],n=s.total?c.YR:(0,c.Mq)();return Object.assign(Object.assign({},e),{pinnedReviews:Object.assign(Object.assign({},e.pinnedReviews),{[t]:{data:{items:r,total:s.total},meta:n}})})}}),d]},76691:(e,t,s)=>{s.d(t,{g:()=>o});var a=s(22970),r=s(88757),n=s(94142),i=s(99428);const c="default",o=(0,r.G)("updateUserInfo",(e=>({authApi:t,credentialsApi:s,contextApi:r})=>(0,a.mG)(void 0,void 0,void 0,(function*(){var a,n;const i=yield s.getToken();if(i)return t.updateUserInfo(Object.assign(Object.assign({accessToken:i,locale:r.get("locale")},e),{userInfo:Object.assign(Object.assign({},e.userInfo),{public_identity_accepted:null===(n=null===(a=e.userInfo)||void 0===a?void 0:a.public_identity_accepted)||void 0===n?void 0:n.toString()})}));throw new Error("There is no access token")}))),(0,n.r)("user",{success:(e,{result:t})=>Object.assign(Object.assign({},e),{info:{[c]:{data:t,meta:i.YR}}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{info:{[c]:{data:void 0,meta:(0,i.UL)(t)}}})}))},43366:(e,t,s)=>{var a;s.d(t,{X:()=>a}),function(e){e.jpeg="jpeg",e.jpg="jpg",e.png="png",e.bmp="bmp",e.webp="webp",e.gif="gif"}(a||(a={}))},43464:(e,t,s)=>{s.d(t,{gm:()=>d});var a=s(22970),r=s(52322),n=s(2784),i=s(5975),c=s(343);const o=n.createContext({});function d(){const e=o;return{withFormatter:(t=e,function(e,s=g){return function(n){return i=>{const{render:c}=i,o=(0,a._T)(i,["render"]),[d,u]=l(e,o,t);if(void 0===u&&void 0===d)return null;const g=u?s(u):(0,r.jsx)(n,Object.assign({},o,d));return c?c(g):g}}}),FormatterProvider:e.Provider,useFormatter:u(e),FormatterContextConsumer:e.Consumer};var t}function u(e){return function(t,s){const a=l(t,s,e);if(a[1]){0,b(a[1])}return a[0]}}function l(e,t,s){const a=n.useContext(s);return(0,c.$)((()=>{try{return[e(t,a),void 0]}catch(e){return e instanceof p?[void 0,e.self]:[void 0,{status:"error",error:e instanceof Error?e:new Error(`Unknown formatter error ${(0,i.e)(e)}`)}]}}),[t])}const g=e=>{b(e)};new Error("Formatter failed");class p{constructor(e){this.self=e}}function b(e){if("loading"===e.status)throw new Error("Unexpected loading placeholder");throw e.error}},77878:(e,t,s)=>{s.d(t,{H:()=>o,UB:()=>d});var a=s(64693),r=s(34436);function n(e){const{message:t,level:s,id:a,payload:r,ip:n,sessionId:i,userId:c,userAgent:o,requestId:d,namespace:u,url:l,noCropValues:g}=e;return Object.assign({message:t,level:s,log_id:a,remote_addr:n,user_id:c,session_id:i,request_id:d,http_user_agent:o,request_uri:l,noCropValues:g},function(e,t){const s=Object.keys(e),a={};for(const r of s)a[`${t}.${r}`]=e[r];return a}(r,u))}function i(e){const t=n(e),s=(0,a.CE)(t,["user_id","remote_addr","http_user_agent","session_id"]);(0,r.D)(Object.assign(Object.assign({},s),{environment:"client"}))}function c(e){const t=n(e);(0,r.q)(Object.assign(Object.assign({},t),{environment:"server"}))}function o(e){return"undefined"==typeof window?c(Object.assign(Object.assign({},e),{namespace:"error"})):i(Object.assign(Object.assign({},e),{namespace:"error"}))}function d(e){return"undefined"==typeof window?c(Object.assign(Object.assign({},e),{namespace:"perf"})):i(Object.assign(Object.assign({},e),{namespace:"perf"}))}},89475:(e,t,s)=>{s.d(t,{UL:()=>a.UL,YR:()=>a.YR,qV:()=>a.qV});var a=s(99428)},84635:(e,t,s)=>{s.d(t,{sk:()=>a});s(874),s(64693),s(49117);function a(e){if(e&&4===e.length)return e.map((e=>({lat:e.latitude,lon:e.longitude})))}},49117:(e,t,s)=>{s.d(t,{t:()=>a});s(77878);function a({hash:e,entityId:t}){return[e,t].join("_")}},21969:(e,t,s)=>{function a(){return{emitEvent:e=>({type:"EVENT/EMIT",payload:e,event:!0}),addEventListener:e=>({type:"EVENT/ADD_LISTENER",payload:e,event:!0}),removeEventListener:e=>({type:"EVENT/REMOVE_LISTENER",payload:e,event:!0})}}s.d(t,{U:()=>a})},56521:(e,t,s)=>{function a(e,t,s){const a=function(e,t){for(let s=0;s<e.length;s++)if(t>=(e[s].priority||-1/0))return s;return e.length}(e,t.priority||s);return[...e.slice(0,a),t,...e.slice(a)]}s.d(t,{k:()=>n,n:()=>i});var r=s(67753);const n=0;function i(){let e=[];return t=>s=>i=>{if(i){if(!i.event)return s(i);if("EVENT/EMIT"===i.type){const s=[];for(const a of e){if(a.type!==i.payload.type)continue;const e=a.handler(i.payload.event,t.getState());if(e&&(s.push(e),a.stopIfHandled))break}return t.dispatch((0,r.Mf)(...s))}"EVENT/ADD_LISTENER"!==i.type?"EVENT/REMOVE_LISTENER"===i.type&&(e=e.filter((e=>e.id!==i.payload.id))):e=a(e,i.payload,n)}}}},84604:(e,t,s)=>{s.d(t,{d:()=>i});var a=s(64693);let r="",n=!1;const i=(e,t)=>({windowApi:s,analyticsApi:i})=>c=>{const o=e(c.getState());s.historyReplace(o.historyState,o.url||"");let d=c.getState();const u=(0,a.Ds)((t=>{var a;const{historyState:c,url:o}=e(t,d);if(o&&(s.historyReplace(c,o),n)){const e=null===(a=s.location)||void 0===a?void 0:a.pathname;e&&r!==e&&(i.trackPageview(),r=e)}d=t}),333);return e=>a=>{var i;return"turnAutoPageViewOn"===a.type?(n=t.analyticsAutoTrackPageview,void(r=(null===(i=s.location)||void 0===i?void 0:i.pathname)||"")):"object"!=typeof a?e(a):(e(a),void u(c.getState()))}}},85884:(e,t,s)=>{s.d(t,{Eb:()=>i,eg:()=>n,z2:()=>r});var a=s(64693);function r(e,t){return e&&e.data?{data:Object.assign(Object.assign({},e.data),t.data),meta:t.meta}:t}function n(e,t){return e?Object.assign(Object.assign({},e),t):t}function i(e){return"branch"!==e.type?e:(0,a.CE)(e,["ads","context","hash","stat"])}},82358:(e,t,s)=>{s.d(t,{Jk:()=>u,NI:()=>b,ZP:()=>d,vT:()=>n});var a=s(22970),r=s(27672);const n=20,i=100,c=["branch","building","station","adm_div","attraction"],o={data:{searches:[],suggestLastObjects:[]}};function d(e=o,t){switch(t.type){case"USER/LOAD_HISTORY_SUCCESS":return function({payload:e}){return{data:e}}(t);case"USER/ADD_HISTORY_OBJECT":return function(e,{payload:t}){const{entity:s,timestamp:a,text:r}=t,i={type:"history",entity:s,text:r,timestamp:a};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{searches:f(e.data.searches,[i],n)})})}(e,t);case"USER/ADD_HISTORY_SEARCH":return function(e,{payload:t}){const{query:s,timestamp:a}=t,r={type:"history",text:s,timestamp:a};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{searches:f(e.data.searches,[r],n)})})}(e,t);case"USER/CLEAR_HISTORY":return o;default:return e}}function u(e){const{searches:t,suggester_picked_objects:s,last_objects:a}=e,n=(0,r.m)(a,(e=>e.id));return{searches:[...t.map(l),...s.map(g)],suggestLastObjects:n.filter((e=>c.includes(e.type))).map(p)}}function l(e){const{text:t,timestamp:s}=e;return{type:"history",text:t,timestamp:s}}function g(e){const{timestamp:t}=e;return{type:"history",entity:(0,a._T)(e,["timestamp"]),timestamp:t}}function p(e){const{timestamp:t}=e;return{type:"history",entity:(0,a._T)(e,["timestamp"]),timestamp:t}}function b(e,t){return{searches:f(e.searches,t.searches,n),suggestLastObjects:f([],t.suggestLastObjects,i)}}function O(e){return(e.entity?e.entity.id:e.text&&e.text.toLowerCase())||""}function f(e,t,s){const a={};e.forEach((e=>{const t=O(e);t&&(a[t]=e)}));let r=!1;if(t.forEach((e=>{const t=O(e);t&&(a[t]?e.timestamp>a[t].timestamp&&(a[t]=e,r=!0):(a[t]=e,r=!0))})),!r)return e;const n=Object.keys(a).map((e=>a[e]));return n.sort(((e,t)=>e.timestamp<t.timestamp?1:-1)),n.slice(0,s)}},53921:(e,t,s)=>{s.d(t,{A:()=>a});const a=e=>{return t=(null==e?void 0:e.user_id)||"",e=>e.data.user.achievements[t];var t}},56816:(e,t,s)=>{s.d(t,{W:()=>r});var a=s(10451);const r=e=>{var t;return null===(t=e.data.cart[a.M])||void 0===t?void 0:t.data}},38261:(e,t,s)=>{s.d(t,{QB:()=>i,UE:()=>n,cx:()=>r});var a=s(10982);const r=({state:e,searchId:t})=>e.data.directions[t],n=e=>t=>t.data.directionsPpnotTypes[e]||a.Y,i=({searchId:e,directionId:t})=>s=>{const a=r({state:s,searchId:e});if(a&&a.data)switch(a.data.type){case"pedestrian":case"ppna":case"ppng":case"ppnot":return a.data.items.find((e=>e.id===t));default:return}}},70021:(e,t,s)=>{s.d(t,{AE:()=>E,BD:()=>j,T3:()=>d,TB:()=>b,Te:()=>O,Tv:()=>f,XU:()=>p,f6:()=>m,kO:()=>o,nM:()=>l,u5:()=>v,ub:()=>y,wj:()=>u});var a=s(60786),r=s(10982),n=s(64693),i=s(57695),c=s(874);const o=({state:e,entityId:t,searchId:s})=>{const a=y({id:t,searchId:s});return e.data.searchContext[a]},d=()=>(0,a.P1)([({state:e,entityId:t})=>e.data.entity.profile[t],o],((e,t)=>e?e.data&&t?{data:Object.assign(Object.assign({},e.data),t),meta:e.meta}:e:r.Y)),u=d(),l=({state:e,entityId:t})=>e.data.entity.profile[t]||r.Y,g=()=>(0,a.P1)([({state:e,entityId:t})=>e.data.entity.photos[t]],(e=>e||r.Y)),p=g(),b=()=>(0,a.P1)([g(),({state:e})=>e.data.photo],((e,t)=>e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.Gg)})}):{data:void 0,meta:e.meta})),O=b(),f=(0,a.P1)([({state:e,entityId:t})=>e.data.entity.video?e.data.entity.video[t]:void 0],(e=>e||r.Y)),E=({state:e,searchId:t})=>e.data.reviewSearch[t]||r.Y,m=()=>(0,a.P1)([E,({state:e})=>e.data.review],h);function h(e,t){return e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.Gg)})}):{data:void 0,meta:e.meta}}const j=(0,a.P1)([({state:e,entityId:t})=>e.data.entity.discounts[t]],(e=>e||r.Y));function y(e){return e.searchId?`${e.searchId}_${e.id}`:e.id}function v({state:e,searchId:t,entityId:s}){let a=s;if(!a){const s=(0,i.gQ)({state:e,searchId:t,page:1});a=s&&s.data&&s.data[0]}return a&&a!==c.k8?l({state:e,entityId:a}):r.Y}},66030:(e,t,s)=>{s.d(t,{N5:()=>f,Or:()=>g,PP:()=>O,Tb:()=>y,iL:()=>v,jV:()=>b,m9:()=>E,nA:()=>p,tV:()=>l,y7:()=>j});var a=s(97698),r=s(1184),n=s(45485),i=s(79876),c=s(62662),o=s(96160),d=s(44154),u=s(22941);const l=e=>e.data.favoritesPersonal.objects,g=(0,a.P1)(l,(e=>{const t={};return(0,r.s0)(e).forEach((e=>{e&&"favorite"===e.type&&e.collection_id&&(t[e.collection_id]=t[e.collection_id]||[]).push(e)})),t})),p=e=>t=>{const s=l(t)[e];return b(s)?s:void 0};function b(e){return!!e&&"collection"===e.type}const O=e=>t=>{const s=l(t)[e];return f(s)?s:void 0};function f(e){return!!e&&"favorite"===e.type}function E(e){return"0"!==e.data.favoritesPersonal.sync.lastSync}function m(e,t){return e||(0,c.S)(t)&&(0,n.S)(t)}const h=(0,a.P1)(l,(e=>{const t={};return(0,r.s0)(e).forEach((e=>{if(e&&"favorite"===e.type&&e.collection_id){const s=e.point||e.source_point,a=m(e.object_id,s);a&&(t[a]||(t[a]=[])).push(e)}})),t})),j=e=>t=>{const s=m("point"===e.object_type?void 0:e.object_id,e.point);if(s){return(h(t)[s]||[]).some((t=>(0,i.G)(t,e)))}return!1},y=e=>(0,a.P1)([o.eb,o.M6],((t,s)=>!(!e.point||!(0,d.w)(e.point,null==t?void 0:t.point)&&!(0,d.w)(e.point,null==s?void 0:s.point))||(e.object_id===(null==t?void 0:t.object_id)||e.object_id===(null==s?void 0:s.object_id)))),v=(0,a.P1)(l,(e=>Object.values(e).reduce(((e,t)=>{if("collection"===(null==t?void 0:t.type)&&t.collection_id){const s=(0,u._p)(t.collection_id,t.color);e.push(s)}return e}),[])))},96160:(e,t,s)=>{s.d(t,{M6:()=>c,Y4:()=>n,eb:()=>i});var a=s(60786),r=s(1184);const n=e=>e.data.favoritesPlaces.objects,i=(0,a.P1)([n],(e=>(0,r.s0)(e).find((e=>"home"===(null==e?void 0:e.place_type))))),c=(0,a.P1)([n],(e=>(0,r.s0)(e).find((e=>"work"===(null==e?void 0:e.place_type)))))},31559:(e,t,s)=>{s.d(t,{Si:()=>g,UW:()=>d,VJ:()=>l,Wv:()=>O,jM:()=>p,tb:()=>f,zL:()=>u});var a=s(97698),r=s(1184),n=s(874),i=s(89509),c=s(26287);const o=e=>e.data.favoritesPublic.objects,d=(0,a.P1)(o,(e=>{const t={};return(0,r.s0)(e).forEach((e=>{e&&"favorite"===e.type&&e.collection_id&&(t[e.collection_id]=t[e.collection_id]||[]).push(e)})),t})),u=e=>(0,a.P1)((t=>d(t)[e]),(e=>e?(0,i.a)(e):n.LZ)),l=(0,a.P1)(o,(e=>{const t=(0,r.s0)(e),s=[],a=[],i=[];t.forEach((e=>b("interesting",e)?s.push(e):b("guidebook",e)?a.push(e):b("awards2019",e)?i.push(e):void 0));const c=(t,s)=>{const a=s&&s.collections?s.collections.reduce(((t,s)=>{const a=e[s];return t.push(a),t}),[]):n.LZ;return t.push(...a),t};return{interestingList:s.reduce(c,[]),guidebookList:a.reduce(c,[]),awards2019:i.reduce(c,[])}})),g=e=>t=>{const s=o(t)[e];return(a=s)&&"collection"===a.type?s:void 0;var a},p=e=>t=>{const s=o(t)[e];return(a=s)&&"favorite"===a.type?s:void 0;var a};const b=(e,t)=>!!t&&"theme"===t.type&&t.code===e;function O(e){return"0"!==e.data.favoritesPublic.sync.lastSync}const f=e=>(0,a.P1)([e=>e.data.favoritesPublic.objects,c.yH],((t,s)=>(0,r.s0)(t).find((t=>!!t&&("theme"===t.type&&t.code===e&&(!(!s&&t.project_id)&&!(s&&t.project_id&&!t.project_id.includes(s))))))))},82824:(e,t,s)=>{s.d(t,{O:()=>a,t:()=>r});const a=({state:e,filtersId:t})=>e.data.filters[t],r=e=>t=>{const s=t.data.filters[e];return s&&s.filters&&s.filters.attributes}},35706:(e,t,s)=>{s.d(t,{k:()=>a});const a=({state:e,gtaId:t})=>e.data.gta[t]},19609:(e,t,s)=>{s.d(t,{p:()=>r});var a=s(10982);const r=e=>e.data.history||a.Y},55158:(e,t,s)=>{s.d(t,{E$:()=>g,Gt:()=>c,HO:()=>u,Mv:()=>d,O9:()=>p,PC:()=>O,Te:()=>b,Ze:()=>l,ch:()=>o,dK:()=>f,rH:()=>E});var a=s(60786),r=s(10982),n=s(55607),i=s(55712);const c=({state:e,productId:t})=>e.data.market.products[t]||r.Y,o=({state:e,id:t})=>e.data.market.categories[t]||r.Y,d=({state:e,searchId:t})=>e.data.market.offersSearch.profile[t]||r.Y,u=({state:e,searchId:t})=>e.data.market.offersSearch.pagination[t],l=(0,a.P1)([d,u],((e,t)=>e?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,n.m)(t)})}):r.Y)),g=({state:e,productId:t,branchId:s})=>e.data.market.offers[(0,i.l)(t,s)]||r.Y,p=({state:e,filtersId:t})=>e.data.market.filters[t]||r.Y,b=({state:e,searchId:t})=>e.data.market.suggestions[t]||r.Y,O=({state:e,searchId:t})=>e.data.market.offersByOrgSearch.profile[t],f=(0,a.P1)([O,({state:e,searchId:t})=>e.data.market.offersByOrgSearch.pagination[t]],((e,t)=>{if(e)return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,n.m)(t)})})}));function E(e){return`project${e}`}},10982:(e,t,s)=>{s.d(t,{Y:()=>a});const a={data:void 0,meta:void 0}},51436:(e,t,s)=>{s.d(t,{h:()=>n});var a=s(60786),r=s(10982);const n=(0,a.P1)([({state:e,id:t})=>e.data.photo[t]],(e=>e||r.Y))},84472:(e,t,s)=>{s.d(t,{H:()=>a,z:()=>r});const a=e=>t=>{var s;return e&&(null===(s=t.data.realty.infrastructure[e])||void 0===s?void 0:s.data)||void 0},r=e=>e.data.walkDistance||void 0},11447:(e,t,s)=>{s.d(t,{D4:()=>i,Rg:()=>d,zQ:()=>c});var a=s(1184),r=s(60786),n=s(32655);const i=({state:e,id:t})=>e.data.region.profile[t],c=({state:e,id:t})=>e.data.region.detector[t],o=e=>c({state:e,id:"default"}),d=((0,r.P1)([e=>{var t;return null===(t=e.data.settlements.default)||void 0===t?void 0:t.data}],(e=>e?(0,a.s0)((0,n.Y)(e)):void 0)),e=>{var t,s,a,r,n;return(null===(t=(e=>{var t,s,a;return(a=(null===(s=null===(t=o(e))||void 0===t?void 0:t.data)||void 0===s?void 0:s.id)||"",e=>{var t,s;return null===(s=null===(t=e.data.settlements.default)||void 0===t?void 0:t.data)||void 0===s?void 0:s[a]})(e)})(e))||void 0===t?void 0:t.alias)||(null===(n=null===(r=i({state:e,id:(null===(a=null===(s=o(e))||void 0===s?void 0:s.data)||void 0===a?void 0:a.regionId)||""}))||void 0===r?void 0:r.data)||void 0===n?void 0:n.uri_code)||""})},24777:(e,t,s)=>{s.d(t,{F_:()=>n,Tt:()=>r,UB:()=>i});var a=s(10982);const r=({state:e,id:t})=>e.data.review[t]||a.Y,n=(e,t)=>e.data.reviewComments[t]||a.Y,i=e=>t=>t.data.factsFilters[e]||a.Y},62784:(e,t,s)=>{s.d(t,{l:()=>n});var a=s(60786),r=s(10982);const n=({state:e,dashboardId:t})=>e.data.rubric.dashboard[t]||r.Y;(0,a.P1)([({state:e,rubricatorId:t})=>e.data.rubric.rubricator[t]],(e=>e||r.Y))},6844:(e,t,s)=>{s.d(t,{c:()=>i});var a=s(60786),r=s(10982),n=s(55607);const i=(0,a.P1)([({state:e,searchId:t})=>e.data.search.profile[t],({state:e,searchId:t})=>e.data.search.pagination[t]],((e,t)=>e?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:(0,n.m)(t)})}):r.Y))},57695:(e,t,s)=>{s.d(t,{Aw:()=>c,Dx:()=>n,bx:()=>u,gQ:()=>i,rO:()=>o,ue:()=>d});var a=s(60786),r=s(10982);const n=({state:e,searchId:t})=>t&&e.data.search.pagination[t]||void 0,i=({state:e,searchId:t,page:s})=>{const a=n({state:e,searchId:t});return a&&a[s]},c=({state:e,searchId:t})=>t&&e.data.search.markers[t]||void 0,o=({state:e,searchId:t})=>t&&e.data.search.profile[t]||r.Y,d=(0,a.P1)([({state:e,searchId:t})=>n({state:e,searchId:t})],(e=>{const t=e&&e[1];if(t)return t.data[0]})),u=({state:e,searchId:t})=>{const s=i({state:e,searchId:t,page:1});return s&&s.data[0]}},45386:(e,t,s)=>{s.d(t,{n:()=>r});var a=s(10982);const r=e=>e.data.history||a.Y},39924:(e,t,s)=>{s.d(t,{O:()=>n});var a=s(60786),r=s(10982);const n=(0,a.P1)([({state:e,url:t})=>e.data.shortonizer[t]],(e=>e||r.Y))},34423:(e,t,s)=>{s.d(t,{m:()=>a});const a=(0,s(60786).P1)([({state:e,statusId:t})=>e.status[t]],(e=>e))},7806:(e,t,s)=>{s.d(t,{m:()=>o,$:()=>g});var a=s(97698),r=s(66030),n=s(1184),i=s(10982);var c=s(96160);const o=({state:e,searchId:t})=>e.data.objectSuggestions[t]||i.Y;function d(e){if(!e)return;const{object_type:t,object_id:s}=e;if(!s||!t)return;return{type:"place_type"in e?e.place_type:e.type,record:{id:s,type:t}}}function u(e){const{id:t,type:s,count:a,objectType:r,timestamp:n}=e;return{type:s,count:a,last_used:n,record:{id:t,type:r}}}const l=(0,a.P1)(r.tV,(e=>(0,n.s0)(e).filter(r.N5).reduce(((e,t)=>{const s=d(t);return s?[...e,s]:e}),[]))),g=(0,a.P1)([e=>(e=>e.data.profile||i.Y)(e),e=>(0,c.eb)(e),e=>(0,c.M6)(e),e=>l(e)],((e,t,s,a)=>{const{historyObjects:r,homeWorkObjects:n,suggestLastObjects:i}=e.data,c=i.map((e=>{const{id:t,timestamp:s}=e;return{type:"personal_poi",last_used:s,record:{id:t,type:"subtype"in e?`${e.type}.${e.subtype}`:e.type}}})),o=[...r,...n].reduce(((e,t)=>Object.assign(Object.assign({},e),{[t.type]:[...e[t.type]||[],u(t)]})),{}),{history:l=[],supposed_home:g=[],supposed_other:p=[],supposed_work:b=[]}=o,O=d(t),f=d(s);return[...l,...O?[O]:[],...c,...a,...p,...f?[f]:[],...g,...b].slice(0,200)}))},55476:(e,t,s)=>{s.d(t,{C6:()=>y,DK:()=>_,It:()=>p,J:()=>l,J2:()=>o,Mq:()=>j,PT:()=>I,PW:()=>h,Pc:()=>O,Ue:()=>R,WR:()=>S,YS:()=>u,b1:()=>m,bG:()=>b,nu:()=>d,qR:()=>v,qv:()=>f,zP:()=>E});var a=s(60786),r=s(10982),n=s(64693),i=s(25696),c=s(3836);(0,a.P1)([({state:e,userId:t})=>e.data.user.info[t]],(e=>e||r.Y));const o=(0,a.P1)([({state:e,userId:t})=>e.data.user.photos[t]],(e=>e||r.Y)),d=(0,a.P1)([o,({state:e})=>e.data.photo],((e,t)=>e.data?Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.Gg)})}):{meta:e.meta})),u=(0,a.P1)([({state:e,userId:t})=>e.data.user.reviews[t]],(e=>e||r.Y)),l=(0,a.P1)([u,({state:e})=>e.data.review],(function(e,t){if(!e.data)return{data:void 0,meta:e.meta};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items.map((e=>t[e])).filter(n.Gg)})})}));(0,a.P1)([({state:e})=>e.data.user.anonymousUser.feedbacksCount],(e=>e||0));const g=(0,a.P1)([({state:e,userId:t})=>e.data.user.feedbacks[t]],(e=>e||r.Y)),p=(0,a.P1)([g,({state:e})=>e.data.feedback],(function(e,t){if(!e.data)return{data:void 0,meta:e.meta};return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{items:e.data.items?e.data.items.map((e=>t[e])).filter(n.Gg):[]})})}));const b=e=>e.data.user.info.default||r.Y,O=e=>(0,i.d)(b(e)),f=e=>(0,c.V)(b(e)),E=e=>!O(e)&&!f(e),m=e=>{const t=b(e);return t&&t.data&&t.data.user_id},h=e=>e.data.user.devices,j=e=>t=>t.data.user.pinnedReviews[e]||r.Y,y=e=>t=>{var s,a;return null===(a=null===(s=t.data.user.pinnedReviews[e])||void 0===s?void 0:s.data)||void 0===a?void 0:a.items[0]},v=e=>t=>{const s=y(e)(t);if(s)return t.data.review[s]},S=e=>e.data.user.friendsActivities.default||r.Y,_=e=>{var t,s;const a=b(e);return!(!(null===(t=a.data)||void 0===t?void 0:t.phone_number)||!(null===(s=a.data)||void 0===s?void 0:s.phone_number_confirmed))},R=e=>{const t=e.data.user.activities.default||r.Y;return null==t?void 0:t.data},I=e=>e.data.user.chronologyPlaces.default||r.Y},90740:(e,t,s)=>{s.d(t,{I:()=>a});const a=(e,t)=>{var s,a;const r=null===(a=null===(s=e.data.user.info.default)||void 0===s?void 0:s.data)||void 0===a?void 0:a.public_identity_accepted,n=t?r:void 0;return!0===n||void 0===n?"agreed":null===n?"idle":"declined"}},74589:(e,t,s)=>{function a(e){return!!e&&!!e.meta&&"error"===e.meta.status}function r(e,t){if(!e||!a(e))return!1;return e.meta.code===t}s.d(t,{G:()=>r,V:()=>a})},55607:(e,t,s)=>{function a(e){return e?Object.keys(e).sort(((e,t)=>+e-+t)).reduce(((t,s)=>{const a=e[s];return a&&a.data?[...t,...a.data]:t}),[]):[]}s.d(t,{m:()=>a})},3836:(e,t,s)=>{function a(e){return!!e&&!!e.meta&&"error"===e.meta.status}s.d(t,{V:()=>a})},34680:(e,t,s)=>{function a(e){return!e||!e.data}s.d(t,{X:()=>a})},2234:(e,t,s)=>{s.d(t,{G:()=>n});var a=s(34680),r=s(27373);function n(e){return(0,a.X)(e)&&!(0,r.hg)(e)}},73982:(e,t,s)=>{function a(e){return!e||!e.data&&!e.meta}s.d(t,{W:()=>a})},25696:(e,t,s)=>{s.d(t,{d:()=>r});var a=s(73982);function r(e){return!(0,a.W)(e)&&(!!e.meta&&"success"===e.meta.status)}},27373:(e,t,s)=>{s.d(t,{hg:()=>r,k$:()=>n,wX:()=>i});var a=s(34680);function r(e){return!!e&&!!e.meta&&"loading"===e.meta.status}function n(e){return(0,a.X)(e)&&r(e)}function i(e){return!(0,a.X)(e)&&r(e)}},89509:(e,t,s)=>{s.d(t,{a:()=>r});var a=s(64693);function r(e,t){return e.slice().sort(((e,s)=>{if(t){if(e.project_id&&e.project_id.includes(t)&&(!s.project_id||!s.project_id.includes(t)))return-1;if(s.project_id&&s.project_id.includes(t)&&(!e.project_id||!e.project_id.includes(t)))return 1}return(0,a.$K)(s.order)&&(0,a.$K)(e.order)?s.order-e.order:0}))}},53163:(e,t,s)=>{s.d(t,{l:()=>$t});var a=s(69394),r=s(49117),n=s(64693);const i={searchEvent:{},event:{},serverEvents:[]};function c(e=i,t){switch(t.type){case"_BSS_SAVE_EVENT_ATTRS":return function(e,t){const s=(0,r.t)({entityId:t.entityId,hash:t.chainId});return Object.assign(Object.assign({},e),{event:Object.assign(Object.assign({},e.event),{[s]:t.eventAttrs})})}(e,t.payload);case"_BSS_SAVE_SEARCH_EVENT_ATTRS":return function(e,t){return Object.assign(Object.assign({},e),{searchEvent:Object.assign(Object.assign({},e.searchEvent),{[t.chainId]:t.eventAttrs})})}(e,t.payload);case"_BSS_SET_SERVER_EVENTS":return function(e,t){return Object.assign(Object.assign({},e),{serverEvents:t.events})}(e,t.payload);case"BSS/REPLACE_CHAIN_ID":return function(e,t){const s={};(0,n.Ed)(e.searchEvent,(e=>{const a=t[e.chainId]||e.chainId;s[a]=Object.assign(Object.assign({},e),{chainId:a})}));const a=e.serverEvents.map((e=>{if(!e.add.hash||!t[e.add.hash])return e;const s=t[e.add.hash];return Object.assign(Object.assign({},e),{add:Object.assign(Object.assign({},e.add),{hash:s})})}));return Object.assign(Object.assign({},e),{searchEvent:s,serverEvents:a})}(e,t.payload);default:return e}}var o=s(80949),d=s(99428);const u={unclassified:0,recovery:1,discovery:2,geo:3,transport:7,orgExtension:9,discovery_without_rubric:9,fictive:19};var l,g;!function(e){e[e.Bc=1]="Bc",e[e.Imp=2]="Imp",e[e.Search=3]="Search",e[e.Launch=5]="Launch",e[e.Video=9]="Video",e[e.Commercial=14]="Commercial"}(l||(l={})),function(e){e.Start="start",e.Replay="replay",e.Finish="finish",e.Close="close"}(g||(g={}));const p={};function b(e){switch(e){case"branch":return u.recovery;case"station":case"station_platform":case"station_entrance":case"route":return u.transport;default:return u.geo}}const O={};function f(e){return e.map((e=>e.id))}var E=s(24364);const m=(0,a.UY)({profile:function(e=p,t){switch(t.type){case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_PROVIDERS":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":case"SEARCH/BY_BUILDING_ID":case"SEARCH/IN_BUILDING_BY_QUERY":case"SEARCH/FETCH_MAINTAINERS":case"ENTITY/FETCH_BY_POINT":case"SEARCH/FETCH_PARKINGS_AROUND":case"ENTITY/FETCH_PROFILE_NO_TYPE":return function(e,t,s){const a=t.searchId;if(!a)return e;const r=e[a],n=t;if(n.more&&r)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{meta:d.qV})});if(r)return e;return Object.assign(Object.assign({},e),{[a]:{data:{query:n.query,rubrId:n.rubrId,buildingId:n.buildingId,filters:n.filters,orgId:n.orgId,searchSourceType:s,sender:n.sender},meta:d.qV}})}(e,t.payload,{"SEARCH/FETCH_QUERY":"query","SEARCH/FETCH_FILIALS":"filial","SEARCH/BY_BUILDING_ID":"firmsInBuilding","SEARCH/IN_BUILDING_BY_QUERY":"firmsInBuilding","SEARCH/FETCH_MAINTAINERS":"maintainers","SEARCH/FETCH_PROVIDERS":"providers","SEARCH/FETCH_RUBRIC":"rubric","SEARCH/FETCH_ATTRIBUTE":"attribute","ENTITY/FETCH_BY_POINT":"searchByPoint","ENTITY/FETCH_PROFILE_NO_TYPE":"fetchProfile","SEARCH/FETCH_PARKINGS_AROUND":"parking"}[t.type]);case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t){const{meta:s,payload:a}=t,r=s.searchId;if(!r)return e;const n=e[r];if(!n||n.data&&n.data.searchType)return e;if(!a||200!==a.code)return Object.assign(Object.assign({},e),{[r]:{data:Object.assign({},n.data),meta:(0,d.Mq)()}});const i=a.items[0];return Object.assign(Object.assign({},e),{[r]:{data:Object.assign(Object.assign({},n.data),{searchType:b(i.type),hasPagesToLoad:!1,pages:1,total:1,searchSourceType:"branch"===i.type&&"fromPoi"in a&&a.fromPoi?"searchByPoi":n.data.searchSourceType}),meta:d.YR}})}(e,t);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t,s){const a=s.searchId,r=e[a];if(!r)return e;if(!t||200!==t.code)return s.more?e:Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},r.data),meta:(0,d.Mq)()}});if(r.data&&r.data.currentPage===s.page)return Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},r.data),meta:d.YR}});const i=(0,n.uv)({hasPagesToLoad:t.pages>s.page,pages:t.pages,total:t.total,ads:t.ads&&t.ads.map((e=>e.id)),searchType:t.searchType,searchAttributes:t.search_attributes,contextRubrics:t.context_rubrics,currentPage:s.page});return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},r.data),i),meta:d.YR}})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_ERROR":case"SEARCH/FETCH_FILIALS_ERROR":case"SEARCH/FETCH_PROVIDERS_ERROR":case"SEARCH/FETCH_RUBRIC_ERROR":case"SEARCH/FETCH_ATTRIBUTE_ERROR":case"SEARCH/BY_BUILDING_ID_ERROR":case"SEARCH/IN_BUILDING_BY_QUERY_ERROR":case"SEARCH/FETCH_MAINTAINERS_ERROR":case"ENTITY/FETCH_BY_POINT_ERROR":return function(e,t,s){const a=s.searchId,r=e[a];if(!r)return e;if(s.more)return e;return Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},r.data),meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);default:return e}},pagination:function(e=O,t){switch(t.type){case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_PROVIDERS":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":case"SEARCH/BY_BUILDING_ID":case"SEARCH/IN_BUILDING_BY_QUERY":case"SEARCH/FETCH_MAINTAINERS":case"SEARCH/FETCH_PARKINGS_AROUND":return function(e,t){const s=t.searchId;if(!s)return e;const a=t.page,r=e[s];return Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},r),{[a]:{data:[],meta:d.qV}})})}(e,t.payload);case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){const a=s.searchId;if(!a)return e;const r=e[a]||{},n="1";if(r[n])return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:{[n]:{data:[],meta:(0,d.L3)(t.code)}}});const i=f(t.items);return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:{data:i,meta:d.YR}})})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t,s){const a=s.searchId,r=e[a]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[s.page]:Object.assign(Object.assign({},r[s.page]),{meta:(0,d.L3)(t.code)})})});const n=f(t.items);return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[s.page]:{data:n,meta:d.YR}})})}(e,t.payload,t.meta);case"SEARCH/FETCH_QUERY_ERROR":case"SEARCH/FETCH_FILIALS_ERROR":case"SEARCH/FETCH_PROVIDERS_ERROR":case"SEARCH/FETCH_RUBRIC_ERROR":case"SEARCH/FETCH_ATTRIBUTE_ERROR":case"SEARCH/BY_BUILDING_ID_ERROR":case"SEARCH/IN_BUILDING_BY_QUERY_ERROR":case"SEARCH/FETCH_MAINTAINERS_ERROR":return function(e,t,s){const a=s.searchId,r=e[a]||{},n=(0,d.UL)(t);return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[s.page]:Object.assign(Object.assign({},r[s.page]),{meta:n})})})}(e,t.payload,t.meta);default:return e}},markers:function(e={},t){return(0,E.O)(e,t)}});var h=s(85884),j=s(35571),y=s(1184);function v(e,t){return e?e.reduce(((e,s)=>{const a=t[s.id],r={data:(0,h.Eb)(s),meta:d.YR};return e[s.id]=a?(0,h.z2)(a,r):r,e}),{}):{}}var S=s(77904);var _=s(23862);const R=(0,_.xr)("fetchApartments",{},{start:(e,{params:t})=>(0,j.Av)(e,t.id),success(e,{params:t,result:s}){const a=200===s.code?s.items[0]:void 0;return a?(0,j.Cj)(e,t.id,a):e},error:(e,{params:t,error:s})=>(0,j.VJ)(e,t.id,s)});var I=s(12463),T=s(98399);const C=(0,a.UY)({profile:(0,o.g)([function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_PARKINGS_AROUND_SUCCESS":return function(e,t){const s=t&&200===t.code?v(t.items.concat(t.ads||[]),e):{};if(!Object.keys(s).length)return e;return Object.assign(Object.assign({},e),s)}(e,t.payload);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,t){if(!t||200!==t.code)return{};const s=v(t.items.map((e=>e.branch)),e);if(!Object.keys(s).length)return e;return Object.assign(Object.assign({},e),s)}(e,t.payload);case"ENTITY/FETCH_PROFILE_NO_TYPE":return function(e,t){const s=(0,n._J)(t.id),a=e[s];return Object.assign(Object.assign({},e),{[s]:{data:a&&a.data,meta:d.qV}})}(e,t.payload);case"ENTITY/FETCH_BY_POINT_SUCCESS":return function(e,t){const s=t.items[0];if(!s)return e;return Object.assign(Object.assign({},e),{[s.id]:{data:(0,h.Eb)(s),meta:d.YR}})}(e,t.payload);case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){const a=(0,n._J)(s.id),r=t.items[0];if(!r){const t=e[a];return Object.assign(Object.assign({},e),{[a]:{data:t&&t.data,meta:(0,d.Mq)()}})}return Object.assign(Object.assign({},e),{[a]:{data:(0,h.Eb)(r),meta:d.YR}})}(e,t.payload,t.meta);case"ENTITY/FETCH_PROFILE_NO_TYPE_ERROR":return function(e,t,s){const a=(0,n._J)(s.id),r=e[a];return Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"ENTITY/FETCH_MULTIPLE":return function(e,t){if(0===t.ids.length)return e;const s=(0,y.ei)(e,t.ids),a=t.ids.reduce(((e,t)=>(0,j.Av)(e,t)),s);return Object.assign(Object.assign({},e),a)}(e,t.payload);case"ENTITY/FETCH_MULTIPLE_SUCCESS":return function(e,t){if(0===t.items.length)return e;const s=t.items.reduce(((t,s)=>{const a=e[s.id],r=(0,h.Eb)(s),n=(0,h.eg)(a&&a.data,r);return(0,j.Cj)(t,s.id,n)}),{});return Object.assign(Object.assign({},e),s)}(e,t.payload);case"ENTITY/FETCH_MULTIPLE_ERROR":return function(e,t,s){if(0===s.ids.length)return e;const a=(0,y.ei)(e,s.ids),r=s.ids.reduce(((e,s)=>(0,j.VJ)(e,s,t)),a);return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);default:return e}},I.zb],{}),photos:T.a,discounts:function(e={},t){return(0,S.b)(e,t)},video:function(e={},t){switch(t.type){case"ENTITY/FETCH_VIDEO_DATA":return function(e,t){const s=e[t.id],a={data:s?s.data:void 0,meta:d.qV};return Object.assign(Object.assign({},e),{[t.id]:a})}(e,t.payload);case"ENTITY/FETCH_VIDEO_DATA_SUCCESS":return function(e,t,s){const a={data:t,meta:d.YR};return Object.assign(Object.assign({},e),{[s.id]:a})}(e,t.payload,t.meta);case"ENTITY/FETCH_VIDEO_DATA_ERROR":return function(e,t,s){const a=e[s.id],r={data:a?a.data:void 0,meta:(0,d.UL)(t)};return Object.assign(Object.assign({},e),{[s.id]:r})}(e,t.payload,t.meta);default:return e}},apartments:R,entrance:I.FG}),A={};const w=(0,a.UY)({profile:function(e={},t){switch(t.type){case"REGION/FETCH":return function(e,t){return Object.assign(Object.assign({},e),{[t.id]:{meta:d.qV}})}(e,t.payload);case"REGION/FETCH_SUCCESS":return function(e,t,s){return Object.assign(Object.assign({},e),{[s.id]:{data:t.result,meta:d.YR}})}(e,t.payload,t.meta);case"REGION/FETCH_LIST_SUCCESS":return function(e,t){const s={};return Object.assign(Object.assign({},e),t.result.items.reduce(((e,t)=>(e[t.id]={data:t,meta:d.YR},e)),s))}(e,t.payload);case"REGION/CROP_LIST":return function(e,t){if(!t.ids.length)return e;const s={};return t.ids.forEach((t=>{s[t]=e[t]})),s}(e,t.payload);default:return e}},search:function(e={},t){switch(t.type){case"REGION/FETCH_LIST":return function(e,t){return Object.assign(Object.assign({},e),{[t]:{meta:d.qV}})}(e,t.payload.searchId);case"REGION/FETCH_LIST_SUCCESS":return function(e,t,s){return Object.assign(Object.assign({},e),{[s.searchId]:{data:t.result.items.map((e=>e.id)),meta:d.YR}})}(e,t.payload,t.meta);case"REGION/CROP_LIST":return{};default:return e}},detector:function(e={},t){switch(t.type){case"REGION/DETECT":{const s=t.payload.searchId,a=e[s];return Object.assign(Object.assign({},e),{[s]:{data:a&&a.data,meta:d.qV}})}case"REGION/DETECT_SUCCESS":{const a=t.meta.searchId,r=200===t.payload.code&&t.payload.items[0];if(!r)return Object.assign(Object.assign({},e),{[a]:{data:void 0,meta:(0,d.Mq)()}});const n=e[a];return n&&n.data&&n.data.id===r.id?e:Object.assign(Object.assign({},e),{[a]:{data:{regionId:(s=r,s.region_id&&"0"!==s.region_id?s.region_id:s.overlap_region_id&&"0"!==s.overlap_region_id?s.overlap_region_id:void 0),name:r.name,type:r.type,id:r.id,segmentId:r.segment_id,overlapRegionId:r.overlap_region_id,countryCode:r.country_code,allowChangeDomain:r.allow_change_domain,baseOverlapRegionId:t.payload.overlap_region_id,admDiv:r.adm_div},meta:d.YR}})}case"REGION/DETECT_ERROR":{const s=t.meta.searchId;return Object.assign(Object.assign({},e),{[s]:{data:void 0,meta:(0,d.UL)(t.payload)}})}case"REGION/CLEAR_DETECTOR":return{};case"REGION/SET_DETECTOR":return Object.assign(Object.assign({},e),{default:{data:t.payload,meta:d.YR}});default:return e}var s}});var H=s(70021);function U(e){const{items:t,searchId:s}=e,a={};for(const e of t){const{id:t,ads:r,context:i,stat:c,hash:o}=e;a[(0,H.ub)({id:t,searchId:s})]=(0,n.uv)({ads:r,context:i,stat:c,hash:o})}return a}function F(e){const{currentContext:t,profile:s,markerStat:a}=e,{context:r,stat:n,hash:i}=s;let c={ads:s.ads,context:r,stat:n,hash:i};return t&&(c=Object.assign(Object.assign({},c),{stat:t.stat,hash:t.hash,context:t.context})),a&&(c.stat=Object.assign(Object.assign({},a),c.stat)),c}var k=s(55712);const P=(0,a.UY)({profile:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS":case"MARKET/FETCH_CATEGORIES_BY_BRANCH":case"MARKET/FETCH_BRANCH_PRODUCTS":return function(e,{payload:t}){return(0,j.Av)(e,t.offersSearchId)}(e,t);case"MARKET/FETCH_OFFERS_SUCCESS":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a];if(!r)return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:{data:r.data,meta:(0,d.Mq)()}});const n="branchId"in s&&"pinned_items"in t&&t.pinned_items?t.pinned_items.map((e=>(0,k.l)(e.product.id,s.branchId))):void 0,{total:i,pages:c,bss:o}=t,u={list_info:"list_info"in t?t.list_info:void 0,total:i,pages:c,bss:o,pinned_items:n};return Object.assign(Object.assign({},e),{[a]:{data:Object.assign({},u),meta:d.YR}})}(e,t);case"MARKET/FETCH_OFFERS_ERROR":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_ERROR":case"MARKET/FETCH_BRANCH_PRODUCTS_ERROR":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a];if(!r)return e;return Object.assign(Object.assign({},e),{[a]:{data:r.data,meta:(0,d.UL)(t)}})}(e,t);default:return e}},pagination:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS":return function(e,{payload:t}){return Object.assign(Object.assign({},e),{[t.offersSearchId]:Object.assign(Object.assign({},e[t.offersSearchId]),{[t.page]:{meta:d.qV,data:[]}})})}(e,t);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.productId,r=s.offersSearchId,n=e[r]||{};if(200!==t.code)return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},n),{[s.page]:Object.assign(Object.assign({},n[s.page]),{meta:(0,d.L3)(t.code)})})});const i=t.items.map((e=>(0,k.l)(a,e.branch.id)));return Object.assign(Object.assign({},e),{[r]:Object.assign(Object.assign({},n),{[s.page]:{data:i,meta:d.YR}})})}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a]||{},n=1;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{meta:(0,d.L3)(t.code)})})});const i=t.items.map((({product:e})=>(0,k.l)(e.id,s.branchId)));return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:{data:i,meta:d.YR}})})}(e,t);case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a]||{},n=s.page;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{meta:(0,d.L3)(t.code)})})});const i=t.items.map((({product:e})=>(0,k.l)(e.id,s.branchId)));return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:{data:i,meta:d.YR}})})}(e,t);case"MARKET/FETCH_OFFERS_ERROR":case"MARKET/FETCH_CATEGORIES_BY_BRANCH_ERROR":case"MARKET/FETCH_BRANCH_PRODUCTS_ERROR":return function(e,{payload:t,meta:s}){const a=s.offersSearchId,r=e[a]||{},n="page"in s?s.page:1;return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{[n]:Object.assign(Object.assign({},r[n]),{meta:(0,d.UL)(t)})})})}(e,t);default:return e}}});const N={};function L(e){return{type:"market",subtype:e.hint.type,id:e.hint.id,name:e.hint.text,search_attributes:{suggested_text:e.hint.text,suggest_parts:e.hint.highlighted_text.map((e=>({text:e.text,is_suggested:"highlighted"!==e.style})))}}}var D=s(89475);const B={entity:{profile:{},apartments:{},photos:{},discounts:{},entrance:{},video:{}},search:{profile:{},pagination:{},markers:{}},searchContext:{},market:{products:{},offers:{},offersSearch:{profile:{},pagination:{}},offersByOrgSearch:{profile:{},pagination:{}},categories:{},filters:{},suggestions:{}},region:{profile:{},search:{},detector:{}},settlements:{},filters:{},factsFilters:{},factsInReview:{},review:{},photo:{},feedback:{},suggestion:{},objectSuggestions:{},user:{info:{},anonymousUser:{},devices:{},achievements:{},feedbacks:{},photos:{},reviews:{},chronologyPlaces:{},activities:{},friendsActivities:{},pinnedReviews:{},shortOrders:s(10982).Y,phone:{}},shortonizer:{},seoStore:{meta:D.YR},reviewSearch:{},gta:{},history:{data:{searches:[],suggestLastObjects:[]}},profile:{data:{historyObjects:[],homeWorkObjects:[],suggestLastObjects:[]}},favoritesPublic:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},favoritesPersonal:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},favoritesPlaces:{sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}},directions:{},directionsPpnotTypes:{},traffic:{},rubricator:{lists:{},items:{}},rubric:{dashboard:{},rubricator:{}},reviewComments:{},order:{},deliveryOrder:{},ordersHistory:{},cart:{},contests:{},walkDistance:{},roadAccident:{},realty:{search:{profile:{},pagination:{}},items:{},markers:{},hashmap:{},infrastructure:{}}};const Y=(0,a.UY)({products:function(e={},t){switch(t.type){case"MARKET/FETCH_PRODUCT_BY_ID_SUCCESS":return function(e,{payload:t,meta:s}){const a=s.productId,r=e[a],n="items"in t&&t.items?t.items[0]:void 0;if(!n)return Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d.Mq)(a.length<13?410:404)}});return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},n),{dicts:t.dicts}),meta:d.YR}})}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t}){if(!t||200!==t.code)return e;const{items:s,pinned_items:a,dicts:r}=t,n=[...s,...a||[]],i={};return n.forEach((({product:t})=>{const s=e[t.id];i[t.id]={data:s?s.data:{product:t,dicts:r},meta:d.YR}})),Object.assign(Object.assign({},e),i)}(e,t);default:return e}},offersSearch:P,offers:function(e={},t){switch(t.type){case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,{payload:t,meta:s}){if(!t||200!==t.code)return e;const a=s.productId,r={};return t.items.forEach((e=>{const t=(0,k.l)(a,e.branch.id),s={productId:a,branchId:e.branch.id,price:e.price,price_value:e.price_value,currency:e.currency,market_item_actions:e.market_item_actions,amount:e.amount};r[t]={data:s,meta:d.YR}})),Object.assign(Object.assign({},e),r)}(e,t);case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t,meta:s}){if(!t||200!==t.code)return e;const a={};return[...t.items,...t.pinned_items||[]].forEach((({product:e,offer:t,branch:r})=>{const n=(0,k.l)(e.id,s.branchId),i={productId:e.id,branchId:s.branchId,price:t.price,price_value:t.price_value,currency:t.currency,buttons:t.buttons,sellerInfo:r&&r.name,orgId:r&&r.org.id,market_item_actions:t.market_item_actions,amount:t.amount};a[n]={data:i,meta:d.YR}})),Object.assign(Object.assign({},e),a)}(e,t);default:return e}},categories:function(e={},t){switch(t.type){case"MARKET/FETCH_CATEGORIES_BY_BRANCH_SUCCESS":return function(e,{meta:t,payload:s}){if(!s||200!==s.code)return e;const a=t.offersSearchId,r=s.categories;if(!r||!r.children.length){const t=e[a];return Object.assign(Object.assign({},e),{[a]:{data:t&&t.data,meta:(0,d.Mq)()}})}return Object.assign(Object.assign({},e),{[a]:{data:r,meta:d.YR}})}(e,t);case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,{payload:t},s){if(e[s])return e;if(!t||200!==t.code)return e;const{categories:a}=t;if(!a||!a.children.length)return e;return Object.assign(Object.assign({},e),{[s]:{data:a,meta:d.YR}})}(e,t,t.meta.offersSearchId);default:return e}},filters:function(e=N,t){switch(t.type){case"MARKET/FETCH_OFFERS":case"MARKET/FETCH_BRANCH_PRODUCTS":return function(e,t){const{filtersId:s}=t,a=e[s];if(a&&"success"===a.meta.status)return e;return Object.assign(Object.assign({},e),{[s]:{data:void 0,meta:d.qV}})}(e,t.payload);case"MARKET/FETCH_OFFERS_SUCCESS":case"MARKET/FETCH_BRANCH_PRODUCTS_SUCCESS":return function(e,t,s){if(!t)return e;const{filtersId:a}=s,r=e[a];if(!r||r&&"loading"!==r.meta.status)return e;if(200!==t.code)return Object.assign(Object.assign({},e),{[a]:{data:void 0,meta:(0,d.L3)(t.code)}});const{filters:n}=t;return Object.assign(Object.assign({},e),{[a]:{data:{filters:n},meta:d.YR}})}(e,t.payload,t.meta);default:return e}},suggestions:function(e={},t){switch(t.type){case"MARKET/FETCH_SUGGESTIONS":return function(e,{payload:t}){const{searchId:s,query:a}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:a},meta:d.qV}})}(e,t);case"MARKET/FETCH_SUGGESTIONS_SUCCESS":return function(e,{payload:t,meta:s}){const{searchId:a}=s,{code:r,items:n,bss:i}=t,c=e[a];if(!c)return e;if(200!==r||!n||!n.length)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},c),{meta:(0,d.Mq)()})});return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},c.data),{items:n.map(L),bss:i}),meta:d.YR}})}(e,t);case"MARKET/FETCH_SUGGESTIONS_ERROR":return function(e,{payload:t,meta:s}){const{searchId:a}=s,r=e[s.searchId];if(!r)return e;return Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d.UL)(t)}})}(e,t);case"MARKET/DROP_SUGGESTIONS":return{};default:return e}},offersByOrgSearch:(0,T.L)(B.market.offersByOrgSearch)});var G=s(22970);function M(e){return"user_query"===e.type?{type:"object",search_attributes:e.search_attributes}:function(e){const{search_attributes:t}=e,s=(0,G._T)(e,["search_attributes"]);return{type:"object",search_attributes:t,entity:s}}(e)}var V=s(45051);const x=(0,_.KX)("fetchUserAchievements",{start:(e,{params:t})=>({[t.userId]:Object.assign(Object.assign({},e),{meta:d.qV})}),success:(e,{result:t,params:s})=>t.items&&t.items.length?Object.assign(Object.assign({},e),{[s.userId]:{data:{groups:t.groups,items:t.items,total:t.meta.total,completed:t.meta.completed,contest_progress_weeks:t.meta.contest_progress_weeks},meta:d.YR}}):Object.assign(Object.assign({},e),{[s.userId]:{meta:(0,d.Mq)()}}),error:(e,{error:t,params:s})=>({[s.userId]:Object.assign(Object.assign({},e),{meta:(0,d.UL)(t)})})});var q=s(45942);const K=(0,a.UY)({info:function(e={},t){switch(t.type){case"USER/UPDATE_UNSAVED_INFO":{const s=e.default;if(!s||!s.data)return e;const a=s.data,r=Object.assign(Object.assign({},a.unsaved),t.payload.unsaved),i=Object.assign(Object.assign({},a),{unsaved:null===a.public_identity_accepted&&!1===r.public_identity_accepted?(0,n.CE)(r,["public_identity_accepted"]):r});return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},s),{data:i})})}case"USER/UPDATE_EMAIL":{const t=e.default;if(!t||!t.data)return e;const s=Object.assign(Object.assign({},t.meta),{crud:"updating"});return Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},t),{meta:s})})}case"USER/UPDATE_EMAIL_SUCCESS":{const s=e.default;return s&&s.data?Object.assign(Object.assign({},e),{default:Object.assign(Object.assign({},s),{data:Object.assign(Object.assign({},s.data),{new_email:t.payload.new_email||void 0,unsaved:Object.assign(Object.assign({},s.data.unsaved),{email:void 0})}),meta:Object.assign(Object.assign({},s.meta),{crud:void 0})})}):e}case"USER/UPDATE_EMAIL_ERROR":{const t=e.default;return t&&t.data?Object.assign(Object.assign({},e),{default:{data:Object.assign(Object.assign({},t.data),{unsaved:Object.assign(Object.assign({},t.data.unsaved),{email:void 0})}),meta:Object.assign(Object.assign({},t.meta),{crud:void 0})}}):e}default:return(0,V.j)(e,t)}},photos:(0,T.L)(B.user.photos),reviews:function(e={},t){switch(t.type){case"USER/FETCH_REVIEWS":return function(e,t){const s=e[t.userId];return Object.assign(Object.assign({},e),{[t.userId]:{data:s&&s.data,meta:d.qV}})}(e,t.payload);case"USER/FETCH_REVIEWS_SUCCESS":return function(e,t,s){const a=e[s.userId];if(!t.items.length)return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d.Mq)()}});const r=a&&a.data&&a.data.items||[],n=t.items.map((e=>e.id)),i=s.offset?[...r,...n]:n,c=t.items[t.items.length-1];return Object.assign(Object.assign({},e),{[s.userId]:{data:{items:i,total:t.total,offset:c.date_edited||c.date_created},meta:d.YR}})}(e,t.payload,t.meta);case"USER/FETCH_REVIEWS_ERROR":return function(e,t,s){const a=e[s.userId];return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t,s){const a=e[s.userId];if(!a||!a.data)return e;const r=a.data.items.filter((e=>e!==s.id));return Object.assign(Object.assign({},e),{[s.userId]:{data:Object.assign(Object.assign({},a.data),{items:r,total:a.data.total-1}),meta:a.meta}})}(e,t.payload,t.meta);default:return e}},feedbacks:function(e={},t){switch(t.type){case"FEEDBACK/FETCH_USER_FEEDBACKS":return function(e,t){const s=e[t.userId];return Object.assign(Object.assign({},e),{[t.userId]:{data:s&&s.data,meta:d.qV}})}(e,t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS_SUCCESS":return function(e,t,s){const a=e[s.userId];if(!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d.Mq)()}});const r=a&&a.data&&a.data.items||[],n=t.items.map((e=>e.id)),i=s.offset>0?[...r,...n]:n;return Object.assign(Object.assign({},e),{[s.userId]:{data:Object.assign(Object.assign({},a&&a.data),{items:i,offset:i.length}),meta:d.YR}})}(e,t.payload,t.meta);case"FEEDBACK/FETCH_USER_FEEDBACKS_ERROR":return function(e,t,s){const a=e[s.userId];return Object.assign(Object.assign({},e),{[s.userId]:{data:a&&a.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT_SUCCESS":return function(e,t,s){const a=e[s.userId],r=a&&a.data;return Object.assign(Object.assign({},e),{[s.userId]:Object.assign(Object.assign({},a),{data:Object.assign(Object.assign({},r),{items:r&&r.items||[],total:t.total}),meta:a?a.meta:d.YR})})}(e,t.payload,t.meta);default:return e}},anonymousUser:function(e={},t){switch(t.type){case"FEEDBACK/GET_ANOMYMOUS_FEEDBACKS_COUNT_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),{feedbacksCount:t?parseInt(t,10):0})}(e,t.payload);case"FEEDBACK/SET_ANOMYMOUS_FEEDBACKS_COUNT":return function(e,t){return Object.assign(Object.assign({},e),{feedbacksCount:t.feedbacksCount})}(e,t.payload);default:return e}},achievements:function(e={},t){return t.type,x(e,t)},devices:function(e={},t){return"USER/CLEAR_DEVICES"===t.type?{}:e},pinnedReviews:function(e={},t){return"USER/DELETE_REVIEW_SUCCESS"===t.type&&t.meta.entityId?Object.assign(Object.assign({},e),{[t.meta.entityId]:void 0}):e},shortOrders:(0,T.L)(B.user.shortOrders),activities:(0,T.L)(B.user.activities),friendsActivities:function(e={},t){return(0,q.V)(e,t)},phone:(0,T.L)(B.user.phone),chronologyPlaces:(0,T.L)(B.user.chronologyPlaces)});var W=s(82358);function J(e,{sync:t,objects:s,replace:a}){return a?{sync:t,objects:s}:(0,n.xb)(s)?{sync:t,objects:e.objects}:{sync:t,objects:Object.assign(Object.assign({},e.objects),s)}}const z=(0,_.Rs)("syncPublicFavorites","favoritesPublic",{success:(e,{result:t})=>J(e,t)}),Q=(0,_.Rs)("syncPlaces","favoritesPlaces",{success:(e,{result:t})=>J(e,t)}),$=(0,_.Rs)("modifyPlaces","favoritesPlaces",{success:(e,{result:t})=>J(e,t)}),X=(0,_.Rs)("modifyPersonalFavorites","favoritesPersonal",{success:(e,{result:t})=>J(e,t)}),Z=(0,_.Rs)("syncPersonalFavorites","favoritesPersonal",{success:(e,{result:t})=>J(e,t)}),ee=(0,_.Rs)("fetchTrafficScore","traffic",{start(e,{params:t}){const s=e[t.regionCode];return Object.assign(Object.assign({},e),{[t.regionCode]:{data:s&&s.data,meta:D.qV}})},success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{[t.regionCode]:{data:{score:s},meta:D.YR}}),error(e,{params:t,error:s}){const a=e[t.regionCode];return Object.assign(Object.assign({},e),{[t.regionCode]:{data:a&&a.data,meta:(0,D.UL)(s)}})}});var te=s(55158),se=s(97825);const ae=(0,_.Rs)("fetchProjecMarketCategories","market",{start:(e,{params:t})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.rH)(t.projectId)]:{meta:d.qV}})}),success:(e,{params:t,result:s})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.rH)(t.projectId)]:{meta:d.YR,data:s.categories}})}),error:(e,{params:t,error:s})=>Object.assign(Object.assign({},e),{categories:Object.assign(Object.assign({},e.categories),{[(0,te.rH)(t.projectId)]:{meta:(0,d.UL)(s)}})})}),re=(0,_.Rs)("fetchProductOffersGroupedByOrg","market",{start:(e,{params:t})=>ne({state:e,searchId:t.searchId,page:t.page,meta:d.qV}),success(e,{params:t,result:s}){if(!s.items.length)return ne({state:e,searchId:t.searchId,page:t.page,meta:(0,d.Mq)()});const{searchId:a,filtersId:r,page:n=1}=t,{filters:i,total:c,items:o,bss:u}=s,l=d.YR;return Object.assign(Object.assign({},e),{offersByOrgSearch:Object.assign(Object.assign({},e.offersByOrgSearch),{profile:Object.assign(Object.assign({},e.offersByOrgSearch.profile),{[a]:{data:{total:c,pages:(g=c,p=se.Kt,Math.ceil(g/p)),bss:u},meta:l}}),pagination:Object.assign(Object.assign({},e.offersByOrgSearch.pagination),{[a]:Object.assign(Object.assign({},e.offersByOrgSearch.pagination[a]),{[n]:{data:o,meta:l}})})}),filters:Object.assign(Object.assign({},e.filters),r?{[r]:{data:{filters:i},meta:l}}:void 0)});var g,p},error:(e,{params:t,error:s})=>ne({state:e,searchId:t.searchId,page:t.page,meta:(0,d.UL)(s)})});function ne({state:e,searchId:t,filtersId:s,page:a=1,meta:r}){return Object.assign(Object.assign({},e),{offersByOrgSearch:Object.assign(Object.assign({},e.offersByOrgSearch),{profile:Object.assign(Object.assign({},e.offersByOrgSearch.profile),{[t]:Object.assign(Object.assign({},e.offersByOrgSearch.profile[t]),{meta:r})}),pagination:Object.assign(Object.assign({},e.offersByOrgSearch.pagination),{[t]:Object.assign(Object.assign({},e.offersByOrgSearch.pagination[t]),{[a]:{data:[],meta:r}})})}),filters:Object.assign(Object.assign({},e.filters),s?{[s]:Object.assign(Object.assign({},e.filters[s]),{meta:r})}:void 0)})}const ie=(0,_.Rs)("getAllPublicFavorites","favoritesPublic",{success:(e,{result:t})=>J(e,t)}),ce=[(0,_.Rs)("clearPersonalData","favoritesPersonal",{success:()=>({sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}})}),(0,_.Rs)("clearPersonalData","favoritesPlaces",{success:()=>({sync:{lastSync:"0",lastSyncAttr:{project_id:{}}},objects:{}})}),(0,_.Rs)("clearPersonalData","user",{success:e=>Object.assign(Object.assign({},B.user),{info:e.info,anonymousUser:e.anonymousUser})}),(0,_.Rs)("clearPersonalData","history",{success:()=>({data:{searches:[],suggestLastObjects:[],historyObjects:[],homeWorkObjects:[]}})})],oe=(0,_.Rs)("fetchReviewComments","reviewComments",{start:(e,{params:t})=>(0,j.Av)(e,t.id),success:(e,{result:t,params:s})=>(0,j.Cj)(e,s.id,t.comments),error:(e,{error:t,params:s})=>(0,j.VJ)(e,s.id,t)}),de=(0,_.Rs)("sendReviewCommentAnswer","reviewComments",{success(e,{params:t,result:s}){const a=e[t.id];return a?Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},a),{data:a.data?[...a.data,s.comment]:[s.comment]})}):e}}),ue=(0,_.Rs)("removeReviewComment","reviewComments",{success(e,{params:t}){var s;const a=e[t.reviewId];return a?Object.assign(Object.assign({},e),{[t.reviewId]:Object.assign(Object.assign({},a),{data:null===(s=a.data)||void 0===s?void 0:s.filter((e=>e.id!==t.id))})}):e}}),le=(0,_.Rs)("fetchDevices","user",{start:e=>Object.assign(Object.assign({},e),{devices:Object.assign(Object.assign({},e.devices),{meta:d.qV})}),success:(e,{result:t})=>Object.assign(Object.assign({},e),{devices:{data:t.items,meta:d.YR}}),error:(e,{error:t})=>Object.assign(Object.assign({},e),{devices:{meta:(0,d.UL)(t)}})}),ge=(0,_.Rs)("fetchReviewsFacts","factsFilters",{start:(e,{params:t})=>(0,j.Av)(e,t.id),success:(e,{result:t,params:s})=>(0,j.Cj)(e,s.id,t.data||[]),error:(e,{error:t,params:s})=>(0,j.VJ)(e,s.id,t)});var pe=s(326);const be=(0,_.Rs)("setReviewLike","review",{start(e,{params:t}){const{id:s,value:a}=t,r=e[s];if(!r)return e;const n=r.data;return(0,pe.d)(n)?Object.assign(Object.assign({},e),{[s]:Object.assign(Object.assign({},r),{data:Object.assign(Object.assign({},n),{likes_count:Oe(n.likes_count,a),additional_data:Object.assign(Object.assign({},n.additional_data),{is_liked:a})})})}):e}});function Oe(e,t){return t?e+1:e>0?e-1:0}var fe=s(44514),Ee=s(4313),me=s(3108),he=s(8875),je=s(3856),ye=s(18954),ve=s(71259),Se=s(74614),_e=s(27386);const Re=[ye.Fw,ve.y,Se.p,_e.m];var Ie=s(59957),Te=s(90152),Ce=s(49187),Ae=s(88247),we=s(27544);const He=(0,a.UY)({entity:C,search:m,filters:function(e=A,t){switch(t.type){case"SEARCH/FETCH_FILIALS":case"SEARCH/FETCH_QUERY":case"SEARCH/FETCH_RUBRIC":case"SEARCH/FETCH_ATTRIBUTE":return function(e,t){const{withFilters:s,filtersId:a}=t;return s&&a?Object.assign(Object.assign({},e),{[a]:{}}):e}(e,t.payload);case"SEARCH/FETCH_FILIALS_FILTERS":case"SEARCH/FETCH_FILTERS":return function(e,t){const{filtersId:s}=t;return s?Object.assign(Object.assign({},e),{[s]:{}}):e}(e,t.payload);case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":return function(e,t,s){const a=s.filtersId;return a&&e[a]&&t&&200===t.code&&t.widgets&&t.filters?Object.assign(Object.assign({},e),{[a]:{widgets:t.widgets,filters:t.filters}}):e}(e,t.payload,t.meta);case"SEARCH/FETCH_FILTERS_SUCCESS":case"SEARCH/FETCH_FILIALS_FILTERS_SUCCESS":return function(e,t,s){const{filters:a,widgets:r}=t,n=s.filtersId;return e[n]&&r&&a?Object.assign(Object.assign({},e),{[n]:{widgets:r,filters:a}}):e}(e,t.payload,t.meta);default:return e}},region:w,searchContext:function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const a=s.searchId,r=U({items:t.items.concat(t.ads||[]),searchId:a});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);case"MARKET/FETCH_OFFERS_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const a=s.offersSearchId,r=U({items:t.items.map((e=>e.branch)),searchId:a});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){if(200!==t.code)return e;const a=t.items[0];if(!a)return e;const r=(0,H.ub)({searchId:s.searchId,id:a.id}),n=e[r],i=F({currentContext:n,profile:a,markerStat:s.markerStat});return Object.assign(Object.assign({},e),{[r]:i})}(e,t.payload,t.meta);case"ENTITY/FETCH_BY_POINT_SUCCESS":return function(e,t,s){if(!t||200!==t.code)return e;const a=s.searchId,r=U({items:t.items,searchId:a});return Object.assign(Object.assign({},e),r)}(e,t.payload,t.meta);case"ENTITY/FETCH_MULTIPLE_SUCCESS":return function(e,t,s){if(0===t.items.length)return e;const a=t.items.reduce(((t,a)=>{const r=(0,H.ub)({searchId:s.searchId,id:a.id}),n=F({currentContext:e[r],profile:a});return Object.assign(Object.assign({},t),{[r]:n})}),{});return Object.assign(Object.assign({},e),a)}(e,t.payload,t.meta);default:return e}},suggestion:function(e={},t){switch(t.type){case"SEARCH/FETCH_SUGGESTIONS":return function(e,t){const{searchId:s,query:a}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:a},meta:d.qV}})}(e,t.payload);case"SEARCH/FETCH_SUGGESTIONS_SUCCESS":return function(e,t,s){const{searchId:a}=s,r=e[a];if(!r)return e;if(200!==t.code||!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{meta:(0,d.Mq)()})});return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},r.data),{items:t.items}),meta:d.YR}})}(e,t.payload,t.meta);case"SEARCH/FETCH_SUGGESTIONS_ERROR":return function(e,t,s){const{searchId:a}=s,r=e[s.searchId];if(!r)return e;return Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d.UL)(t)}})}(e,t.payload,t.meta);case"SEARCH/CROP_SUGGESTION":return{};default:return e}},objectSuggestions:function(e={},t){switch(t.type){case"SEARCH/FETCH_OBJECT_SUGGESTIONS":return function(e,{payload:t}){const{searchId:s,query:a}=t;return Object.assign(Object.assign({},e),{[s]:{data:{query:a},meta:d.qV}})}(e,t);case"SEARCH/FETCH_OBJECT_SUGGESTIONS_SUCCESS":return function(e,{payload:t,meta:s}){const{searchId:a}=s,r=e[a];if(!r)return e;if(200!==t.code||!t.items||!t.items.length)return Object.assign(Object.assign({},e),{[a]:Object.assign(Object.assign({},r),{meta:(0,d.Mq)()})});return Object.assign(Object.assign({},e),{[a]:{data:Object.assign(Object.assign({},r.data),{items:t.items.map(M),searchAttributes:t.search_attributes}),meta:d.YR}})}(e,t);case"SEARCH/FETCH_OBJECT_SUGGESTIONS_ERROR":return function(e,{payload:t,meta:s}){const{searchId:a}=s,r=e[s.searchId];if(!r)return e;return Object.assign(Object.assign({},e),{[a]:{data:r&&r.data,meta:(0,d.UL)(t)}})}(e,t);case"SEARCH/CROP_SUGGESTION":return{};default:return e}},review:function(e={},t){switch(t.type){case"USER/FETCH_REVIEWS_SUCCESS":case"REVIEW/FETCH_REVIEWS_SUCCESS":return function(e,t){if(!t.items.length)return e;const s=t.items.reduce(((t,s)=>{var a;const r=null===(a=e[s.id])||void 0===a?void 0:a.data;return t[s.id]={data:Object.assign(Object.assign(Object.assign({},r),s),{object:Object.assign(Object.assign({},r&&"object"in r?null==r?void 0:r.object:void 0),s.object)}),meta:d.YR},t}),{});return Object.assign(Object.assign({},e),s)}(e,t.payload);case"USER/DELETE_REVIEW":return function(e,t){const s=e[t.id];if(!s)return e;return Object.assign(Object.assign({},e),{[t.id]:Object.assign(Object.assign({},s),{meta:Object.assign(Object.assign({},s.meta),{crud:"deleting"})})})}(e,t.payload);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t,s){if(!e[s.id])return e;const a=Object.assign({},e);return delete a[s.id],a}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_ERROR":return function(e,t,s){const a=e[s.id];if(!a)return e;return Object.assign(Object.assign({},e),{[s.id]:Object.assign(Object.assign({},a),{meta:Object.assign(Object.assign({},a.meta),{crud:void 0})})})}(e,t.payload,t.meta);default:return e}},photo:T.a,user:K,feedback:function(e={},t){return"FEEDBACK/FETCH_USER_FEEDBACKS_SUCCESS"===t.type?function(e,t){if(!t.items)return e;const s=t.items.reduce(((e,t)=>(e[t.id]={data:t,meta:d.YR},e)),{});return Object.assign(Object.assign({},e),s)}(e,t.payload):e},seoStore:function(e=B.seoStore,t){switch(t.type){case"SEO_STORE/FETCH":return function(e){return Object.assign(Object.assign({},e),{meta:d.qV})}(e);case"SEO_STORE/FETCH_SUCCESS":return function(e,t){return Object.assign(Object.assign({},e),{data:t,meta:d.YR})}(e,t.payload);case"SEO_STORE/FETCH_ERROR":return function(e,t){return Object.assign(Object.assign({},e),{meta:(0,d.UL)(t)})}(e,t.payload);case"SEO_STORE/CLEAR_MINI_TEXT":return function(e){return Object.assign(Object.assign({},e),{data:Object.assign(Object.assign({},e.data),{miniText:void 0})})}(e);default:return e}},reviewSearch:function(e={},t){switch(t.type){case"REVIEW/FETCH_REVIEWS":return function(e,t){const s=e[t.searchId];return Object.assign(Object.assign({},e),{[t.searchId]:{meta:d.qV,data:s?s.data:void 0}})}(e,t.payload);case"REVIEW/FETCH_REVIEWS_SUCCESS":return function(e,t,s){const a=e[s.searchId],r=a&&a.data&&a.data.items||[],n=[...r,...t.items.map((e=>e.id))],i=t.items[t.items.length-1],c=t.items[0],o=!r.length&&c&&c.additional_data&&"pinned"===c.additional_data.pin_status?c.id:void 0,u=a&&a.data&&a.data.pinnedId?a.data.pinnedId:o;return Object.assign(Object.assign({},e),{[s.searchId]:{meta:d.YR,data:{rating:t.rating,orgRating:t.orgRating,total:t.total,totalForRequest:t.totalForRequest,offset:t.hasMore&&i?i.date_edited||i.date_created:void 0,items:n,pinnedId:u}}})}(e,t.payload,t.meta);case"REVIEW/FETCH_REVIEWS_ERROR":return function(e,t,s){const a=e[s.searchId];return Object.assign(Object.assign({},e),{[s.searchId]:Object.assign(Object.assign({},a),{meta:(0,d.UL)(t)})})}(e,t.payload,t.meta);case"USER/DELETE_REVIEW_SUCCESS":return function(e,t){if(!t.searchId)return e;const s=t.searchId,a=e[s],r=a&&a.data;if(!a||!r)return e;const n=r.total-1,i=r.items.filter((e=>e!==t.id)),c=r.pinnedId===t.id?void 0:r.pinnedId;return Object.assign(Object.assign({},e),{[t.searchId]:{meta:a.meta,data:Object.assign(Object.assign({},r),{total:n,items:i,pinnedId:c})}})}(e,t.meta);default:return e}},gta:function(e={},t){switch(t.type){case"SEARCH/FETCH_QUERY_SUCCESS":case"SEARCH/FETCH_RUBRIC_SUCCESS":case"SEARCH/FETCH_ATTRIBUTE_SUCCESS":case"SEARCH/FETCH_FILIALS_SUCCESS":case"SEARCH/BY_BUILDING_ID_SUCCESS":case"SEARCH/IN_BUILDING_BY_QUERY_SUCCESS":case"SEARCH/FETCH_MAINTAINERS_SUCCESS":case"SEARCH/FETCH_PROVIDERS_SUCCESS":case"ENTITY/FETCH_BY_POINT_SUCCESS":case"ENTITY/FETCH_PROFILE_NO_TYPE_SUCCESS":return function(e,t,s){var a,r;if(!t||200!==t.code)return e;const n=s.gtaId;if(!n)return e;if((null===(a=t.ad)||void 0===a?void 0:a.gta)===e[n])return e;return Object.assign(Object.assign({},e),{[n]:null===(r=t.ad)||void 0===r?void 0:r.gta})}(e,t.payload,t.meta);default:return e}},history:W.ZP,market:Y,factsInReview:function(e={},t){return"REVIEW/FETCH_REVIEWS_SUCCESS"===t.type?function(e,t){const{payload:s,meta:a}=t;if(!s.items.length)return e;const r=s.items.reduce(((e,t)=>{var s;const a=(null===(s=t.additional_data)||void 0===s?void 0:s.filtered_facts)||[];return a.length?Object.assign(Object.assign({},e),{[t.id]:a}):e}),{}),n=e[a.searchId]||{};return Object.assign(Object.assign({},e),{[a.searchId]:Object.assign(Object.assign({},n),r)})}(e,t):e},favoritesPublic:(0,o.g)([function(e,t){return"FAVORITES/CROP_PUBLIC_SET"===t.type?function(e,t){if(!t.ids)return e;const s=t.ids.reduce(((t,s)=>(e.objects[s]&&(t[s]=e.objects[s]),t)),{});return Object.assign(Object.assign({},e),{objects:s})}(e,t.payload):e}],B.favoritesPublic),directions:T.a,directionsPpnotTypes:T.a,traffic:T.a,factsFilters:T.a,order:T.a,deliveryOrder:T.a,reviewComments:T.a,ordersHistory:T.a,cart:T.a,contests:T.a,shortonizer:T.a,favoritesPersonal:(0,T.L)(B.favoritesPersonal),favoritesPlaces:(0,T.L)(B.favoritesPlaces),rubricator:(0,T.L)(B.rubricator),rubric:(0,T.L)(B.rubric),realty:(0,T.L)(B.realty),profile:(0,T.L)(B.profile),settlements:(0,T.L)(B.settlements),walkDistance:(0,T.L)(B.walkDistance),roadAccident:(0,T.L)(B.roadAccident)}),Ue=(0,o.g)([He,...ce,le,ee,ae,re,oe,de,ue,z,ie,Z,X,Q,$,ge,be,Ee.R,me.D,Ae.F,we.r,he.$,je.l,Ie.O,...fe.y,...Re,Te.e,Ce.q],B),Fe=(0,_.KX)("setFlag",{success:(e,{result:t})=>Object.assign(Object.assign({},e),{flags:t})}),ke={userId:"",platform:"online",ip:"",hostname:"",userAgent:"void",startURL:"",isIE:!1,isWindows:!1,flags:{},geolocation:{allowed:!1,following:!1},screen:{width:1200,height:600},isOffline:!1,isSearchBot:!1,isMuseum:!1,browserLang:"ru",browserLocale:void 0,time:0,timeDelta:0,is3dEnabled:!0},Pe=(0,o.g)([function(e,t){switch(t.type){case"USER/SET_PARAMS":case"USER/SET_SID_USER_PARAMS":return Object.assign(Object.assign({},e),t.payload);case"USER/SET_STAT_HASH":return Object.assign(Object.assign({},e),{statHash:t.payload.statHash});case"USER/ACTIVATE_MY_GEOLOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!0,following:!0,error:void 0})});case"USER/DEACTIVATE_MY_GEOLOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!1,following:!1,error:void 0})});case"USER/ALLOW_LOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:t.payload.allow,following:!1,error:void 0})});case"USER/FOLLOW_LOCATION":return t.payload.follow===e.geolocation.following?e:Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{following:t.payload.follow})});case"USER/SET_LOCATION":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{error:void 0,position:{lon:t.payload.lonLat.lon,lat:t.payload.lonLat.lat},accuracy:t.payload.accuracy})});case"USER/LOCATION_ERROR":return Object.assign(Object.assign({},e),{geolocation:Object.assign(Object.assign({},e.geolocation),{allowed:!1,error:!0})});case"USER/UPDATE_ONLINE_STATUS":return t.payload.isOffline===e.isOffline?e:Object.assign(Object.assign({},e),{isOffline:t.payload.isOffline});case"USER/SET_WINDOW_SIZE":return Object.assign(Object.assign({},e),{screen:t.payload});case"USER/SET_UTM":return Object.assign(Object.assign({},e),{utm:t.payload});case"TIME/SET_DELTA":return function(e,t){const s=e.time-t.time;if(Math.abs(s)<6e4)return e;return Object.assign(Object.assign({},e),{timeDelta:s})}(e,t.payload);case"TIME/SET":return Object.assign(Object.assign({},e),{time:t.payload.time});case"TIME/SET_TIMEZONE":return function(e,t){const s=t.timezone/60,a=e.timeDelta/Ne,r=s+a;return Object.assign(Object.assign({},e),{timezone:r})}(e,t.payload);case"USER/SET_3D_MAP_ENABLED_STATUS":return Object.assign(Object.assign({},e),{is3dEnabled:t.payload.is3dEnabled});default:return e}},Fe],ke);const Ne=36e5;function Le(e={},t){if("async"in t&&t.async){const s=t.payload&&t.payload.statusId;return s?Object.assign(Object.assign({},e),{[s]:De(s,t.type)}):e}if("success"in t&&t.success){const s=t.meta&&t.meta.statusId;if(!s)return e;const a=e[s];return a?Object.assign(Object.assign({},e),{[s]:Be(a,d.YR)}):e}if("error"in t&&t.error){const s=t.meta&&t.meta.statusId;if(!s)return e;const a=e[s];return a?Object.assign(Object.assign({},e),{[s]:Be(a,(0,d.UL)(t.payload))}):e}if("effect"in t&&t.effect){const s=t.payload.params.statusId||t.payload.uuid;if("start"===t.payload.phase)return Object.assign(Object.assign({},e),{[s]:De(s,t.type)});const a=e[s];if(!a)return e;const r="success"===t.payload.phase?d.YR:(0,d.UL)(t.payload.error);return Object.assign(Object.assign({},e),{[s]:Be(a,r)})}return e}function De(e,t){return{id:e,type:t,meta:d.qV,__timing:{start:Date.now()}}}function Be(e,t){return{id:e.id,type:e.type,meta:t,__timing:{start:e.__timing.start,end:Date.now()}}}const Ye=e=>{const t=(0,a.UY)(Object.assign({bss:c,data:Ue,session:Pe,status:Le},e));return(e,s)=>(s.reducers&&s.reducers.length&&(e=s.reducers.reduce(((e,t)=>t(e,s)),e)),"HISTORY/REPLACE_STATE"===s.type?Object.assign(Object.assign({},e),s.payload):t(e,s))};var Ge=s(96647),Me=s(67753);function Ve(e){return t=>s=>a=>{let r=t.dispatch;const n=a[Me.ev.NAME];switch(a.type){case"INTERNAL/SIGNAL":return r(xe(a.payload.action,n));case"INTERNAL/ACTION_SEQUENCE":return function(e,t,s){return e.reduce(((e,a)=>e.then((()=>{if(a)return t(xe(a,s))}))),Promise.resolve())}(a.payload,r,n);case"INTERNAL/ACTION_PARALLEL":return function(e,t,s){return Promise.all(e.map((e=>{if(e)return t(xe(e,s))})))}(a.payload,r,n);case"INTERNAL/ACTION_WITH_STATE":return(0,Ge.Z)(t.getState,a.payload,(e=>e&&r(xe(e,n))))();case"INTERNAL/ACTION_WITH_CONFIG":const i=(0,a.payload)(e);return i&&r(xe(i,n));case"INTERNAL/NOOP":return;case"INTERNAL/DEFER":const c=a.payload.fn();return c?c instanceof Promise?c:r(xe(c,n)):void 0;default:return s(a)}}}function xe(e,t){return t?(e[Me.ev.NAME]=e[Me.ev.NAME]?`${t}.${e[Me.ev.NAME]}`:t,e):e}class qe{constructor(e){this.webApi=e.webApi,this.photoApi=e.photoApi,this.reviewsApi=e.reviewsApi,this.storyComplaintApi=e.storyComplaintApi,this.shortonizerApi=e.shortonizerApi,this.profileApi=e.profileApi,this.videoApi=e.videoApi,this.marketApi=e.marketApi,this.feedbackApi=e.feedbackApi,this.cookieApi=e.cookieApi,this.authApi=e.authApi,this.windowApi=e.windowApi,this.aggregatorApi=e.aggregatorApi,this.dataFeedbackApi=e.dataFeedbackApi,this.feedbackStorageApi=e.feedbackStorageApi,this.seoStoreApi=e.seoStoreApi,this.credentialsApi=e.credentialsApi}}var Ke=s(94361),We=s(92318);function Je(e){if(e instanceof Ke.F7)return{code:500};if(200!==e.code){return{code:(0,Ke.og)(e.code)}}const t=Math.ceil(e.total/se.Cz),s=e.request_type||"recovery",a=e.search_type?e.search_type:u[s];return{code:200,items:Qe(e.items),pages:t,total:e.total,widgets:e.widgets,filters:e.filters,search_attributes:e.search_attributes,context_rubrics:e.context_rubrics,ad:e.ad,searchType:a}}function ze(e){const{search:t,ads:s}=e,a=Je(t);return s&&200===s.code&&s.items.length&&200===a.code?Object.assign(Object.assign({},a),{ads:Qe(s.items)}):a}function Qe(e){return e.map((e=>(0,We.Z)(e)))}class $e extends qe{constructor(e){super(e),this.debouncedSearchObjectSuggestions=(0,n.kl)(this.searchObjectSuggestions.bind(this),250)}searchByQuery(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchByQuery(Object.assign(Object.assign({},e),{accessToken:t})).then((t=>{if(!t||200!==t.code)return{search:t};if(t.ads&&t.ads.length>0&&1===e.page){const s=t.ads.map((e=>e.branch_id||""));return this.webApi.getProfiles({ids:s,viewpoint:e.viewpoint,locale:e.locale}).then((e=>({search:t,ads:e}))).catch((()=>({search:t})))}return{search:t}})).then(ze)}))}searchByRubric(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFirmByRubric(Object.assign(Object.assign({},e),{accessToken:t})).then(Je)}))}searchByAttribute(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFirmByAttribute(Object.assign(Object.assign({},e),{accessToken:t})).then(Je)}))}getSearchFilters(e){return this.webApi.getSearchFilters(e)}getSearchFilialsFilters(e){return this.webApi.getSearchFilialsFilters(e)}searchByBuildingId(e){return this.webApi.searchByBuildingId(e).then(Je)}searchInBuildingByQuery(e){return this.webApi.searchInBuildingByQuery(e).then(Je)}searchMaintainers(e){return this.webApi.searchMaintainers(e).then(Je)}searchProviders(e){return this.webApi.searchProviders(e).then(Je)}searchFilials(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.webApi.searchFilials(Object.assign(Object.assign({},e),{accessToken:t})).then(Je)}))}searchSuggestionsByQuery(e){return this.webApi.searchSuggestionsByQuery(e)}searchObjectSuggestions(e){return this.webApi.searchObjectSuggestions(e)}searchProfiles({query:e,page:t=1,viewpoint:s,locale:a}){const r=e.split(","),n=r.slice(se.Cz*(t-1),se.Cz*t);return this.webApi.getProfiles({ids:n,viewpoint:s,locale:a}).then((e=>(200===e.code&&(e.total=r.length),e))).then(Je)}searchParkingsAround(e){return this.webApi.searchParkingsAround(e).then(Je)}}var Xe=s(874);function Ze(e){const t={code:e.code};if(200!==e.code)return Object.assign(Object.assign({},t),{items:[]});const s=e.items[0],a=Object.assign(Object.assign({},t),{items:[(0,We.Z)(s)]});return"ad"in e&&(a.ad=e.ad),a}class et extends qe{constructor(e){super(e),this.updateDeletedBranchInfo=(e,t)=>s=>{if(!s.items.length)return s;const a=s.items[0];if("branch"!==a.type)return s;return a.dates&&a.dates.deleted_at&&a.org&&e?this.webApi.searchFilials({viewpoint:e,orgId:a.org.id,locale:t}).then((e=>200===e.code&&e&&a.org?Object.assign(Object.assign({},s),{items:[Object.assign(Object.assign({},a),{org:Object.assign(Object.assign({},a.org),{branch_count:e.total})})]}):s)):s}}getEntityByIdNoType({id:e,hash:t,clickPoint:s,viewpoint:a,locale:r,contextRubrics:n,adsId:i,mapAdsId:c,searchCtx:o}){return this.webApi.getItem({id:t?`${e}_${t}`:e,clickPoint:s,viewpoint:a,locale:r,contextRubrics:n,adsId:i,mapAdsId:c,searchCtx:o}).then(Ze).then(this.updateDeletedBranchInfo(a,r))}getMultipleEntities({ids:e,hash:t,viewpoint:s,locale:a}){return this.webApi.getItems({ids:t?e.map((e=>`${e}_${t}`)):e,viewpoint:s,locale:a}).then((e=>200!==e.code?{code:e.code,items:[]}:{code:200,items:e.items.map(We.Z)}))}getEntityByPoint(e){return this.webApi.searchByPoint(e).then((t=>{var s;if(200!==t.code)return{code:200,items:[{id:Xe.k8,region_id:e.regionId,locale:void 0,segment_id:"0",point:e.point,type:"point"}],fromPoi:!1};const a=t.items&&t.items[0],r="poi"!==a.type?null===(s=a.group)||void 0===s?void 0:s.find((e=>!!e.is_main_in_group)):void 0,n="poi"===a.type?a.reference.id:r&&r.id||a.id;return this.getEntityByIdNoType({id:n,clickPoint:e.point,viewpoint:e.viewpoint,locale:e.locale,contextRubrics:[]}).then((e=>Object.assign(Object.assign({},e),{fromPoi:"poi"===a.type})))}))}}class tt extends qe{constructor(e){super(e)}uploadPhoto(e){return(0,G.mG)(this,void 0,void 0,(function*(){const{objectId:t,objectType:s,temporaryId:a,file:r,locale:n,regionId:i,albumCode:c,isReplaced:o,isMenuPhoto:d}=e,u=yield this.credentialsApi.getToken();if(!u)throw new Error("User is not authorized");const l=(yield this.photoApi.addPhoto({uid:a,objectId:t,objectType:s,albumCode:c,locale:n,regionId:i,accessToken:u,isReplaced:o,isMenuPhoto:d})).items[0];if(!l.hash||!l.id||l.error)throw{name:l.error&&l.error.type,message:l.error&&l.error.message};return this.photoApi.uploadPhoto({id:l.id,hash:l.hash,file:r,accessToken:u,objectType:s})}))}}class st extends qe{constructor(e){super(e)}getEntityReviews(e){return(0,G.mG)(this,void 0,void 0,(function*(){const{id:t,type:s,isAdvertiser:a,offset:r,withAnswer:n,ratings:i,unconfirmed:c,facts:o,newtworkTimeout:d,locale:u}=e,l=yield this.credentialsApi.getToken();switch(s){case"branch":return this.reviewsApi.getBranchReviews({id:t,type:s,isAdvertiser:a,offset:r,withAnswer:n,ratings:i,accessToken:l,unconfirmed:c,facts:o,newtworkTimeout:d,locale:u||""});case"geo":if(c)throw new Error("no unconfirmed reviews on geo");return this.reviewsApi.getGeoReviews({id:t,type:s,offset:r,ratings:i,accessToken:l,newtworkTimeout:d,locale:u||""});case"org":return this.reviewsApi.getOrgReviews({id:t,type:s,offset:r,withAnswer:n,ratings:i,accessToken:l,unconfirmed:c,facts:o,newtworkTimeout:d,locale:u||""})}}))}getUserReviews(e){return(0,G.mG)(this,void 0,void 0,(function*(){const{userId:t,locale:s,offset:a}=e,r=yield this.credentialsApi.getToken();if(!r)throw new Error("User is not authorized");return this.reviewsApi.getUserReviews({userId:t,accessToken:r,locale:s,offset:a})}))}deleteReview(e){return(0,G.mG)(this,void 0,void 0,(function*(){const{id:t,locale:s}=e,a=yield this.credentialsApi.getToken();if(!a)throw new Error("User is not authorized");return this.reviewsApi.deleteReview({id:t,accessToken:a,locale:s||""})}))}}class at extends qe{constructor(e){super(e)}getRegionById(e){return this.webApi.getRegionById(e)}getRegionsList(e){return this.webApi.getRegionsList(e)}detectRegion(e){return this.webApi.detectRegion(e)}}class rt extends qe{constructor(e){super(e)}clearSearchHistory(e){return this.profileApi.clearSearchHistory(e)}}class nt extends qe{constructor(e){super(e)}getVideoData(e){return this.videoApi.getVideoData(e.videoUrl)}}class it extends qe{constructor(e){super(e)}confirmRegistration({email:e,clientId:t}){return(0,G.mG)(this,void 0,void 0,(function*(){const s=yield this.credentialsApi.getToken();if(!s)throw new Error("User is not authorized");return this.authApi.updateEmail({accessToken:s,email:e,authClientId:t}).then((()=>{}))}))}}class ct extends qe{constructor(e){super(e)}sendFeedback(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return yield this.feedbackApi.sendFeedback(Object.assign(Object.assign({},e),{accessToken:t}))}))}sendReviewFeedback(e){return(0,G.mG)(this,void 0,void 0,(function*(){const{reviewId:t,text:s,locale:a}=e,r=yield this.credentialsApi.getToken();if(!r)throw new Error("User is not authorized");return yield this.reviewsApi.sendReviewComplaint({id:t,text:s,accessToken:r,locale:a||""})}))}sendStoryComplaintFeedback(e){return(0,G.mG)(this,void 0,void 0,(function*(){const{objectId:t,segmentId:s,storyId:a,categoryCode:r,comment:n,userEmail:i}=e,c=yield this.credentialsApi.getToken();return yield this.storyComplaintApi.sendStoryComplaint({objectId:t,segmentId:s,storyId:a,categoryCode:r,comment:n,userEmail:i,accessToken:c})}))}getUserFeedbacks(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();if(!t)throw new Error("User is not authorized");return yield this.dataFeedbackApi.getUserFeedbacks(Object.assign(Object.assign({},e),{accessToken:t}))}))}getUserFeedbacksCount(){return(0,G.mG)(this,void 0,void 0,(function*(){const e=yield this.credentialsApi.getToken();if(!e)throw new Error("User is not authorized");return yield this.dataFeedbackApi.getUserFeedbacksCount({accessToken:e})}))}sendTypedFeedback(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();return this.dataFeedbackApi.sendFeedback(Object.assign(Object.assign({},e),{userToken:t}))}))}getAnonymousFeedbacksCount(){return(0,G.mG)(this,void 0,void 0,(function*(){return this.feedbackStorageApi.get("count")}))}setAnonymousFeedbacksCount(e){return(0,G.mG)(this,void 0,void 0,(function*(){return this.feedbackStorageApi.set("count",e.toString())}))}}class ot extends qe{constructor(e){super(e)}createShortLink(e){return this.shortonizerApi.createShortLink(e.url)}}class dt extends qe{constructor(e){super(e)}updateEmail(e){return(0,G.mG)(this,void 0,void 0,(function*(){const t=yield this.credentialsApi.getToken();if(!t)throw new Error("No access token");return this.aggregatorApi.updateEmail(Object.assign(Object.assign({},e),{accessToken:t}))}))}}function ut(e){const t=Math.ceil(e.total/se.LF);return Object.assign(Object.assign({},e),{pages:t})}function lt(e){const t=Math.ceil(e.total/se.Kt);return Object.assign(Object.assign({},e),{pages:t})}function gt(e){const t=Math.ceil(e.total/se.Kt);return Object.assign(Object.assign({},e),{pages:t})}class pt extends qe{constructor(e){super(e)}searchProductsById(e){return this.marketApi.searchProductsById(e).then(ut)}searchBranchProducts(e){return this.marketApi.searchBranchProducts(e).then(lt)}getBranchCategoriesAndProducts(e){return this.marketApi.getBranchCategoriesAndProducts(e).then(lt)}getOffers(e){return this.marketApi.getOffers(e).then(gt)}getSuggestions(e){return this.marketApi.getSuggestions(e)}}class bt extends qe{constructor(e){super(e)}getSeoParams(e){return this.seoStoreApi?this.seoStoreApi.getSeoParams(e):Promise.resolve({})}}var Ot=s(69363);class ft extends qe{constructor(e){super(e),this.localStorage=new Ot.r("history","history")}saveSearchHistory(e){return this.localStorage.set(e.userId,e.history)}loadSearchHistory(e){return this.localStorage.get(e.userId)}clearSearchHistory(){return this.localStorage.clear()}}function Et(e){return{search:new $e(e),market:new pt(e),entity:new et(e),photos:new tt(e),reviews:new st(e),region:new at(e),profile:new rt(e),video:new nt(e),auth:new it(e),feedback:new ct(e),shortonizer:new ot(e),aggregator:new dt(e),seoStore:new bt(e),history:new ft(e)}}function mt({entity:e,reviews:t,video:s}){return a=>{switch(a.type){case"ENTITY/FETCH_PROFILE_NO_TYPE":return e.getEntityByIdNoType(a.payload);case"ENTITY/FETCH_MULTIPLE":return e.getMultipleEntities(a.payload);case"ENTITY/FETCH_BY_POINT":return e.getEntityByPoint(a.payload);case"USER/DELETE_REVIEW":return t.deleteReview(a.payload);case"ENTITY/FETCH_VIDEO_DATA":return s.getVideoData(a.payload);default:return}}}function ht({search:e}){return t=>{switch(t.type){case"SEARCH/FETCH_FILIALS":return e.searchFilials(t.payload);case"SEARCH/FETCH_FILIALS_FILTERS":return e.getSearchFilialsFilters(t.payload);default:return}}}function jt({search:e}){return t=>{switch(t.type){case"SEARCH/FETCH_QUERY":return e.searchByQuery(t.payload);case"SEARCH/FETCH_RUBRIC":return e.searchByRubric(t.payload);case"SEARCH/FETCH_ATTRIBUTE":return e.searchByAttribute(t.payload);case"SEARCH/FETCH_FILTERS":return e.getSearchFilters(t.payload);default:return}}}function yt({search:e}){return t=>{if("SEARCH/FETCH_SUGGESTIONS"===t.type)return e.searchSuggestionsByQuery(t.payload)}}function vt({search:e}){return t=>{if("SEARCH/FETCH_OBJECT_SUGGESTIONS"===t.type)return e.debouncedSearchObjectSuggestions(t.payload)}}function St({search:e}){return t=>{switch(t.type){case"SEARCH/BY_BUILDING_ID":return e.searchByBuildingId(t.payload);case"SEARCH/IN_BUILDING_BY_QUERY":return e.searchInBuildingByQuery(t.payload);case"SEARCH/FETCH_MAINTAINERS":return e.searchMaintainers(t.payload);case"SEARCH/FETCH_PROVIDERS":return e.searchProviders(t.payload);default:return}}}function _t({search:e}){return t=>{if("SEARCH/FETCH_PARKINGS_AROUND"===t.type)return e.searchParkingsAround(t.payload)}}function Rt(e){const t=[ht,jt,St,yt,vt,_t].map((t=>t(e)));return e=>{for(const s of t){const t=s(e);if(t)return t}}}function It({market:e}){return t=>{switch(t.type){case"MARKET/FETCH_PRODUCT_BY_ID":return e.searchProductsById(t.payload);case"MARKET/FETCH_CATEGORIES_BY_BRANCH":return e.getBranchCategoriesAndProducts(t.payload);case"MARKET/FETCH_BRANCH_PRODUCTS":return e.searchBranchProducts(t.payload);case"MARKET/FETCH_OFFERS":return e.getOffers(t.payload);case"MARKET/FETCH_SUGGESTIONS":return e.getSuggestions(t.payload);default:return}}}function Tt({region:e}){return t=>{switch(t.type){case"REGION/FETCH_LIST":return e.getRegionsList(t.payload);case"REGION/FETCH":return e.getRegionById(t.payload);case"REGION/DETECT":return e.detectRegion(t.payload);default:return}}}function Ct({profile:e}){return t=>{if("SEARCH_HISTORY/CLEAR_SEARCH_HISTORY"===t.type)return e.clearSearchHistory(t.payload)}}function At({auth:e,reviews:t,history:s}){return a=>{switch(a.type){case"USER/CONFIRM_REGISTRATION":return e.confirmRegistration(a.payload);case"USER/FETCH_REVIEWS":return t.getUserReviews(a.payload);case"USER/DELETE_REVIEW":return t.deleteReview(a.payload);case"USER/SAVE_HISTORY":return s.saveSearchHistory(a.payload);case"USER/LOAD_HISTORY":return s.loadSearchHistory(a.payload);case"USER/CLEAR_HISTORY":return s.clearSearchHistory();default:return}}}function wt({feedback:e}){return t=>{switch(t.type){case"FEEDBACK/SEND":case"FEEDBACK/PHOTO_COMPLAINT":return e.sendFeedback(t.payload.data);case"FEEDBACK/REVIEW_COMPLAINT":return e.sendReviewFeedback(t.payload);case"FEEDBACK/STORY_COMPLAINT":return e.sendStoryComplaintFeedback(t.payload);case"FEEDBACK/SEND_TYPED":return e.sendTypedFeedback(t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS":return e.getUserFeedbacks(t.payload);case"FEEDBACK/FETCH_USER_FEEDBACKS_COUNT":return e.getUserFeedbacksCount();case"FEEDBACK/GET_ANOMYMOUS_FEEDBACKS_COUNT":return e.getAnonymousFeedbacksCount();case"FEEDBACK/SET_ANOMYMOUS_FEEDBACKS_COUNT":return e.setAnonymousFeedbacksCount(t.payload.feedbacksCount);default:return}}}function Ht({aggregator:e}){return t=>{if("USER/UPDATE_EMAIL"===t.type)return e.updateEmail(t.payload)}}function Ut({seoStore:e}){return t=>{if("SEO_STORE/FETCH"===t.type)return e.getSeoParams(t.payload)}}function Ft({reviews:e}){return t=>{if("REVIEW/FETCH_REVIEWS"===t.type)return e.getEntityReviews(t.payload)}}var kt=s(77878);function Pt(e){const t=[At,mt,Rt,It,Tt,Ct,wt,Ht,Ut,Ft].map((t=>t(e)));return e=>{for(const s of t){const t=s(e);if(t)return t}return(0,kt.H)({message:`service cannot be defined for action - ${e.type}`,id:"os136",level:"error",payload:{type:"debug",subtype:"NoAsyncActionHandler"}}),Promise.reject(new Error(`Handler for "${e.type}" is undefined`))}}var Nt=s(72899),Lt=s(57953);function Dt(e,t,s){const a=(0,Ge.Z)(Et,Pt)(e);return e=>r=>i=>{if(!i.async)return r(i);let c="object"==typeof i.payload?Object.assign(Object.assign({},i),{payload:Bt(i.payload)}):i;s&&(c=Yt(c,s(e.getState()))),r(c);const o=e.getState(),{payload:d,type:u}=c;return o.session.isOffline?e.dispatch({payload:{name:"OfflineError",message:"No network"},type:`${u}_ERROR`,meta:d,error:!0}):a(c).then((s=>{if(!Nt.sk&&t.captchaUrl&&(a=s,(0,n.Kn)(a)&&"code"in a&&307===a.code)){const s=`${t.captchaUrl}form?return_url=${window.location.href}`;return e.dispatch((0,Lt.k)({url:s,name:"_self"}))}var a;return e.dispatch({payload:s,meta:d,type:`${u}_SUCCESS`,success:!0})}),(t=>e.dispatch({payload:t,meta:d,type:`${u}_ERROR`,error:!0})))}}function Bt(e){return e.statusId?e:Object.assign({},e,{statusId:(0,n.by)()})}function Yt(e,t){if(!t||!(0,n.Kn)(t))return e;const s="payload"in e&&e.payload,a={};return(0,n.Ed)(t,((e,t)=>{s&&t in s||void 0===e||(a[t]=e)})),0===Object.keys(a).length?e:Object.assign(Object.assign({},e),{payload:Object.assign(Object.assign({},e.payload),a)})}var Gt=s(56521);function Mt({windowApi:e}){return()=>t=>s=>{switch(s.type){case"HISTORY/PUSH":return e.historyPush(s.payload.state,s.payload.url),t(s);case"HISTORY/REPLACE":return void e.historyReplace(s.payload.state,s.payload.url);case"HISTORY/BACK":return void e.historyBack();default:return t(s)}}}function Vt({windowApi:e}){return()=>t=>s=>{switch(s.type){case"APP/OPEN_URL":if(e.location&&s.payload.name&&"_self"===s.payload.name){const t="/"===s.payload.url?e.location.host:s.payload.url;if(t.startsWith("/")&&-1===t.indexOf("//"))return void(window.location.href=t);e.location.href=t.startsWith("http")?t:`${e.location.protocol}//${t}`}else e.open(s.payload.url,s.payload.name,s.payload.specs);return;case"APP/RELOAD":return void e.reload(s.payload.forcedReload);default:return t(s)}}}var xt,qt=s(29759),Kt=s(21969);xt||(xt={});const{emitEvent:Wt}=(0,Kt.U)();function Jt(){let e;return t=>s=>a=>{switch(a.type){case"USER/ACTIVATE_MY_GEOLOCATION":return function({onUpdate:t,onError:s}){if(e)return;if("undefined"==typeof window||!window.navigator||!window.navigator.geolocation)return s("API_UNAVAILABLE");qt.tO.local.setItem("geolocationAllowed","true"),e=window.navigator.geolocation.watchPosition((e=>t(e)),(e=>s(function(e){switch(e.code){case e.PERMISSION_DENIED:return"PERMISSION_DENIED";case e.POSITION_UNAVAILABLE:return"POSITION_UNAVAILABLE";case e.TIMEOUT:return"TIMEOUT";default:return}}(e))),{enableHighAccuracy:!0})}({onUpdate(e){t.dispatch(Wt({type:"myGeolocation:update",event:e}))},onError(e){t.dispatch(Wt({type:"myGeolocation:error",event:e}))}}),s(a);case"USER/DEACTIVATE_MY_GEOLOCATION":return function(){e&&(window.navigator.geolocation.clearWatch(e),e=void 0);qt.tO.local.removeItem("geolocationAllowed")}(),s(a);default:return s(a)}}}function zt({analyticsApi:e}){return()=>t=>s=>{switch(s.type){case"ANALYTICS/TRACK_GOOGLE":return void e.trackGoogleEvent(...s.payload);case"ANALYTICS/PAGEVIEW":return void e.trackPageview();case"ANALYTICS/SET_CONSENT_GRANTED":return void e.setGoogleConsentGranted();case"ANALYTICS/CHANGE_PROJECT_ID":return void e.changeGoogleProjectId(s.payload.projectId);default:return t(s)}}}new class{constructor(){this.actions=[],this.signals=[],this.allRawActions=[]}setAction(e){this.actions.push(e)}setSignal(e){this.signals.push(e)}getSignals(){return this.signals}getAll(){return this.actions}getAllRaw(){return this.allRawActions}findAction(e){return this.actions.find((t=>t.type===e))}findSignal(e){return this.signals.find((t=>t.payload.name===e))}findSignalIntree(e){return this.signals.find((t=>t[Me.ev.NAME]===e))}getTree(){return this.actions.reduce(((e,t)=>{let s=e;if(t[Me.ev.NAME]){const e=t[Me.ev.NAME],a=e.split(".");for(const t of a){let a=s.find((e=>e.type===t));if(!a){const r=this.findSignalIntree(e);a=r?{type:t,children:[],payload:r.payload}:{type:t,children:[]},s.push(a)}s=a.children}}return s.push({type:t.type,payload:t.payload}),e}),[])}reset(){this.actions=[],this.allRawActions=[],this.signals=[]}trackAction(e){this.allRawActions.push(e)}};var Qt=s(64584);function $t(e){const{extraReducers:t,enhancers:s,initialState:r,config:n,uiMiddlewares:i,mwWithServices:c,asyncExtraPayload:o,apiServices:d}=e;return function({initialState:e,beforeMiddlewares:t=[],extraMiddlewares:s,enhancers:r,extraReducers:n,apiServices:i,config:c,mwWithServices:o=[],asyncExtraPayload:d}){const u=[...t,(0,Gt.n)(),Ve(c),(0,Qt.O)({services:i,asyncExtraPayload:d}),Dt(i,c,d),Jt(),Mt(i),Vt(i),zt(i),...s].concat(o.map((e=>e(i)))),l=(0,a.md)(...u);"godmode"in c&&c.godmode&&"object"==typeof window&&window.__REDUX_DEVTOOLS_EXTENSION__&&r.push(window.__REDUX_DEVTOOLS_EXTENSION__());const g=(0,a.qC)(l,...r),p=Ye(n);return e?(0,a.MT)(p,e,g):(0,a.MT)(p,g)}({extraMiddlewares:[...i],extraReducers:t,enhancers:s,initialState:r,apiServices:d,config:n,mwWithServices:c,asyncExtraPayload:o})}},73198:(e,t,s)=>{s.d(t,{vT:()=>r,NY:()=>a});const a={read_only:"boolean",system_is_deleted:"boolean",is_owned:"boolean",is_deleted:"boolean",is_shared:"boolean",is_visible_on_map:"boolean",is_default:"boolean",order:"number",project_id:"array",collections:"array",point:"lonlat",source_point:"lonlat",user_info:"object"},r=["adm_div","parking","gate","street","road","point"]},62662:(e,t,s)=>{function a(e){return e&&"number"==typeof e.lon&&"number"==typeof e.lat}s.d(t,{S:()=>a})},8301:(e,t,s)=>{s.d(t,{m:()=>a});const a=["camera","camera-20","camera-30","camera-40","camera-50","camera-60","camera-70","camera-80","camera-90","camera-100","camera-110","camera-120","camera-130","camera-140","camera-tl","camera-bus","camera-line","camera-parking"]},84046:(e,t,s)=>{s.d(t,{R:()=>r});var a=s(23862);const r=(e,t,s)=>function(e,t){return(s,a)=>{const r=s[e],n=t(r,a);return r===n?s:Object.assign(Object.assign({},s),{[e]:n})}}(t,(0,a.KX)(e,s))},37276:(e,t,s)=>{function a(e){return t=>Object.assign(Object.assign({},e),t)}s.d(t,{B:()=>a})},69452:(e,t,s)=>{s.d(t,{q:()=>a});const a=e=>{const t=null==e?void 0:e.reduce(((e,t)=>"rubric"===t.table_name?[...e,t.record_id]:t.dgis_rubrics.length?[...e,...t.dgis_rubrics]:e),[]);return(null==t?void 0:t.length)?[...new Set(t)]:void 0}},22941:(e,t,s)=>{s.d(t,{_p:()=>i,gU:()=>n,qr:()=>r});var a=s(77878);const r=["#E2658B","#198700","#4F92F8","#E7750B","#738AB3","#7435D2","#DBAF00","#00B305","#00A989","#9E578A","#BA6612","#1D66EE","#F83A3A"],n="#E7750B";function i(e,t){try{if(!e)throw new Error;if(t&&r.includes(t))return t;const s=e.replace(/-/g,"").split("").reduce(((e,t,s,a)=>(s%2!=0&&e.push(`${a[s-1]}${t}`),e)),[]).reverse(),a=Number((BigInt("0x"+s.slice(0,8).join(""))^BigInt("0x"+s.slice(8).join("")))%BigInt(r.length));return r[a]}catch(e){return(0,a.H)({message:"Пришел неизвестный цвет или нет uuid!",level:"warn",id:"v3gh3",payload:{type:"exception",subtype:"getFavoriteColorError",stack:e instanceof Error?e.stack:void 0}}),n}}},26223:(e,t,s)=>{s.d(t,{A:()=>a});const a=e=>{const t=[];return null==e||e.forEach((({table_name:e,group:s,record_id:a,dgis_rubrics:r})=>{"rubric"!==e||void 0!==s&&0!==s||t.push(a),!r.length||void 0!==s&&0!==s||r.forEach((e=>{t.push(e)}))})),(null==t?void 0:t.length)?t:void 0}},87641:(e,t,s)=>{function a(e){return!(!e||!e.options)&&!!e.options.fmcg_owner}s.d(t,{G:()=>a})},98399:(e,t,s)=>{s.d(t,{L:()=>r,a:()=>a});const a=(e={})=>e,r=e=>(t=e)=>t}}]);